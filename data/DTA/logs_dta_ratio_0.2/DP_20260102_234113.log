--- DTA Baseline: DP (Ratio: 0.2) ---

>>> [Stage 0] Sampling...

[Sampler] Running DP | Target: 4991/24956 (20.0%)
Scanning Source (DP):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (DP):   4%|▍         | 1/25 [00:03<01:23,  3.50s/it]Scanning Source (DP):   8%|▊         | 2/25 [00:03<00:37,  1.64s/it]Scanning Source (DP):  12%|█▏        | 3/25 [00:04<00:23,  1.05s/it]Scanning Source (DP):  16%|█▌        | 4/25 [00:04<00:16,  1.30it/s]Scanning Source (DP):  20%|██        | 5/25 [00:05<00:15,  1.31it/s]Scanning Source (DP):  24%|██▍       | 6/25 [00:05<00:11,  1.61it/s]Scanning Source (DP):  28%|██▊       | 7/25 [00:05<00:09,  1.87it/s]Scanning Source (DP):  32%|███▏      | 8/25 [00:06<00:07,  2.14it/s]Scanning Source (DP):  36%|███▌      | 9/25 [00:08<00:13,  1.15it/s]Scanning Source (DP):  40%|████      | 10/25 [00:08<00:10,  1.42it/s]Scanning Source (DP):  44%|████▍     | 11/25 [00:08<00:08,  1.69it/s]Scanning Source (DP):  48%|████▊     | 12/25 [00:09<00:06,  1.93it/s]Scanning Source (DP):  52%|█████▏    | 13/25 [00:10<00:09,  1.21it/s]Scanning Source (DP):  56%|█████▌    | 14/25 [00:10<00:07,  1.47it/s]Scanning Source (DP):  60%|██████    | 15/25 [00:11<00:05,  1.74it/s]Scanning Source (DP):  64%|██████▍   | 16/25 [00:11<00:04,  1.97it/s]Scanning Source (DP):  68%|██████▊   | 17/25 [00:12<00:06,  1.32it/s]Scanning Source (DP):  72%|███████▏  | 18/25 [00:13<00:04,  1.59it/s]Scanning Source (DP):  76%|███████▌  | 19/25 [00:13<00:03,  1.85it/s]Scanning Source (DP):  80%|████████  | 20/25 [00:13<00:02,  2.10it/s]Scanning Source (DP):  84%|████████▍ | 21/25 [00:14<00:02,  1.64it/s]Scanning Source (DP):  88%|████████▊ | 22/25 [00:15<00:01,  1.90it/s]Scanning Source (DP):  92%|█████████▏| 23/25 [00:15<00:00,  2.15it/s]Scanning Source (DP):  96%|█████████▌| 24/25 [00:15<00:00,  2.36it/s]Scanning Source (DP): 100%|██████████| 25/25 [00:15<00:00,  2.99it/s]                                                                     -> Source reduced: 24956 -> 4991

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 3.6418 | Val MAE 1.5597
[P1] Ep 2: Loss 1.6356 | Val MAE 1.5879
[P1] Ep 3: Loss 1.3777 | Val MAE 1.5869
[P1] Ep 4: Loss 1.2022 | Val MAE 1.6333
[P1] Ep 5: Loss 1.1233 | Val MAE 1.6412
[P1] Ep 6: Loss 1.0672 | Val MAE 1.6327
[P1] Ep 7: Loss 1.0359 | Val MAE 1.6490
[P1] Ep 8: Loss 1.0000 | Val MAE 1.6372
[P1] Ep 9: Loss 0.9930 | Val MAE 1.6447
[P1] Ep 10: Loss 0.9690 | Val MAE 1.6132
[P1] Ep 11: Loss 0.9745 | Val MAE 1.6107
[P1] Ep 12: Loss 0.9304 | Val MAE 1.6356
[P1] Ep 13: Loss 0.9028 | Val MAE 1.6506
[P1] Ep 14: Loss 0.9139 | Val MAE 1.6139
[P1] Ep 15: Loss 0.9069 | Val MAE 1.6288
[P1] Ep 16: Loss 0.8918 | Val MAE 1.6553
[P1] Ep 17: Loss 0.8851 | Val MAE 1.6615
[P1] Ep 18: Loss 0.8677 | Val MAE 1.6597
[P1] Ep 19: Loss 0.8451 | Val MAE 1.6444
[P1] Ep 20: Loss 0.8415 | Val MAE 1.6122
[P1] Ep 21: Loss 0.8280 | Val MAE 1.6382
[P1] Ep 22: Loss 0.8448 | Val MAE 1.6260
[P1] Ep 23: Loss 0.8213 | Val MAE 1.6044
[P1] Ep 24: Loss 0.7788 | Val MAE 1.5845
[P1] Ep 25: Loss 0.8087 | Val MAE 1.6305
[P1] Ep 26: Loss 0.7508 | Val MAE 1.6444
[P1] Ep 27: Loss 0.7816 | Val MAE 1.6217
[P1] Ep 28: Loss 0.7700 | Val MAE 1.6375
[P1] Ep 29: Loss 0.7595 | Val MAE 1.6159
[P1] Ep 30: Loss 0.7622 | Val MAE 1.5818
[P1] Ep 31: Loss 0.7570 | Val MAE 1.6112
[P1] Ep 32: Loss 0.7744 | Val MAE 1.6207
[P1] Ep 33: Loss 0.7639 | Val MAE 1.5811
[P1] Ep 34: Loss 0.7570 | Val MAE 1.5475
[P1] Ep 35: Loss 0.7417 | Val MAE 1.5435
[P1] Ep 36: Loss 0.7525 | Val MAE 1.5567
[P1] Ep 37: Loss 0.7499 | Val MAE 1.5937
[P1] Ep 38: Loss 0.7204 | Val MAE 1.6927
[P1] Ep 39: Loss 0.7147 | Val MAE 1.5232
[P1] Ep 40: Loss 0.7354 | Val MAE 1.5699
[P1] Ep 41: Loss 0.7192 | Val MAE 1.5484
[P1] Ep 42: Loss 0.7108 | Val MAE 1.5673
[P1] Ep 43: Loss 0.7164 | Val MAE 1.5802
[P1] Ep 44: Loss 0.7225 | Val MAE 1.6185
[P1] Ep 45: Loss 0.6986 | Val MAE 1.6007
[P1] Ep 46: Loss 0.7141 | Val MAE 1.5519
[P1] Ep 47: Loss 0.6867 | Val MAE 1.5858
[P1] Ep 48: Loss 0.7054 | Val MAE 1.5908
[P1] Ep 49: Loss 0.6967 | Val MAE 1.5768
[P1] Ep 50: Loss 0.6971 | Val MAE 1.5607
[P1] Ep 51: Loss 0.7094 | Val MAE 1.5582
[P1] Ep 52: Loss 0.7069 | Val MAE 1.5876
[P1] Ep 53: Loss 0.6808 | Val MAE 1.5604
[P1] Ep 54: Loss 0.6861 | Val MAE 1.5791
[P1] Ep 55: Loss 0.7000 | Val MAE 1.5403
[P1] Ep 56: Loss 0.6803 | Val MAE 1.5957
[P1] Ep 57: Loss 0.6521 | Val MAE 1.6405
[P1] Ep 58: Loss 0.6844 | Val MAE 1.6286
[P1] Ep 59: Loss 0.6801 | Val MAE 1.5406
[P1] Ep 60: Loss 0.6720 | Val MAE 1.5749
[P1] Ep 61: Loss 0.6724 | Val MAE 1.5287
[P1] Ep 62: Loss 0.6632 | Val MAE 1.5212
[P1] Ep 63: Loss 0.6475 | Val MAE 1.5965
[P1] Ep 64: Loss 0.6600 | Val MAE 1.5906
[P1] Ep 65: Loss 0.6436 | Val MAE 1.6018
[P1] Ep 66: Loss 0.6450 | Val MAE 1.5879
[P1] Ep 67: Loss 0.6330 | Val MAE 1.5952
[P1] Ep 68: Loss 0.6602 | Val MAE 1.5940
[P1] Ep 69: Loss 0.6552 | Val MAE 1.5950
[P1] Ep 70: Loss 0.6576 | Val MAE 1.5607
[P1] Ep 71: Loss 0.6362 | Val MAE 1.5897
[P1] Ep 72: Loss 0.6419 | Val MAE 1.5809
[P1] Ep 73: Loss 0.6380 | Val MAE 1.5971
[P1] Ep 74: Loss 0.6345 | Val MAE 1.5116
[P1] Ep 75: Loss 0.6446 | Val MAE 1.5712
[P1] Ep 76: Loss 0.6304 | Val MAE 1.5685
[P1] Ep 77: Loss 0.6274 | Val MAE 1.5694
[P1] Ep 78: Loss 0.6305 | Val MAE 1.6099
[P1] Ep 79: Loss 0.6234 | Val MAE 1.6045
[P1] Ep 80: Loss 0.6232 | Val MAE 1.5851
[P1] Ep 81: Loss 0.6142 | Val MAE 1.5668
[P1] Ep 82: Loss 0.6039 | Val MAE 1.5768
[P1] Ep 83: Loss 0.6006 | Val MAE 1.6807
[P1] Ep 84: Loss 0.6011 | Val MAE 1.5851
[P1] Ep 85: Loss 0.5953 | Val MAE 1.5474
[P1] Ep 86: Loss 0.5935 | Val MAE 1.5025
[P1] Ep 87: Loss 0.5851 | Val MAE 1.5194
[P1] Ep 88: Loss 0.5883 | Val MAE 1.6250
[P1] Ep 89: Loss 0.5684 | Val MAE 1.6685
[P1] Ep 90: Loss 0.5785 | Val MAE 1.5445
[P1] Ep 91: Loss 0.5837 | Val MAE 1.5401
[P1] Ep 92: Loss 0.5688 | Val MAE 1.5618
[P1] Ep 93: Loss 0.5902 | Val MAE 1.5676
[P1] Ep 94: Loss 0.5837 | Val MAE 1.5843
[P1] Ep 95: Loss 0.5613 | Val MAE 1.5449
[P1] Ep 96: Loss 0.5481 | Val MAE 1.5576
[P1] Ep 97: Loss 0.5691 | Val MAE 1.5123
[P1] Ep 98: Loss 0.5654 | Val MAE 1.5387
[P1] Ep 99: Loss 0.5507 | Val MAE 1.5364
[P1] Ep 100: Loss 0.5684 | Val MAE 1.5307
[P1] Ep 101: Loss 0.5540 | Val MAE 1.5889
[P1] Ep 102: Loss 0.5559 | Val MAE 1.5494
[P1] Ep 103: Loss 0.5564 | Val MAE 1.4951
[P1] Ep 104: Loss 0.5583 | Val MAE 1.5399
[P1] Ep 105: Loss 0.5660 | Val MAE 1.5293
[P1] Ep 106: Loss 0.5483 | Val MAE 1.5400
[P1] Ep 107: Loss 0.5720 | Val MAE 1.6377
[P1] Ep 108: Loss 0.5547 | Val MAE 1.6032
[P1] Ep 109: Loss 0.5498 | Val MAE 1.5647
[P1] Ep 110: Loss 0.5417 | Val MAE 1.5581
[P1] Ep 111: Loss 0.5557 | Val MAE 1.5081
[P1] Ep 112: Loss 0.5270 | Val MAE 1.5421
[P1] Ep 113: Loss 0.5324 | Val MAE 1.5983
[P1] Ep 114: Loss 0.5322 | Val MAE 1.5477
[P1] Ep 115: Loss 0.5272 | Val MAE 1.6293
[P1] Ep 116: Loss 0.5217 | Val MAE 1.6590
[P1] Ep 117: Loss 0.5385 | Val MAE 1.6330
[P1] Ep 118: Loss 0.5384 | Val MAE 1.6873
[P1] Ep 119: Loss 0.5240 | Val MAE 1.7157
[P1] Ep 120: Loss 0.5081 | Val MAE 1.6210
[P1] Ep 121: Loss 0.5307 | Val MAE 1.6017
[P1] Ep 122: Loss 0.5141 | Val MAE 1.6562
[P1] Ep 123: Loss 0.5246 | Val MAE 1.6193
[P1] Ep 124: Loss 0.5117 | Val MAE 1.5256
[P1] Ep 125: Loss 0.5148 | Val MAE 1.6699
[P1] Ep 126: Loss 0.5147 | Val MAE 1.6503
[P1] Ep 127: Loss 0.5229 | Val MAE 1.6521
[P1] Ep 128: Loss 0.5172 | Val MAE 1.5585
[P1] Ep 129: Loss 0.5064 | Val MAE 1.6351
[P1] Ep 130: Loss 0.5097 | Val MAE 1.6491
[P1] Ep 131: Loss 0.4931 | Val MAE 1.7499
[P1] Ep 132: Loss 0.5078 | Val MAE 1.6464
[P1] Ep 133: Loss 0.5040 | Val MAE 1.6691
[P1] Ep 134: Loss 0.5132 | Val MAE 1.6251
[P1] Ep 135: Loss 0.5029 | Val MAE 1.6573
[P1] Ep 136: Loss 0.5110 | Val MAE 1.6380
[P1] Ep 137: Loss 0.5093 | Val MAE 1.7623
[P1] Ep 138: Loss 0.4912 | Val MAE 1.7610
[P1] Ep 139: Loss 0.4972 | Val MAE 1.6850
[P1] Ep 140: Loss 0.4936 | Val MAE 1.6056
[P1] Ep 141: Loss 0.4908 | Val MAE 1.7023
[P1] Ep 142: Loss 0.4896 | Val MAE 1.6629
[P1] Ep 143: Loss 0.4897 | Val MAE 1.7227
[P1] Ep 144: Loss 0.4887 | Val MAE 1.7057
[P1] Ep 145: Loss 0.4826 | Val MAE 1.7527
[P1] Ep 146: Loss 0.4857 | Val MAE 1.8008
[P1] Ep 147: Loss 0.4651 | Val MAE 1.7120
[P1] Ep 148: Loss 0.4954 | Val MAE 1.7457
[P1] Ep 149: Loss 0.4783 | Val MAE 1.7131
[P1] Ep 150: Loss 0.4743 | Val MAE 1.6613
[P1] Ep 151: Loss 0.4912 | Val MAE 1.6762
[P1] Ep 152: Loss 0.4859 | Val MAE 1.5776
[P1] Ep 153: Loss 0.4653 | Val MAE 1.7248
[P1] Ep 154: Loss 0.4895 | Val MAE 1.6233
[P1] Ep 155: Loss 0.4745 | Val MAE 1.6496
[P1] Ep 156: Loss 0.4744 | Val MAE 1.8238
[P1] Ep 157: Loss 0.4738 | Val MAE 1.6039
[P1] Ep 158: Loss 0.4835 | Val MAE 1.7889
[P1] Ep 159: Loss 0.4670 | Val MAE 1.6658
[P1] Ep 160: Loss 0.4733 | Val MAE 1.6805
[P1] Ep 161: Loss 0.4558 | Val MAE 1.7795
[P1] Ep 162: Loss 0.4665 | Val MAE 1.8481
[P1] Ep 163: Loss 0.4616 | Val MAE 1.6403
[P1] Ep 164: Loss 0.4598 | Val MAE 1.7673
[P1] Ep 165: Loss 0.4526 | Val MAE 1.7219
[P1] Ep 166: Loss 0.4516 | Val MAE 1.6442
[P1] Ep 167: Loss 0.4566 | Val MAE 1.6606
[P1] Ep 168: Loss 0.4641 | Val MAE 1.6727
[P1] Ep 169: Loss 0.4602 | Val MAE 1.6678
[P1] Ep 170: Loss 0.4516 | Val MAE 1.7129
[P1] Ep 171: Loss 0.4479 | Val MAE 1.6742
[P1] Ep 172: Loss 0.4570 | Val MAE 1.6767
[P1] Ep 173: Loss 0.4491 | Val MAE 1.8189
[P1] Ep 174: Loss 0.4478 | Val MAE 1.7353
[P1] Ep 175: Loss 0.4443 | Val MAE 1.8241
[P1] Ep 176: Loss 0.4463 | Val MAE 1.7217
[P1] Ep 177: Loss 0.4397 | Val MAE 1.8299
[P1] Ep 178: Loss 0.4450 | Val MAE 1.8543
[P1] Ep 179: Loss 0.4373 | Val MAE 1.8078
[P1] Ep 180: Loss 0.4427 | Val MAE 1.7282
[P1] Ep 181: Loss 0.4392 | Val MAE 1.7755
[P1] Ep 182: Loss 0.4190 | Val MAE 1.7905
[P1] Ep 183: Loss 0.4286 | Val MAE 1.9132
[P1] Ep 184: Loss 0.4394 | Val MAE 1.6942
[P1] Ep 185: Loss 0.4217 | Val MAE 1.8643
[P1] Ep 186: Loss 0.4364 | Val MAE 1.9224
[P1] Ep 187: Loss 0.4206 | Val MAE 1.7711
[P1] Ep 188: Loss 0.4301 | Val MAE 1.8793
[P1] Ep 189: Loss 0.4231 | Val MAE 1.8044
[P1] Ep 190: Loss 0.4220 | Val MAE 1.8044
[P1] Ep 191: Loss 0.4064 | Val MAE 1.9109
[P1] Ep 192: Loss 0.4204 | Val MAE 1.6916
[P1] Ep 193: Loss 0.4072 | Val MAE 1.8014
[P1] Ep 194: Loss 0.4196 | Val MAE 1.6625
[P1] Ep 195: Loss 0.4026 | Val MAE 1.8928
[P1] Ep 196: Loss 0.3992 | Val MAE 1.9103
[P1] Ep 197: Loss 0.4133 | Val MAE 1.7948
[P1] Ep 198: Loss 0.4128 | Val MAE 1.8844
[P1] Ep 199: Loss 0.4094 | Val MAE 1.8014
[P1] Ep 200: Loss 0.3996 | Val MAE 1.8087

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 6.8723 | Val MAE 1.4951 CI 0.5497
[FT] Ep 2: Loss 6.3341 | Val MAE 1.5108 CI 0.5556
[FT] Ep 3: Loss 6.3760 | Val MAE 1.5063 CI 0.5614
[FT] Ep 4: Loss 6.0069 | Val MAE 1.4805 CI 0.5556
[FT] Ep 5: Loss 6.1331 | Val MAE 1.4509 CI 0.5848
[FT] Ep 6: Loss 6.3342 | Val MAE 1.4318 CI 0.5848
[FT] Ep 7: Loss 6.1210 | Val MAE 1.4125 CI 0.5965
[FT] Ep 8: Loss 5.8086 | Val MAE 1.3996 CI 0.6082
[FT] Ep 9: Loss 5.8893 | Val MAE 1.3882 CI 0.6140
[FT] Ep 10: Loss 6.1473 | Val MAE 1.3990 CI 0.6140
[FT] Ep 11: Loss 5.7750 | Val MAE 1.4056 CI 0.6199
[FT] Ep 12: Loss 5.8710 | Val MAE 1.4047 CI 0.6082
[FT] Ep 13: Loss 5.5984 | Val MAE 1.4072 CI 0.6082
[FT] Ep 14: Loss 5.9616 | Val MAE 1.4102 CI 0.6023
[FT] Ep 15: Loss 5.8613 | Val MAE 1.4138 CI 0.6257
[FT] Ep 16: Loss 5.3931 | Val MAE 1.4239 CI 0.6140
[FT] Ep 17: Loss 5.5576 | Val MAE 1.4237 CI 0.6257
[FT] Ep 18: Loss 5.4980 | Val MAE 1.4297 CI 0.6316
[FT] Ep 19: Loss 5.6542 | Val MAE 1.4314 CI 0.6433
[FT] Ep 20: Loss 5.4220 | Val MAE 1.4362 CI 0.6433
[FT] Ep 21: Loss 5.2221 | Val MAE 1.4310 CI 0.6433
[FT] Ep 22: Loss 5.4470 | Val MAE 1.4281 CI 0.6491
[FT] Ep 23: Loss 5.6792 | Val MAE 1.4347 CI 0.6550
[FT] Ep 24: Loss 5.5984 | Val MAE 1.4380 CI 0.6608
[FT] Ep 25: Loss 5.0677 | Val MAE 1.4395 CI 0.6433
[FT] Ep 26: Loss 5.6903 | Val MAE 1.4427 CI 0.6550
[FT] Ep 27: Loss 5.3737 | Val MAE 1.4390 CI 0.6491
[FT] Ep 28: Loss 5.4994 | Val MAE 1.4430 CI 0.6491
[FT] Ep 29: Loss 5.6015 | Val MAE 1.4322 CI 0.6550
[FT] Ep 30: Loss 5.2149 | Val MAE 1.4396 CI 0.6608
[FT] Ep 31: Loss 5.2326 | Val MAE 1.4430 CI 0.6667
[FT] Ep 32: Loss 5.2985 | Val MAE 1.4480 CI 0.6608
[FT] Ep 33: Loss 5.4247 | Val MAE 1.4548 CI 0.6550
[FT] Ep 34: Loss 5.3788 | Val MAE 1.4658 CI 0.6491
[FT] Ep 35: Loss 5.2668 | Val MAE 1.4662 CI 0.6433
[FT] Ep 36: Loss 5.1865 | Val MAE 1.4588 CI 0.6608
[FT] Ep 37: Loss 5.2157 | Val MAE 1.4561 CI 0.6374
[FT] Ep 38: Loss 5.2919 | Val MAE 1.4580 CI 0.6433
[FT] Ep 39: Loss 5.3307 | Val MAE 1.4533 CI 0.6433
[FT] Ep 40: Loss 5.0786 | Val MAE 1.4517 CI 0.6316
[FT] Ep 41: Loss 5.2960 | Val MAE 1.4490 CI 0.6023
[FT] Ep 42: Loss 4.7602 | Val MAE 1.4470 CI 0.6023
[FT] Ep 43: Loss 5.0510 | Val MAE 1.4465 CI 0.5965
[FT] Ep 44: Loss 5.1440 | Val MAE 1.4415 CI 0.6082
[FT] Ep 45: Loss 5.2388 | Val MAE 1.4370 CI 0.6257
[FT] Ep 46: Loss 4.9431 | Val MAE 1.4339 CI 0.6316
[FT] Ep 47: Loss 4.7321 | Val MAE 1.4346 CI 0.6374
[FT] Ep 48: Loss 5.1795 | Val MAE 1.4399 CI 0.6257
[FT] Ep 49: Loss 4.7514 | Val MAE 1.4375 CI 0.6316
[FT] Ep 50: Loss 4.8334 | Val MAE 1.4381 CI 0.6316
[FT] Ep 51: Loss 4.8374 | Val MAE 1.4255 CI 0.6433
[FT] Ep 52: Loss 5.0068 | Val MAE 1.4143 CI 0.6491
[FT] Ep 53: Loss 5.0093 | Val MAE 1.4152 CI 0.6433
[FT] Ep 54: Loss 5.0830 | Val MAE 1.4240 CI 0.6374
[FT] Ep 55: Loss 4.8026 | Val MAE 1.4204 CI 0.6374
[FT] Ep 56: Loss 4.8618 | Val MAE 1.4049 CI 0.6550
[FT] Ep 57: Loss 5.1310 | Val MAE 1.3971 CI 0.6608
[FT] Ep 58: Loss 4.9007 | Val MAE 1.3897 CI 0.6725
[FT] Ep 59: Loss 4.9862 | Val MAE 1.3991 CI 0.6608
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: DP
   MAE:  1.5012
   RMSE: 1.8734
   CI:   0.4632
   RM2:  0.0189
   MAPE: 25.77 %
   Acc:  25.00 %
------------------------------------------------------------
