--- DTA Baseline: epsilon-greedy (Ratio: 0.2) ---

>>> [Stage 0] Sampling...

[Sampler] Running epsilon-greedy | Target: 4991/24956 (20.0%)
Scanning Source (epsilon-greedy):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (epsilon-greedy):   4%|▍         | 1/25 [00:03<01:18,  3.27s/it]Scanning Source (epsilon-greedy):   8%|▊         | 2/25 [00:03<00:35,  1.54s/it]Scanning Source (epsilon-greedy):  12%|█▏        | 3/25 [00:03<00:21,  1.01it/s]Scanning Source (epsilon-greedy):  16%|█▌        | 4/25 [00:04<00:15,  1.36it/s]Scanning Source (epsilon-greedy):  20%|██        | 5/25 [00:04<00:11,  1.70it/s]Scanning Source (epsilon-greedy):  24%|██▍       | 6/25 [00:04<00:09,  1.99it/s]Scanning Source (epsilon-greedy):  28%|██▊       | 7/25 [00:05<00:08,  2.23it/s]Scanning Source (epsilon-greedy):  32%|███▏      | 8/25 [00:05<00:06,  2.45it/s]Scanning Source (epsilon-greedy):  36%|███▌      | 9/25 [00:06<00:10,  1.47it/s]Scanning Source (epsilon-greedy):  40%|████      | 10/25 [00:07<00:08,  1.75it/s]Scanning Source (epsilon-greedy):  44%|████▍     | 11/25 [00:07<00:07,  1.96it/s]Scanning Source (epsilon-greedy):  48%|████▊     | 12/25 [00:07<00:05,  2.20it/s]Scanning Source (epsilon-greedy):  52%|█████▏    | 13/25 [00:08<00:07,  1.56it/s]Scanning Source (epsilon-greedy):  56%|█████▌    | 14/25 [00:09<00:06,  1.80it/s]Scanning Source (epsilon-greedy):  60%|██████    | 15/25 [00:09<00:04,  2.06it/s]Scanning Source (epsilon-greedy):  64%|██████▍   | 16/25 [00:09<00:03,  2.28it/s]Scanning Source (epsilon-greedy):  68%|██████▊   | 17/25 [00:10<00:04,  1.65it/s]Scanning Source (epsilon-greedy):  72%|███████▏  | 18/25 [00:11<00:03,  1.92it/s]Scanning Source (epsilon-greedy):  76%|███████▌  | 19/25 [00:11<00:02,  2.13it/s]Scanning Source (epsilon-greedy):  80%|████████  | 20/25 [00:11<00:02,  2.35it/s]Scanning Source (epsilon-greedy):  84%|████████▍ | 21/25 [00:12<00:02,  1.78it/s]Scanning Source (epsilon-greedy):  88%|████████▊ | 22/25 [00:13<00:01,  2.04it/s]Scanning Source (epsilon-greedy):  92%|█████████▏| 23/25 [00:13<00:00,  2.27it/s]Scanning Source (epsilon-greedy):  96%|█████████▌| 24/25 [00:13<00:00,  2.46it/s]Scanning Source (epsilon-greedy): 100%|██████████| 25/25 [00:13<00:00,  3.11it/s]                                                                                 -> Source reduced: 24956 -> 4991

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 3.5439 | Val MAE 1.6274
[P1] Ep 2: Loss 1.7094 | Val MAE 1.6053
[P1] Ep 3: Loss 1.5434 | Val MAE 1.5487
[P1] Ep 4: Loss 1.3729 | Val MAE 1.5864
[P1] Ep 5: Loss 1.3099 | Val MAE 1.5680
[P1] Ep 6: Loss 1.3014 | Val MAE 1.5762
[P1] Ep 7: Loss 1.2454 | Val MAE 1.5680
[P1] Ep 8: Loss 1.2410 | Val MAE 1.5572
[P1] Ep 9: Loss 1.1888 | Val MAE 1.5517
[P1] Ep 10: Loss 1.1803 | Val MAE 1.5551
[P1] Ep 11: Loss 1.1522 | Val MAE 1.5515
[P1] Ep 12: Loss 1.1450 | Val MAE 1.5888
[P1] Ep 13: Loss 1.1293 | Val MAE 1.5927
[P1] Ep 14: Loss 1.0928 | Val MAE 1.5723
[P1] Ep 15: Loss 1.1084 | Val MAE 1.5695
[P1] Ep 16: Loss 1.0696 | Val MAE 1.5792
[P1] Ep 17: Loss 1.0506 | Val MAE 1.5827
[P1] Ep 18: Loss 1.0271 | Val MAE 1.5816
[P1] Ep 19: Loss 1.0300 | Val MAE 1.5291
[P1] Ep 20: Loss 1.0152 | Val MAE 1.5192
[P1] Ep 21: Loss 1.0392 | Val MAE 1.5183
[P1] Ep 22: Loss 1.0534 | Val MAE 1.5352
[P1] Ep 23: Loss 1.0460 | Val MAE 1.5266
[P1] Ep 24: Loss 1.0115 | Val MAE 1.5443
[P1] Ep 25: Loss 1.0168 | Val MAE 1.5691
[P1] Ep 26: Loss 1.0037 | Val MAE 1.5427
[P1] Ep 27: Loss 0.9941 | Val MAE 1.6127
[P1] Ep 28: Loss 1.0186 | Val MAE 1.5187
[P1] Ep 29: Loss 1.0210 | Val MAE 1.5704
[P1] Ep 30: Loss 0.9587 | Val MAE 1.5486
[P1] Ep 31: Loss 0.9743 | Val MAE 1.5428
[P1] Ep 32: Loss 0.9666 | Val MAE 1.5379
[P1] Ep 33: Loss 0.9611 | Val MAE 1.5704
[P1] Ep 34: Loss 0.9891 | Val MAE 1.5292
[P1] Ep 35: Loss 0.9885 | Val MAE 1.5507
[P1] Ep 36: Loss 0.9632 | Val MAE 1.5520
[P1] Ep 37: Loss 0.9595 | Val MAE 1.5758
[P1] Ep 38: Loss 0.9485 | Val MAE 1.5858
[P1] Ep 39: Loss 0.9761 | Val MAE 1.5640
[P1] Ep 40: Loss 0.9642 | Val MAE 1.5623
[P1] Ep 41: Loss 0.9653 | Val MAE 1.5479
[P1] Ep 42: Loss 0.9564 | Val MAE 1.5383
[P1] Ep 43: Loss 0.9317 | Val MAE 1.5805
[P1] Ep 44: Loss 0.9586 | Val MAE 1.5518
[P1] Ep 45: Loss 0.9426 | Val MAE 1.5735
[P1] Ep 46: Loss 0.9347 | Val MAE 1.5709
[P1] Ep 47: Loss 0.9374 | Val MAE 1.5659
[P1] Ep 48: Loss 0.9235 | Val MAE 1.5715
[P1] Ep 49: Loss 0.9233 | Val MAE 1.5547
[P1] Ep 50: Loss 0.9594 | Val MAE 1.5798
[P1] Ep 51: Loss 0.9162 | Val MAE 1.5606
[P1] Ep 52: Loss 0.9381 | Val MAE 1.5528
[P1] Ep 53: Loss 0.9157 | Val MAE 1.5554
[P1] Ep 54: Loss 0.8953 | Val MAE 1.5700
[P1] Ep 55: Loss 0.8953 | Val MAE 1.6154
[P1] Ep 56: Loss 0.9057 | Val MAE 1.5900
[P1] Ep 57: Loss 0.9056 | Val MAE 1.5649
[P1] Ep 58: Loss 0.9117 | Val MAE 1.5609
[P1] Ep 59: Loss 0.9200 | Val MAE 1.5842
[P1] Ep 60: Loss 0.8990 | Val MAE 1.6013
[P1] Ep 61: Loss 0.8983 | Val MAE 1.5432
[P1] Ep 62: Loss 0.8960 | Val MAE 1.6038
[P1] Ep 63: Loss 0.8986 | Val MAE 1.5447
[P1] Ep 64: Loss 0.8957 | Val MAE 1.5863
[P1] Ep 65: Loss 0.8955 | Val MAE 1.5773
[P1] Ep 66: Loss 0.9064 | Val MAE 1.5326
[P1] Ep 67: Loss 0.9193 | Val MAE 1.5523
[P1] Ep 68: Loss 0.8830 | Val MAE 1.5856
[P1] Ep 69: Loss 0.8867 | Val MAE 1.5535
[P1] Ep 70: Loss 0.8760 | Val MAE 1.5892
[P1] Ep 71: Loss 0.8766 | Val MAE 1.5338
[P1] Ep 72: Loss 0.8698 | Val MAE 1.5597
[P1] Ep 73: Loss 0.8751 | Val MAE 1.5484
[P1] Ep 74: Loss 0.8738 | Val MAE 1.5472
[P1] Ep 75: Loss 0.8793 | Val MAE 1.5981
[P1] Ep 76: Loss 0.8736 | Val MAE 1.5990
[P1] Ep 77: Loss 0.8639 | Val MAE 1.5617
[P1] Ep 78: Loss 0.8426 | Val MAE 1.5833
[P1] Ep 79: Loss 0.8635 | Val MAE 1.5509
[P1] Ep 80: Loss 0.8655 | Val MAE 1.6201
[P1] Ep 81: Loss 0.8586 | Val MAE 1.5695
[P1] Ep 82: Loss 0.8539 | Val MAE 1.5845
[P1] Ep 83: Loss 0.8363 | Val MAE 1.6259
[P1] Ep 84: Loss 0.8551 | Val MAE 1.6619
[P1] Ep 85: Loss 0.8602 | Val MAE 1.5731
[P1] Ep 86: Loss 0.8066 | Val MAE 1.6114
[P1] Ep 87: Loss 0.8429 | Val MAE 1.5456
[P1] Ep 88: Loss 0.8349 | Val MAE 1.5900
[P1] Ep 89: Loss 0.8458 | Val MAE 1.5426
[P1] Ep 90: Loss 0.8229 | Val MAE 1.6316
[P1] Ep 91: Loss 0.8243 | Val MAE 1.6235
[P1] Ep 92: Loss 0.8397 | Val MAE 1.5698
[P1] Ep 93: Loss 0.7873 | Val MAE 1.6202
[P1] Ep 94: Loss 0.7992 | Val MAE 1.6178
[P1] Ep 95: Loss 0.8074 | Val MAE 1.6278
[P1] Ep 96: Loss 0.8098 | Val MAE 1.6204
[P1] Ep 97: Loss 0.8163 | Val MAE 1.5792
[P1] Ep 98: Loss 0.7763 | Val MAE 1.6001
[P1] Ep 99: Loss 0.7819 | Val MAE 1.6142
[P1] Ep 100: Loss 0.7899 | Val MAE 1.6336
[P1] Ep 101: Loss 0.8053 | Val MAE 1.5823
[P1] Ep 102: Loss 0.7846 | Val MAE 1.5771
[P1] Ep 103: Loss 0.7599 | Val MAE 1.6607
[P1] Ep 104: Loss 0.7851 | Val MAE 1.5685
[P1] Ep 105: Loss 0.7772 | Val MAE 1.6626
[P1] Ep 106: Loss 0.7642 | Val MAE 1.6497
[P1] Ep 107: Loss 0.7552 | Val MAE 1.6693
[P1] Ep 108: Loss 0.7521 | Val MAE 1.7104
[P1] Ep 109: Loss 0.7196 | Val MAE 1.6257
[P1] Ep 110: Loss 0.7688 | Val MAE 1.7162
[P1] Ep 111: Loss 0.7393 | Val MAE 1.6328
[P1] Ep 112: Loss 0.7668 | Val MAE 1.6193
[P1] Ep 113: Loss 0.7538 | Val MAE 1.6465
[P1] Ep 114: Loss 0.7410 | Val MAE 1.6140
[P1] Ep 115: Loss 0.7511 | Val MAE 1.7163
[P1] Ep 116: Loss 0.7412 | Val MAE 1.6519
[P1] Ep 117: Loss 0.7400 | Val MAE 1.6881
[P1] Ep 118: Loss 0.7326 | Val MAE 1.6911
[P1] Ep 119: Loss 0.7438 | Val MAE 1.6576
[P1] Ep 120: Loss 0.7302 | Val MAE 1.6685
[P1] Ep 121: Loss 0.7342 | Val MAE 1.6285
[P1] Ep 122: Loss 0.7474 | Val MAE 1.7375
[P1] Ep 123: Loss 0.7128 | Val MAE 1.6527
[P1] Ep 124: Loss 0.7083 | Val MAE 1.7102
[P1] Ep 125: Loss 0.7160 | Val MAE 1.7214
[P1] Ep 126: Loss 0.7166 | Val MAE 1.7274
[P1] Ep 127: Loss 0.6907 | Val MAE 1.6591
[P1] Ep 128: Loss 0.7229 | Val MAE 1.6630
[P1] Ep 129: Loss 0.7220 | Val MAE 1.6772
[P1] Ep 130: Loss 0.6975 | Val MAE 1.7163
[P1] Ep 131: Loss 0.7043 | Val MAE 1.6792
[P1] Ep 132: Loss 0.6946 | Val MAE 1.6527
[P1] Ep 133: Loss 0.7311 | Val MAE 1.6702
[P1] Ep 134: Loss 0.7087 | Val MAE 1.5531
[P1] Ep 135: Loss 0.6834 | Val MAE 1.7825
[P1] Ep 136: Loss 0.7114 | Val MAE 1.6826
[P1] Ep 137: Loss 0.6805 | Val MAE 1.6735
[P1] Ep 138: Loss 0.6929 | Val MAE 1.7103
[P1] Ep 139: Loss 0.6678 | Val MAE 1.6770
[P1] Ep 140: Loss 0.6795 | Val MAE 1.6340
[P1] Ep 141: Loss 0.6924 | Val MAE 1.6546
[P1] Ep 142: Loss 0.6823 | Val MAE 1.6460
[P1] Ep 143: Loss 0.6714 | Val MAE 1.6530
[P1] Ep 144: Loss 0.6747 | Val MAE 1.6972
[P1] Ep 145: Loss 0.6767 | Val MAE 1.6668
[P1] Ep 146: Loss 0.6818 | Val MAE 1.6149
[P1] Ep 147: Loss 0.6873 | Val MAE 1.6184
[P1] Ep 148: Loss 0.6762 | Val MAE 1.6397
[P1] Ep 149: Loss 0.6739 | Val MAE 1.6999
[P1] Ep 150: Loss 0.6776 | Val MAE 1.7147
[P1] Ep 151: Loss 0.6508 | Val MAE 1.5731
[P1] Ep 152: Loss 0.6656 | Val MAE 1.6707
[P1] Ep 153: Loss 0.6551 | Val MAE 1.7070
[P1] Ep 154: Loss 0.6599 | Val MAE 1.6938
[P1] Ep 155: Loss 0.6639 | Val MAE 1.6432
[P1] Ep 156: Loss 0.6618 | Val MAE 1.6791
[P1] Ep 157: Loss 0.6600 | Val MAE 1.7681
[P1] Ep 158: Loss 0.6649 | Val MAE 1.7313
[P1] Ep 159: Loss 0.6431 | Val MAE 1.6966
[P1] Ep 160: Loss 0.6516 | Val MAE 1.6708
[P1] Ep 161: Loss 0.6433 | Val MAE 1.7385
[P1] Ep 162: Loss 0.6491 | Val MAE 1.6207
[P1] Ep 163: Loss 0.6445 | Val MAE 1.6915
[P1] Ep 164: Loss 0.6319 | Val MAE 1.6528
[P1] Ep 165: Loss 0.6360 | Val MAE 1.7411
[P1] Ep 166: Loss 0.6554 | Val MAE 1.6467
[P1] Ep 167: Loss 0.6446 | Val MAE 1.6070
[P1] Ep 168: Loss 0.6321 | Val MAE 1.6728
[P1] Ep 169: Loss 0.6313 | Val MAE 1.7050
[P1] Ep 170: Loss 0.6340 | Val MAE 1.6811
[P1] Ep 171: Loss 0.6272 | Val MAE 1.7143
[P1] Ep 172: Loss 0.6233 | Val MAE 1.7048
[P1] Ep 173: Loss 0.6267 | Val MAE 1.6269
[P1] Ep 174: Loss 0.6078 | Val MAE 1.6376
[P1] Ep 175: Loss 0.6353 | Val MAE 1.6811
[P1] Ep 176: Loss 0.6036 | Val MAE 1.6714
[P1] Ep 177: Loss 0.6081 | Val MAE 1.6858
[P1] Ep 178: Loss 0.6194 | Val MAE 1.6977
[P1] Ep 179: Loss 0.6075 | Val MAE 1.7356
[P1] Ep 180: Loss 0.6129 | Val MAE 1.7339
[P1] Ep 181: Loss 0.6197 | Val MAE 1.6813
[P1] Ep 182: Loss 0.6124 | Val MAE 1.6913
[P1] Ep 183: Loss 0.6012 | Val MAE 1.7328
[P1] Ep 184: Loss 0.6070 | Val MAE 1.6251
[P1] Ep 185: Loss 0.6159 | Val MAE 1.6821
[P1] Ep 186: Loss 0.5880 | Val MAE 1.5993
[P1] Ep 187: Loss 0.5907 | Val MAE 1.6556
[P1] Ep 188: Loss 0.5998 | Val MAE 1.7370
[P1] Ep 189: Loss 0.6131 | Val MAE 1.6615
[P1] Ep 190: Loss 0.5899 | Val MAE 1.6574
[P1] Ep 191: Loss 0.5936 | Val MAE 1.6789
[P1] Ep 192: Loss 0.6028 | Val MAE 1.7161
[P1] Ep 193: Loss 0.5969 | Val MAE 1.6959
[P1] Ep 194: Loss 0.5695 | Val MAE 1.7182
[P1] Ep 195: Loss 0.5695 | Val MAE 1.7074
[P1] Ep 196: Loss 0.5701 | Val MAE 1.7194
[P1] Ep 197: Loss 0.5675 | Val MAE 1.6641
[P1] Ep 198: Loss 0.5762 | Val MAE 1.6067
[P1] Ep 199: Loss 0.5704 | Val MAE 1.6935
[P1] Ep 200: Loss 0.5946 | Val MAE 1.6780

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 6.2286 | Val MAE 1.5273 CI 0.5906
[FT] Ep 2: Loss 6.3216 | Val MAE 1.5388 CI 0.5906
[FT] Ep 3: Loss 6.1482 | Val MAE 1.5200 CI 0.6082
[FT] Ep 4: Loss 6.0063 | Val MAE 1.5106 CI 0.6082
[FT] Ep 5: Loss 5.5421 | Val MAE 1.4913 CI 0.6023
[FT] Ep 6: Loss 5.6823 | Val MAE 1.4864 CI 0.6199
[FT] Ep 7: Loss 5.7295 | Val MAE 1.4880 CI 0.6140
[FT] Ep 8: Loss 5.7621 | Val MAE 1.4788 CI 0.6199
[FT] Ep 9: Loss 5.7387 | Val MAE 1.4721 CI 0.6140
[FT] Ep 10: Loss 5.8926 | Val MAE 1.4879 CI 0.6257
[FT] Ep 11: Loss 5.4518 | Val MAE 1.4946 CI 0.6374
[FT] Ep 12: Loss 5.6098 | Val MAE 1.4857 CI 0.6550
[FT] Ep 13: Loss 5.3220 | Val MAE 1.4770 CI 0.6784
[FT] Ep 14: Loss 5.5080 | Val MAE 1.4747 CI 0.6725
[FT] Ep 15: Loss 5.4694 | Val MAE 1.4779 CI 0.6667
[FT] Ep 16: Loss 5.1835 | Val MAE 1.4874 CI 0.6608
[FT] Ep 17: Loss 5.4636 | Val MAE 1.4952 CI 0.6550
[FT] Ep 18: Loss 5.3829 | Val MAE 1.4982 CI 0.6550
[FT] Ep 19: Loss 5.1617 | Val MAE 1.4979 CI 0.6608
[FT] Ep 20: Loss 5.5280 | Val MAE 1.5086 CI 0.6725
[FT] Ep 21: Loss 5.1323 | Val MAE 1.5083 CI 0.6725
[FT] Ep 22: Loss 5.5401 | Val MAE 1.5074 CI 0.6667
[FT] Ep 23: Loss 5.7028 | Val MAE 1.5147 CI 0.6784
[FT] Ep 24: Loss 5.2605 | Val MAE 1.5106 CI 0.6784
[FT] Ep 25: Loss 5.6305 | Val MAE 1.5067 CI 0.7076
[FT] Ep 26: Loss 5.3956 | Val MAE 1.5181 CI 0.7018
[FT] Ep 27: Loss 5.5222 | Val MAE 1.5194 CI 0.6959
[FT] Ep 28: Loss 5.5124 | Val MAE 1.5063 CI 0.6901
[FT] Ep 29: Loss 5.0583 | Val MAE 1.5011 CI 0.6725
[FT] Ep 30: Loss 5.4766 | Val MAE 1.5106 CI 0.6550
[FT] Ep 31: Loss 5.1887 | Val MAE 1.5216 CI 0.6667
[FT] Ep 32: Loss 5.4187 | Val MAE 1.5242 CI 0.6667
[FT] Ep 33: Loss 5.1712 | Val MAE 1.5177 CI 0.6550
[FT] Ep 34: Loss 5.3888 | Val MAE 1.5177 CI 0.6842
[FT] Ep 35: Loss 5.4096 | Val MAE 1.5125 CI 0.6550
[FT] Ep 36: Loss 5.6005 | Val MAE 1.5110 CI 0.6491
[FT] Ep 37: Loss 5.0541 | Val MAE 1.5169 CI 0.6491
[FT] Ep 38: Loss 5.0501 | Val MAE 1.5246 CI 0.6433
[FT] Ep 39: Loss 5.2450 | Val MAE 1.5204 CI 0.6316
[FT] Ep 40: Loss 5.2945 | Val MAE 1.5325 CI 0.6257
[FT] Ep 41: Loss 5.6246 | Val MAE 1.5458 CI 0.6023
[FT] Ep 42: Loss 5.2755 | Val MAE 1.5444 CI 0.5906
[FT] Ep 43: Loss 5.1892 | Val MAE 1.5388 CI 0.6023
[FT] Ep 44: Loss 4.9600 | Val MAE 1.5306 CI 0.5965
[FT] Ep 45: Loss 5.1726 | Val MAE 1.5269 CI 0.6082
[FT] Ep 46: Loss 5.1895 | Val MAE 1.5310 CI 0.5965
[FT] Ep 47: Loss 4.7930 | Val MAE 1.5447 CI 0.5789
[FT] Ep 48: Loss 5.0620 | Val MAE 1.5558 CI 0.5848
[FT] Ep 49: Loss 5.1013 | Val MAE 1.5484 CI 0.5906
[FT] Ep 50: Loss 5.2267 | Val MAE 1.5460 CI 0.5731
[FT] Ep 51: Loss 5.1061 | Val MAE 1.5392 CI 0.5789
[FT] Ep 52: Loss 4.6191 | Val MAE 1.5416 CI 0.5906
[FT] Ep 53: Loss 5.0445 | Val MAE 1.5511 CI 0.5848
[FT] Ep 54: Loss 4.8678 | Val MAE 1.5532 CI 0.5906
[FT] Ep 55: Loss 5.2454 | Val MAE 1.5698 CI 0.5848
[FT] Ep 56: Loss 4.9358 | Val MAE 1.5595 CI 0.5906
[FT] Ep 57: Loss 4.8946 | Val MAE 1.5558 CI 0.5906
[FT] Ep 58: Loss 4.6958 | Val MAE 1.5599 CI 0.5789
[FT] Ep 59: Loss 4.7846 | Val MAE 1.5759 CI 0.5673
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: epsilon-greedy
   MAE:  1.5443
   RMSE: 1.9005
   CI:   0.4474
   RM2:  0.0066
   MAPE: 25.44 %
   Acc:  35.00 %
------------------------------------------------------------
