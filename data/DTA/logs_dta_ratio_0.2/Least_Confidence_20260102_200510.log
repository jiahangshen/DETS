--- DTA Baseline: Least Confidence (Ratio: 0.2) ---

>>> [Stage 0] Sampling...

[Sampler] Running Least Confidence | Target: 4991/24956 (20.0%)
Scanning Source (Least Confidence):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (Least Confidence):   4%|▍         | 1/25 [00:03<01:23,  3.49s/it]Scanning Source (Least Confidence):   8%|▊         | 2/25 [00:03<00:37,  1.65s/it]Scanning Source (Least Confidence):  12%|█▏        | 3/25 [00:04<00:23,  1.05s/it]Scanning Source (Least Confidence):  16%|█▌        | 4/25 [00:04<00:16,  1.31it/s]Scanning Source (Least Confidence):  20%|██        | 5/25 [00:05<00:15,  1.30it/s]Scanning Source (Least Confidence):  24%|██▍       | 6/25 [00:05<00:11,  1.62it/s]Scanning Source (Least Confidence):  28%|██▊       | 7/25 [00:05<00:09,  1.90it/s]Scanning Source (Least Confidence):  32%|███▏      | 8/25 [00:06<00:07,  2.15it/s]Scanning Source (Least Confidence):  36%|███▌      | 9/25 [00:07<00:13,  1.21it/s]Scanning Source (Least Confidence):  40%|████      | 10/25 [00:08<00:10,  1.47it/s]Scanning Source (Least Confidence):  44%|████▍     | 11/25 [00:08<00:08,  1.74it/s]Scanning Source (Least Confidence):  48%|████▊     | 12/25 [00:08<00:06,  1.98it/s]Scanning Source (Least Confidence):  52%|█████▏    | 13/25 [00:10<00:10,  1.19it/s]Scanning Source (Least Confidence):  56%|█████▌    | 14/25 [00:10<00:07,  1.45it/s]Scanning Source (Least Confidence):  60%|██████    | 15/25 [00:11<00:05,  1.71it/s]Scanning Source (Least Confidence):  64%|██████▍   | 16/25 [00:11<00:04,  1.95it/s]Scanning Source (Least Confidence):  68%|██████▊   | 17/25 [00:12<00:05,  1.35it/s]Scanning Source (Least Confidence):  72%|███████▏  | 18/25 [00:13<00:04,  1.63it/s]Scanning Source (Least Confidence):  76%|███████▌  | 19/25 [00:13<00:03,  1.89it/s]Scanning Source (Least Confidence):  80%|████████  | 20/25 [00:13<00:02,  2.14it/s]Scanning Source (Least Confidence):  84%|████████▍ | 21/25 [00:14<00:02,  1.58it/s]Scanning Source (Least Confidence):  88%|████████▊ | 22/25 [00:15<00:01,  1.85it/s]Scanning Source (Least Confidence):  92%|█████████▏| 23/25 [00:15<00:00,  2.10it/s]Scanning Source (Least Confidence):  96%|█████████▌| 24/25 [00:15<00:00,  2.31it/s]Scanning Source (Least Confidence): 100%|██████████| 25/25 [00:15<00:00,  2.95it/s]                                                                                   -> Source reduced: 24956 -> 4991

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 3.3730 | Val MAE 1.5936
[P1] Ep 2: Loss 1.5218 | Val MAE 1.5837
[P1] Ep 3: Loss 1.3569 | Val MAE 1.6540
[P1] Ep 4: Loss 1.2056 | Val MAE 1.6158
[P1] Ep 5: Loss 1.1310 | Val MAE 1.6037
[P1] Ep 6: Loss 1.0928 | Val MAE 1.5981
[P1] Ep 7: Loss 1.0837 | Val MAE 1.5609
[P1] Ep 8: Loss 1.0473 | Val MAE 1.5784
[P1] Ep 9: Loss 1.0030 | Val MAE 1.5699
[P1] Ep 10: Loss 0.9970 | Val MAE 1.5865
[P1] Ep 11: Loss 0.9843 | Val MAE 1.5907
[P1] Ep 12: Loss 0.9611 | Val MAE 1.5745
[P1] Ep 13: Loss 0.9678 | Val MAE 1.5946
[P1] Ep 14: Loss 0.9424 | Val MAE 1.5936
[P1] Ep 15: Loss 0.9224 | Val MAE 1.5732
[P1] Ep 16: Loss 0.9148 | Val MAE 1.5651
[P1] Ep 17: Loss 0.8934 | Val MAE 1.5525
[P1] Ep 18: Loss 0.8826 | Val MAE 1.5467
[P1] Ep 19: Loss 0.8718 | Val MAE 1.5455
[P1] Ep 20: Loss 0.8618 | Val MAE 1.5533
[P1] Ep 21: Loss 0.8291 | Val MAE 1.5541
[P1] Ep 22: Loss 0.8530 | Val MAE 1.5334
[P1] Ep 23: Loss 0.8584 | Val MAE 1.5339
[P1] Ep 24: Loss 0.8152 | Val MAE 1.4927
[P1] Ep 25: Loss 0.8370 | Val MAE 1.5590
[P1] Ep 26: Loss 0.8023 | Val MAE 1.5351
[P1] Ep 27: Loss 0.8107 | Val MAE 1.5458
[P1] Ep 28: Loss 0.8126 | Val MAE 1.5234
[P1] Ep 29: Loss 0.8069 | Val MAE 1.5185
[P1] Ep 30: Loss 0.7805 | Val MAE 1.5288
[P1] Ep 31: Loss 0.8041 | Val MAE 1.5462
[P1] Ep 32: Loss 0.8170 | Val MAE 1.5272
[P1] Ep 33: Loss 0.7939 | Val MAE 1.5484
[P1] Ep 34: Loss 0.7831 | Val MAE 1.5087
[P1] Ep 35: Loss 0.8149 | Val MAE 1.5356
[P1] Ep 36: Loss 0.7815 | Val MAE 1.5707
[P1] Ep 37: Loss 0.7838 | Val MAE 1.5256
[P1] Ep 38: Loss 0.7544 | Val MAE 1.5367
[P1] Ep 39: Loss 0.7926 | Val MAE 1.5019
[P1] Ep 40: Loss 0.7832 | Val MAE 1.4828
[P1] Ep 41: Loss 0.7463 | Val MAE 1.5175
[P1] Ep 42: Loss 0.7876 | Val MAE 1.5404
[P1] Ep 43: Loss 0.7393 | Val MAE 1.5347
[P1] Ep 44: Loss 0.7656 | Val MAE 1.5237
[P1] Ep 45: Loss 0.7793 | Val MAE 1.4852
[P1] Ep 46: Loss 0.7824 | Val MAE 1.4853
[P1] Ep 47: Loss 0.7394 | Val MAE 1.4799
[P1] Ep 48: Loss 0.7543 | Val MAE 1.4939
[P1] Ep 49: Loss 0.7304 | Val MAE 1.4938
[P1] Ep 50: Loss 0.7355 | Val MAE 1.4862
[P1] Ep 51: Loss 0.7387 | Val MAE 1.5118
[P1] Ep 52: Loss 0.7562 | Val MAE 1.4963
[P1] Ep 53: Loss 0.7355 | Val MAE 1.5187
[P1] Ep 54: Loss 0.7285 | Val MAE 1.5162
[P1] Ep 55: Loss 0.7381 | Val MAE 1.5586
[P1] Ep 56: Loss 0.7220 | Val MAE 1.4767
[P1] Ep 57: Loss 0.7491 | Val MAE 1.4686
[P1] Ep 58: Loss 0.7001 | Val MAE 1.5056
[P1] Ep 59: Loss 0.7060 | Val MAE 1.4673
[P1] Ep 60: Loss 0.7394 | Val MAE 1.4882
[P1] Ep 61: Loss 0.7254 | Val MAE 1.5100
[P1] Ep 62: Loss 0.7311 | Val MAE 1.5098
[P1] Ep 63: Loss 0.7205 | Val MAE 1.4670
[P1] Ep 64: Loss 0.7233 | Val MAE 1.4736
[P1] Ep 65: Loss 0.7156 | Val MAE 1.4895
[P1] Ep 66: Loss 0.7069 | Val MAE 1.5253
[P1] Ep 67: Loss 0.7225 | Val MAE 1.4956
[P1] Ep 68: Loss 0.7016 | Val MAE 1.5456
[P1] Ep 69: Loss 0.7238 | Val MAE 1.5483
[P1] Ep 70: Loss 0.6906 | Val MAE 1.5125
[P1] Ep 71: Loss 0.6794 | Val MAE 1.4536
[P1] Ep 72: Loss 0.7063 | Val MAE 1.4682
[P1] Ep 73: Loss 0.6860 | Val MAE 1.4872
[P1] Ep 74: Loss 0.6833 | Val MAE 1.4593
[P1] Ep 75: Loss 0.6892 | Val MAE 1.5124
[P1] Ep 76: Loss 0.6842 | Val MAE 1.4459
[P1] Ep 77: Loss 0.6625 | Val MAE 1.4660
[P1] Ep 78: Loss 0.6892 | Val MAE 1.5178
[P1] Ep 79: Loss 0.6648 | Val MAE 1.5224
[P1] Ep 80: Loss 0.6753 | Val MAE 1.5049
[P1] Ep 81: Loss 0.6945 | Val MAE 1.4685
[P1] Ep 82: Loss 0.6711 | Val MAE 1.5216
[P1] Ep 83: Loss 0.6700 | Val MAE 1.5078
[P1] Ep 84: Loss 0.6485 | Val MAE 1.5689
[P1] Ep 85: Loss 0.6809 | Val MAE 1.5497
[P1] Ep 86: Loss 0.6488 | Val MAE 1.5347
[P1] Ep 87: Loss 0.6663 | Val MAE 1.5011
[P1] Ep 88: Loss 0.6538 | Val MAE 1.4958
[P1] Ep 89: Loss 0.6577 | Val MAE 1.5086
[P1] Ep 90: Loss 0.6488 | Val MAE 1.4844
[P1] Ep 91: Loss 0.6476 | Val MAE 1.5174
[P1] Ep 92: Loss 0.6612 | Val MAE 1.4886
[P1] Ep 93: Loss 0.6365 | Val MAE 1.5623
[P1] Ep 94: Loss 0.6393 | Val MAE 1.5343
[P1] Ep 95: Loss 0.6254 | Val MAE 1.5032
[P1] Ep 96: Loss 0.6155 | Val MAE 1.5437
[P1] Ep 97: Loss 0.6334 | Val MAE 1.5204
[P1] Ep 98: Loss 0.6189 | Val MAE 1.4890
[P1] Ep 99: Loss 0.6161 | Val MAE 1.4813
[P1] Ep 100: Loss 0.6227 | Val MAE 1.5074
[P1] Ep 101: Loss 0.6313 | Val MAE 1.4609
[P1] Ep 102: Loss 0.6177 | Val MAE 1.5060
[P1] Ep 103: Loss 0.6219 | Val MAE 1.5187
[P1] Ep 104: Loss 0.6218 | Val MAE 1.5117
[P1] Ep 105: Loss 0.6283 | Val MAE 1.5438
[P1] Ep 106: Loss 0.6174 | Val MAE 1.5396
[P1] Ep 107: Loss 0.6057 | Val MAE 1.5219
[P1] Ep 108: Loss 0.6057 | Val MAE 1.5387
[P1] Ep 109: Loss 0.6052 | Val MAE 1.4925
[P1] Ep 110: Loss 0.6097 | Val MAE 1.5639
[P1] Ep 111: Loss 0.6261 | Val MAE 1.5768
[P1] Ep 112: Loss 0.6040 | Val MAE 1.5697
[P1] Ep 113: Loss 0.5861 | Val MAE 1.5373
[P1] Ep 114: Loss 0.5895 | Val MAE 1.5710
[P1] Ep 115: Loss 0.6092 | Val MAE 1.5309
[P1] Ep 116: Loss 0.6127 | Val MAE 1.5476
[P1] Ep 117: Loss 0.6041 | Val MAE 1.5784
[P1] Ep 118: Loss 0.5822 | Val MAE 1.5602
[P1] Ep 119: Loss 0.5861 | Val MAE 1.5900
[P1] Ep 120: Loss 0.5874 | Val MAE 1.6010
[P1] Ep 121: Loss 0.5836 | Val MAE 1.5740
[P1] Ep 122: Loss 0.5879 | Val MAE 1.5797
[P1] Ep 123: Loss 0.5923 | Val MAE 1.5095
[P1] Ep 124: Loss 0.6028 | Val MAE 1.5834
[P1] Ep 125: Loss 0.5761 | Val MAE 1.6095
[P1] Ep 126: Loss 0.5877 | Val MAE 1.6122
[P1] Ep 127: Loss 0.5658 | Val MAE 1.5930
[P1] Ep 128: Loss 0.5704 | Val MAE 1.6347
[P1] Ep 129: Loss 0.5617 | Val MAE 1.5718
[P1] Ep 130: Loss 0.5629 | Val MAE 1.5834
[P1] Ep 131: Loss 0.5598 | Val MAE 1.6288
[P1] Ep 132: Loss 0.5718 | Val MAE 1.5965
[P1] Ep 133: Loss 0.5813 | Val MAE 1.6035
[P1] Ep 134: Loss 0.5806 | Val MAE 1.6140
[P1] Ep 135: Loss 0.5661 | Val MAE 1.6123
[P1] Ep 136: Loss 0.5658 | Val MAE 1.5648
[P1] Ep 137: Loss 0.5685 | Val MAE 1.6226
[P1] Ep 138: Loss 0.5675 | Val MAE 1.6003
[P1] Ep 139: Loss 0.5629 | Val MAE 1.6282
[P1] Ep 140: Loss 0.5775 | Val MAE 1.5791
[P1] Ep 141: Loss 0.5537 | Val MAE 1.5916
[P1] Ep 142: Loss 0.5607 | Val MAE 1.6196
[P1] Ep 143: Loss 0.5446 | Val MAE 1.6193
[P1] Ep 144: Loss 0.5440 | Val MAE 1.6589
[P1] Ep 145: Loss 0.5563 | Val MAE 1.6021
[P1] Ep 146: Loss 0.5476 | Val MAE 1.6702
[P1] Ep 147: Loss 0.5453 | Val MAE 1.6684
[P1] Ep 148: Loss 0.5464 | Val MAE 1.5807
[P1] Ep 149: Loss 0.5511 | Val MAE 1.6155
[P1] Ep 150: Loss 0.5537 | Val MAE 1.6526
[P1] Ep 151: Loss 0.5409 | Val MAE 1.5043
[P1] Ep 152: Loss 0.5436 | Val MAE 1.5876
[P1] Ep 153: Loss 0.5393 | Val MAE 1.5259
[P1] Ep 154: Loss 0.5406 | Val MAE 1.5770
[P1] Ep 155: Loss 0.5335 | Val MAE 1.5255
[P1] Ep 156: Loss 0.5308 | Val MAE 1.5739
[P1] Ep 157: Loss 0.5315 | Val MAE 1.6149
[P1] Ep 158: Loss 0.5443 | Val MAE 1.6293
[P1] Ep 159: Loss 0.5375 | Val MAE 1.5959
[P1] Ep 160: Loss 0.5337 | Val MAE 1.6202
[P1] Ep 161: Loss 0.5253 | Val MAE 1.6926
[P1] Ep 162: Loss 0.5264 | Val MAE 1.6582
[P1] Ep 163: Loss 0.5391 | Val MAE 1.6295
[P1] Ep 164: Loss 0.5190 | Val MAE 1.6183
[P1] Ep 165: Loss 0.5168 | Val MAE 1.5969
[P1] Ep 166: Loss 0.5230 | Val MAE 1.6303
[P1] Ep 167: Loss 0.5379 | Val MAE 1.5063
[P1] Ep 168: Loss 0.5260 | Val MAE 1.5999
[P1] Ep 169: Loss 0.5370 | Val MAE 1.6760
[P1] Ep 170: Loss 0.5188 | Val MAE 1.6555
[P1] Ep 171: Loss 0.5232 | Val MAE 1.6191
[P1] Ep 172: Loss 0.5130 | Val MAE 1.5210
[P1] Ep 173: Loss 0.5257 | Val MAE 1.6165
[P1] Ep 174: Loss 0.5294 | Val MAE 1.7393
[P1] Ep 175: Loss 0.5047 | Val MAE 1.5464
[P1] Ep 176: Loss 0.5175 | Val MAE 1.5949
[P1] Ep 177: Loss 0.5109 | Val MAE 1.5313
[P1] Ep 178: Loss 0.5104 | Val MAE 1.5879
[P1] Ep 179: Loss 0.5135 | Val MAE 1.6063
[P1] Ep 180: Loss 0.5138 | Val MAE 1.6246
[P1] Ep 181: Loss 0.4867 | Val MAE 1.6304
[P1] Ep 182: Loss 0.5101 | Val MAE 1.5759
[P1] Ep 183: Loss 0.4977 | Val MAE 1.6165
[P1] Ep 184: Loss 0.5015 | Val MAE 1.5588
[P1] Ep 185: Loss 0.5120 | Val MAE 1.5911
[P1] Ep 186: Loss 0.5039 | Val MAE 1.6264
[P1] Ep 187: Loss 0.4940 | Val MAE 1.6226
[P1] Ep 188: Loss 0.4930 | Val MAE 1.5505
[P1] Ep 189: Loss 0.4928 | Val MAE 1.5512
[P1] Ep 190: Loss 0.4935 | Val MAE 1.5878
[P1] Ep 191: Loss 0.5053 | Val MAE 1.6292
[P1] Ep 192: Loss 0.4905 | Val MAE 1.5875
[P1] Ep 193: Loss 0.4745 | Val MAE 1.6214
[P1] Ep 194: Loss 0.4918 | Val MAE 1.5638
[P1] Ep 195: Loss 0.4775 | Val MAE 1.5327
[P1] Ep 196: Loss 0.4832 | Val MAE 1.6127
[P1] Ep 197: Loss 0.4647 | Val MAE 1.5601
[P1] Ep 198: Loss 0.4919 | Val MAE 1.5773
[P1] Ep 199: Loss 0.4819 | Val MAE 1.5224
[P1] Ep 200: Loss 0.4776 | Val MAE 1.5723

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 5.8635 | Val MAE 1.4483 CI 0.5906
[FT] Ep 2: Loss 6.0234 | Val MAE 1.4403 CI 0.6199
[FT] Ep 3: Loss 5.9168 | Val MAE 1.4146 CI 0.6082
[FT] Ep 4: Loss 5.7909 | Val MAE 1.3971 CI 0.6082
[FT] Ep 5: Loss 5.7689 | Val MAE 1.3833 CI 0.6199
[FT] Ep 6: Loss 6.0518 | Val MAE 1.3718 CI 0.6374
[FT] Ep 7: Loss 5.6943 | Val MAE 1.3622 CI 0.6316
[FT] Ep 8: Loss 5.5802 | Val MAE 1.3629 CI 0.6374
[FT] Ep 9: Loss 5.7572 | Val MAE 1.3615 CI 0.6374
[FT] Ep 10: Loss 5.6473 | Val MAE 1.3806 CI 0.6199
[FT] Ep 11: Loss 5.4550 | Val MAE 1.3847 CI 0.6257
[FT] Ep 12: Loss 5.7106 | Val MAE 1.3847 CI 0.6374
[FT] Ep 13: Loss 5.3896 | Val MAE 1.3891 CI 0.6433
[FT] Ep 14: Loss 5.7060 | Val MAE 1.3932 CI 0.6550
[FT] Ep 15: Loss 5.7570 | Val MAE 1.4009 CI 0.6491
[FT] Ep 16: Loss 5.4989 | Val MAE 1.4146 CI 0.6433
[FT] Ep 17: Loss 5.5373 | Val MAE 1.4120 CI 0.6316
[FT] Ep 18: Loss 5.5984 | Val MAE 1.4154 CI 0.6199
[FT] Ep 19: Loss 5.4238 | Val MAE 1.4188 CI 0.6257
[FT] Ep 20: Loss 5.5865 | Val MAE 1.4312 CI 0.6199
[FT] Ep 21: Loss 5.1553 | Val MAE 1.4295 CI 0.6140
[FT] Ep 22: Loss 5.6396 | Val MAE 1.4330 CI 0.6140
[FT] Ep 23: Loss 5.5318 | Val MAE 1.4357 CI 0.6140
[FT] Ep 24: Loss 5.3475 | Val MAE 1.4391 CI 0.6140
[FT] Ep 25: Loss 5.3825 | Val MAE 1.4409 CI 0.6199
[FT] Ep 26: Loss 5.3267 | Val MAE 1.4443 CI 0.6140
[FT] Ep 27: Loss 5.5799 | Val MAE 1.4502 CI 0.6023
[FT] Ep 28: Loss 5.0377 | Val MAE 1.4565 CI 0.5848
[FT] Ep 29: Loss 5.3803 | Val MAE 1.4671 CI 0.5731
[FT] Ep 30: Loss 5.3809 | Val MAE 1.4741 CI 0.5673
[FT] Ep 31: Loss 5.4392 | Val MAE 1.4764 CI 0.5731
[FT] Ep 32: Loss 5.2209 | Val MAE 1.4780 CI 0.5731
[FT] Ep 33: Loss 5.3956 | Val MAE 1.4795 CI 0.5789
[FT] Ep 34: Loss 5.4313 | Val MAE 1.4831 CI 0.5731
[FT] Ep 35: Loss 4.9701 | Val MAE 1.4864 CI 0.5789
[FT] Ep 36: Loss 5.1186 | Val MAE 1.4917 CI 0.5731
[FT] Ep 37: Loss 5.4197 | Val MAE 1.4967 CI 0.5673
[FT] Ep 38: Loss 5.1292 | Val MAE 1.5059 CI 0.5497
[FT] Ep 39: Loss 5.7536 | Val MAE 1.5084 CI 0.5380
[FT] Ep 40: Loss 5.3473 | Val MAE 1.5115 CI 0.5380
[FT] Ep 41: Loss 5.2899 | Val MAE 1.5095 CI 0.5673
[FT] Ep 42: Loss 5.3303 | Val MAE 1.5070 CI 0.5731
[FT] Ep 43: Loss 5.2063 | Val MAE 1.5065 CI 0.5789
[FT] Ep 44: Loss 5.4586 | Val MAE 1.5060 CI 0.5673
[FT] Ep 45: Loss 5.2379 | Val MAE 1.5060 CI 0.5789
[FT] Ep 46: Loss 5.2785 | Val MAE 1.5070 CI 0.5848
[FT] Ep 47: Loss 5.3181 | Val MAE 1.5103 CI 0.5965
[FT] Ep 48: Loss 5.0368 | Val MAE 1.5137 CI 0.5906
[FT] Ep 49: Loss 5.1385 | Val MAE 1.5134 CI 0.5906
[FT] Ep 50: Loss 5.1200 | Val MAE 1.5176 CI 0.5848
[FT] Ep 51: Loss 5.0440 | Val MAE 1.5139 CI 0.5906
[FT] Ep 52: Loss 5.3724 | Val MAE 1.5135 CI 0.5965
[FT] Ep 53: Loss 5.1861 | Val MAE 1.5134 CI 0.6082
[FT] Ep 54: Loss 5.0022 | Val MAE 1.5194 CI 0.5965
[FT] Ep 55: Loss 4.9878 | Val MAE 1.5220 CI 0.5965
[FT] Ep 56: Loss 4.8317 | Val MAE 1.5227 CI 0.5965
[FT] Ep 57: Loss 5.2423 | Val MAE 1.5281 CI 0.5965
[FT] Ep 58: Loss 5.0406 | Val MAE 1.5265 CI 0.6023
[FT] Ep 59: Loss 5.1885 | Val MAE 1.5315 CI 0.5906
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: Least Confidence
   MAE:  1.5654
   RMSE: 1.9348
   CI:   0.4474
   RM2:  0.0220
   MAPE: 25.40 %
   Acc:  30.00 %
------------------------------------------------------------
