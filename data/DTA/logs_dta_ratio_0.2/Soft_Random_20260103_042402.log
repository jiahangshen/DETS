--- DTA Baseline: Soft Random (Ratio: 0.2) ---

>>> [Stage 0] Sampling...

[Sampler] Running Soft Random | Target: 4991/24956 (20.0%)
Scanning Source (Soft Random):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (Soft Random):   4%|▍         | 1/25 [00:02<01:10,  2.95s/it]Scanning Source (Soft Random):   8%|▊         | 2/25 [00:03<00:32,  1.42s/it]Scanning Source (Soft Random):  12%|█▏        | 3/25 [00:03<00:20,  1.09it/s]Scanning Source (Soft Random):  16%|█▌        | 4/25 [00:03<00:14,  1.46it/s]Scanning Source (Soft Random):  20%|██        | 5/25 [00:04<00:15,  1.32it/s]Scanning Source (Soft Random):  24%|██▍       | 6/25 [00:05<00:11,  1.62it/s]Scanning Source (Soft Random):  28%|██▊       | 7/25 [00:05<00:09,  1.89it/s]Scanning Source (Soft Random):  32%|███▏      | 8/25 [00:05<00:07,  2.16it/s]Scanning Source (Soft Random):  36%|███▌      | 9/25 [00:06<00:09,  1.69it/s]Scanning Source (Soft Random):  40%|████      | 10/25 [00:07<00:07,  1.93it/s]Scanning Source (Soft Random):  44%|████▍     | 11/25 [00:07<00:06,  2.15it/s]Scanning Source (Soft Random):  48%|████▊     | 12/25 [00:07<00:05,  2.36it/s]Scanning Source (Soft Random):  52%|█████▏    | 13/25 [00:08<00:07,  1.64it/s]Scanning Source (Soft Random):  56%|█████▌    | 14/25 [00:09<00:05,  1.90it/s]Scanning Source (Soft Random):  60%|██████    | 15/25 [00:09<00:05,  1.93it/s]Scanning Source (Soft Random):  64%|██████▍   | 16/25 [00:09<00:04,  2.17it/s]Scanning Source (Soft Random):  68%|██████▊   | 17/25 [00:10<00:04,  1.93it/s]Scanning Source (Soft Random):  72%|███████▏  | 18/25 [00:11<00:03,  2.02it/s]Scanning Source (Soft Random):  76%|███████▌  | 19/25 [00:11<00:02,  2.06it/s]Scanning Source (Soft Random):  80%|████████  | 20/25 [00:11<00:02,  2.29it/s]Scanning Source (Soft Random):  84%|████████▍ | 21/25 [00:12<00:02,  1.84it/s]Scanning Source (Soft Random):  88%|████████▊ | 22/25 [00:12<00:01,  2.09it/s]Scanning Source (Soft Random):  92%|█████████▏| 23/25 [00:13<00:00,  2.32it/s]Scanning Source (Soft Random):  96%|█████████▌| 24/25 [00:13<00:00,  2.50it/s]Scanning Source (Soft Random): 100%|██████████| 25/25 [00:13<00:00,  3.16it/s]                                                                              -> Source reduced: 24956 -> 4991

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.8565 | Val MAE 1.9540
[P1] Ep 2: Loss 1.3314 | Val MAE 2.0817
[P1] Ep 3: Loss 1.2271 | Val MAE 1.9500
[P1] Ep 4: Loss 1.1558 | Val MAE 1.9542
[P1] Ep 5: Loss 1.1169 | Val MAE 1.9358
[P1] Ep 6: Loss 1.0719 | Val MAE 2.1619
[P1] Ep 7: Loss 1.0995 | Val MAE 1.9772
[P1] Ep 8: Loss 1.0593 | Val MAE 2.0189
[P1] Ep 9: Loss 1.0602 | Val MAE 1.8671
[P1] Ep 10: Loss 1.0310 | Val MAE 1.9453
[P1] Ep 11: Loss 0.9900 | Val MAE 2.0179
[P1] Ep 12: Loss 1.0301 | Val MAE 1.9765
[P1] Ep 13: Loss 1.0093 | Val MAE 2.0388
[P1] Ep 14: Loss 0.9869 | Val MAE 1.8801
[P1] Ep 15: Loss 0.9768 | Val MAE 1.9992
[P1] Ep 16: Loss 0.9788 | Val MAE 1.8768
[P1] Ep 17: Loss 0.9557 | Val MAE 1.8499
[P1] Ep 18: Loss 0.9176 | Val MAE 1.9315
[P1] Ep 19: Loss 0.9228 | Val MAE 1.7649
[P1] Ep 20: Loss 0.9007 | Val MAE 2.0215
[P1] Ep 21: Loss 0.8729 | Val MAE 1.9858
[P1] Ep 22: Loss 0.8755 | Val MAE 1.8722
[P1] Ep 23: Loss 0.8682 | Val MAE 1.9442
[P1] Ep 24: Loss 0.8721 | Val MAE 1.8795
[P1] Ep 25: Loss 0.8451 | Val MAE 2.0065
[P1] Ep 26: Loss 0.8480 | Val MAE 2.0358
[P1] Ep 27: Loss 0.8477 | Val MAE 1.9628
[P1] Ep 28: Loss 0.8494 | Val MAE 1.8862
[P1] Ep 29: Loss 0.8424 | Val MAE 1.9661
[P1] Ep 30: Loss 0.8543 | Val MAE 1.9201
[P1] Ep 31: Loss 0.8323 | Val MAE 1.8308
[P1] Ep 32: Loss 0.8327 | Val MAE 1.9807
[P1] Ep 33: Loss 0.8305 | Val MAE 2.0004
[P1] Ep 34: Loss 0.8227 | Val MAE 1.9488
[P1] Ep 35: Loss 0.8240 | Val MAE 1.9332
[P1] Ep 36: Loss 0.8253 | Val MAE 1.9603
[P1] Ep 37: Loss 0.8201 | Val MAE 2.0476
[P1] Ep 38: Loss 0.8155 | Val MAE 1.8954
[P1] Ep 39: Loss 0.7987 | Val MAE 1.8967
[P1] Ep 40: Loss 0.8140 | Val MAE 1.8232
[P1] Ep 41: Loss 0.8112 | Val MAE 1.9774
[P1] Ep 42: Loss 0.8126 | Val MAE 1.9320
[P1] Ep 43: Loss 0.8132 | Val MAE 1.9272
[P1] Ep 44: Loss 0.8128 | Val MAE 1.9106
[P1] Ep 45: Loss 0.7881 | Val MAE 1.9275
[P1] Ep 46: Loss 0.7864 | Val MAE 1.9682
[P1] Ep 47: Loss 0.7858 | Val MAE 1.8717
[P1] Ep 48: Loss 0.8031 | Val MAE 1.9859
[P1] Ep 49: Loss 0.7927 | Val MAE 1.8595
[P1] Ep 50: Loss 0.7847 | Val MAE 2.0621
[P1] Ep 51: Loss 0.7946 | Val MAE 1.9610
[P1] Ep 52: Loss 0.7949 | Val MAE 2.0045
[P1] Ep 53: Loss 0.7773 | Val MAE 1.9893
[P1] Ep 54: Loss 0.7581 | Val MAE 1.9256
[P1] Ep 55: Loss 0.7614 | Val MAE 1.9592
[P1] Ep 56: Loss 0.7788 | Val MAE 1.9128
[P1] Ep 57: Loss 0.7634 | Val MAE 2.0260
[P1] Ep 58: Loss 0.7591 | Val MAE 2.0291
[P1] Ep 59: Loss 0.7604 | Val MAE 2.0549
[P1] Ep 60: Loss 0.7633 | Val MAE 1.9621
[P1] Ep 61: Loss 0.7790 | Val MAE 2.0114
[P1] Ep 62: Loss 0.7584 | Val MAE 2.0084
[P1] Ep 63: Loss 0.7588 | Val MAE 2.0105
[P1] Ep 64: Loss 0.7859 | Val MAE 1.8975
[P1] Ep 65: Loss 0.7555 | Val MAE 1.9487
[P1] Ep 66: Loss 0.7531 | Val MAE 1.9326
[P1] Ep 67: Loss 0.7599 | Val MAE 1.9963
[P1] Ep 68: Loss 0.7682 | Val MAE 1.9539
[P1] Ep 69: Loss 0.7389 | Val MAE 2.0096
[P1] Ep 70: Loss 0.7482 | Val MAE 1.9543
[P1] Ep 71: Loss 0.7443 | Val MAE 1.9321
[P1] Ep 72: Loss 0.7482 | Val MAE 1.9576
[P1] Ep 73: Loss 0.7554 | Val MAE 2.0517
[P1] Ep 74: Loss 0.7370 | Val MAE 1.9431
[P1] Ep 75: Loss 0.7472 | Val MAE 1.9298
[P1] Ep 76: Loss 0.7586 | Val MAE 2.0084
[P1] Ep 77: Loss 0.7343 | Val MAE 2.0079
[P1] Ep 78: Loss 0.7143 | Val MAE 1.9712
[P1] Ep 79: Loss 0.7348 | Val MAE 2.0232
[P1] Ep 80: Loss 0.7403 | Val MAE 1.9487
[P1] Ep 81: Loss 0.7407 | Val MAE 1.9369
[P1] Ep 82: Loss 0.7414 | Val MAE 2.0500
[P1] Ep 83: Loss 0.7152 | Val MAE 2.0929
[P1] Ep 84: Loss 0.7254 | Val MAE 2.0938
[P1] Ep 85: Loss 0.7290 | Val MAE 2.1054
[P1] Ep 86: Loss 0.7076 | Val MAE 2.0163
[P1] Ep 87: Loss 0.7241 | Val MAE 1.9164
[P1] Ep 88: Loss 0.7123 | Val MAE 2.0992
[P1] Ep 89: Loss 0.7052 | Val MAE 2.1328
[P1] Ep 90: Loss 0.6983 | Val MAE 2.0485
[P1] Ep 91: Loss 0.7137 | Val MAE 1.9401
[P1] Ep 92: Loss 0.6955 | Val MAE 1.9171
[P1] Ep 93: Loss 0.7027 | Val MAE 2.0548
[P1] Ep 94: Loss 0.6850 | Val MAE 2.0602
[P1] Ep 95: Loss 0.6817 | Val MAE 2.0039
[P1] Ep 96: Loss 0.6942 | Val MAE 2.1167
[P1] Ep 97: Loss 0.6911 | Val MAE 2.0519
[P1] Ep 98: Loss 0.6803 | Val MAE 2.0888
[P1] Ep 99: Loss 0.6727 | Val MAE 2.0533
[P1] Ep 100: Loss 0.6842 | Val MAE 2.1193
[P1] Ep 101: Loss 0.6851 | Val MAE 2.0824
[P1] Ep 102: Loss 0.6730 | Val MAE 2.1628
[P1] Ep 103: Loss 0.6737 | Val MAE 2.1689
[P1] Ep 104: Loss 0.6738 | Val MAE 2.1956
[P1] Ep 105: Loss 0.6559 | Val MAE 2.1897
[P1] Ep 106: Loss 0.6661 | Val MAE 2.1007
[P1] Ep 107: Loss 0.6547 | Val MAE 2.1363
[P1] Ep 108: Loss 0.6523 | Val MAE 2.1507
[P1] Ep 109: Loss 0.6629 | Val MAE 2.2172
[P1] Ep 110: Loss 0.6292 | Val MAE 2.0500
[P1] Ep 111: Loss 0.6339 | Val MAE 2.1635
[P1] Ep 112: Loss 0.6442 | Val MAE 2.1374
[P1] Ep 113: Loss 0.6628 | Val MAE 2.1214
[P1] Ep 114: Loss 0.6515 | Val MAE 2.0656
[P1] Ep 115: Loss 0.6269 | Val MAE 2.0433
[P1] Ep 116: Loss 0.6428 | Val MAE 2.0338
[P1] Ep 117: Loss 0.6421 | Val MAE 2.1665
[P1] Ep 118: Loss 0.6257 | Val MAE 2.0524
[P1] Ep 119: Loss 0.6587 | Val MAE 2.0876
[P1] Ep 120: Loss 0.6192 | Val MAE 2.1012
[P1] Ep 121: Loss 0.6054 | Val MAE 2.1351
[P1] Ep 122: Loss 0.6198 | Val MAE 2.0457
[P1] Ep 123: Loss 0.6074 | Val MAE 2.0879
[P1] Ep 124: Loss 0.6170 | Val MAE 2.0021
[P1] Ep 125: Loss 0.6054 | Val MAE 2.0539
[P1] Ep 126: Loss 0.5989 | Val MAE 1.9730
[P1] Ep 127: Loss 0.5985 | Val MAE 2.0772
[P1] Ep 128: Loss 0.5883 | Val MAE 2.0753
[P1] Ep 129: Loss 0.5839 | Val MAE 2.0667
[P1] Ep 130: Loss 0.5763 | Val MAE 2.0247
[P1] Ep 131: Loss 0.5766 | Val MAE 1.8997
[P1] Ep 132: Loss 0.5971 | Val MAE 2.0056
[P1] Ep 133: Loss 0.6120 | Val MAE 2.0257
[P1] Ep 134: Loss 0.5693 | Val MAE 1.9924
[P1] Ep 135: Loss 0.5753 | Val MAE 1.8604
[P1] Ep 136: Loss 0.5731 | Val MAE 2.0608
[P1] Ep 137: Loss 0.5900 | Val MAE 1.9113
[P1] Ep 138: Loss 0.5858 | Val MAE 2.0479
[P1] Ep 139: Loss 0.5653 | Val MAE 1.9558
[P1] Ep 140: Loss 0.5734 | Val MAE 1.9234
[P1] Ep 141: Loss 0.5637 | Val MAE 1.9731
[P1] Ep 142: Loss 0.5519 | Val MAE 1.9238
[P1] Ep 143: Loss 0.5405 | Val MAE 1.9801
[P1] Ep 144: Loss 0.5572 | Val MAE 1.9392
[P1] Ep 145: Loss 0.5595 | Val MAE 1.8434
[P1] Ep 146: Loss 0.5551 | Val MAE 1.9260
[P1] Ep 147: Loss 0.5601 | Val MAE 1.9633
[P1] Ep 148: Loss 0.5698 | Val MAE 1.9367
[P1] Ep 149: Loss 0.5272 | Val MAE 1.9643
[P1] Ep 150: Loss 0.5459 | Val MAE 1.8777
[P1] Ep 151: Loss 0.5453 | Val MAE 1.9210
[P1] Ep 152: Loss 0.5328 | Val MAE 1.9728
[P1] Ep 153: Loss 0.5393 | Val MAE 1.8980
[P1] Ep 154: Loss 0.5327 | Val MAE 1.9251
[P1] Ep 155: Loss 0.5067 | Val MAE 1.8895
[P1] Ep 156: Loss 0.5270 | Val MAE 1.9020
[P1] Ep 157: Loss 0.5120 | Val MAE 1.9389
[P1] Ep 158: Loss 0.5109 | Val MAE 1.9623
[P1] Ep 159: Loss 0.5015 | Val MAE 1.8573
[P1] Ep 160: Loss 0.5168 | Val MAE 1.9791
[P1] Ep 161: Loss 0.4902 | Val MAE 1.8650
[P1] Ep 162: Loss 0.5201 | Val MAE 1.8807
[P1] Ep 163: Loss 0.5059 | Val MAE 1.9252
[P1] Ep 164: Loss 0.5083 | Val MAE 1.8158
[P1] Ep 165: Loss 0.4900 | Val MAE 1.7578
[P1] Ep 166: Loss 0.4893 | Val MAE 1.8848
[P1] Ep 167: Loss 0.4887 | Val MAE 1.7947
[P1] Ep 168: Loss 0.4870 | Val MAE 1.8914
[P1] Ep 169: Loss 0.4811 | Val MAE 1.8251
[P1] Ep 170: Loss 0.4725 | Val MAE 1.8944
[P1] Ep 171: Loss 0.4763 | Val MAE 1.8678
[P1] Ep 172: Loss 0.4875 | Val MAE 1.8151
[P1] Ep 173: Loss 0.4876 | Val MAE 1.8000
[P1] Ep 174: Loss 0.4643 | Val MAE 1.8692
[P1] Ep 175: Loss 0.4912 | Val MAE 1.8794
[P1] Ep 176: Loss 0.4764 | Val MAE 1.7436
[P1] Ep 177: Loss 0.4697 | Val MAE 1.7494
[P1] Ep 178: Loss 0.4558 | Val MAE 1.7731
[P1] Ep 179: Loss 0.4643 | Val MAE 1.8780
[P1] Ep 180: Loss 0.4548 | Val MAE 1.8524
[P1] Ep 181: Loss 0.4526 | Val MAE 1.7696
[P1] Ep 182: Loss 0.4430 | Val MAE 1.7329
[P1] Ep 183: Loss 0.4652 | Val MAE 1.8917
[P1] Ep 184: Loss 0.4573 | Val MAE 1.7990
[P1] Ep 185: Loss 0.4500 | Val MAE 1.8788
[P1] Ep 186: Loss 0.4415 | Val MAE 1.8297
[P1] Ep 187: Loss 0.4483 | Val MAE 1.7820
[P1] Ep 188: Loss 0.4446 | Val MAE 1.8007
[P1] Ep 189: Loss 0.4413 | Val MAE 1.8773
[P1] Ep 190: Loss 0.4307 | Val MAE 1.7404
[P1] Ep 191: Loss 0.4357 | Val MAE 1.9515
[P1] Ep 192: Loss 0.4320 | Val MAE 1.7476
[P1] Ep 193: Loss 0.4290 | Val MAE 1.9252
[P1] Ep 194: Loss 0.4243 | Val MAE 1.8048
[P1] Ep 195: Loss 0.4308 | Val MAE 1.7548
[P1] Ep 196: Loss 0.4321 | Val MAE 1.8465
[P1] Ep 197: Loss 0.4228 | Val MAE 1.8660
[P1] Ep 198: Loss 0.4388 | Val MAE 1.7683
[P1] Ep 199: Loss 0.4152 | Val MAE 1.8086
[P1] Ep 200: Loss 0.4225 | Val MAE 1.8444

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 7.1107 | Val MAE 1.6160 CI 0.6316
[FT] Ep 2: Loss 6.5885 | Val MAE 1.5676 CI 0.6140
[FT] Ep 3: Loss 6.7554 | Val MAE 1.5365 CI 0.5789
[FT] Ep 4: Loss 6.6882 | Val MAE 1.5446 CI 0.5614
[FT] Ep 5: Loss 6.3185 | Val MAE 1.5582 CI 0.5497
[FT] Ep 6: Loss 5.6977 | Val MAE 1.5607 CI 0.5556
[FT] Ep 7: Loss 5.9366 | Val MAE 1.5623 CI 0.5556
[FT] Ep 8: Loss 5.5506 | Val MAE 1.5734 CI 0.5614
[FT] Ep 9: Loss 5.5097 | Val MAE 1.5800 CI 0.5614
[FT] Ep 10: Loss 5.3981 | Val MAE 1.5932 CI 0.5614
[FT] Ep 11: Loss 5.1018 | Val MAE 1.6047 CI 0.5497
[FT] Ep 12: Loss 5.2075 | Val MAE 1.6142 CI 0.5263
[FT] Ep 13: Loss 5.2282 | Val MAE 1.6173 CI 0.5205
[FT] Ep 14: Loss 5.0033 | Val MAE 1.6255 CI 0.5205
[FT] Ep 15: Loss 4.5622 | Val MAE 1.6357 CI 0.5205
[FT] Ep 16: Loss 4.7114 | Val MAE 1.6420 CI 0.5263
[FT] Ep 17: Loss 5.1030 | Val MAE 1.6435 CI 0.5322
[FT] Ep 18: Loss 4.5805 | Val MAE 1.6442 CI 0.5263
[FT] Ep 19: Loss 4.3739 | Val MAE 1.6471 CI 0.5380
[FT] Ep 20: Loss 4.2867 | Val MAE 1.6443 CI 0.5556
[FT] Ep 21: Loss 4.4686 | Val MAE 1.6401 CI 0.5556
[FT] Ep 22: Loss 4.5686 | Val MAE 1.6391 CI 0.5614
[FT] Ep 23: Loss 4.4368 | Val MAE 1.6382 CI 0.5673
[FT] Ep 24: Loss 4.5400 | Val MAE 1.6391 CI 0.5789
[FT] Ep 25: Loss 4.0889 | Val MAE 1.6391 CI 0.5731
[FT] Ep 26: Loss 4.0714 | Val MAE 1.6397 CI 0.5731
[FT] Ep 27: Loss 4.3170 | Val MAE 1.6427 CI 0.5731
[FT] Ep 28: Loss 4.1805 | Val MAE 1.6423 CI 0.5789
[FT] Ep 29: Loss 3.9119 | Val MAE 1.6455 CI 0.5731
[FT] Ep 30: Loss 4.2746 | Val MAE 1.6426 CI 0.5731
[FT] Ep 31: Loss 3.8305 | Val MAE 1.6420 CI 0.5731
[FT] Ep 32: Loss 4.4290 | Val MAE 1.6402 CI 0.5789
[FT] Ep 33: Loss 4.0758 | Val MAE 1.6410 CI 0.5906
[FT] Ep 34: Loss 3.8897 | Val MAE 1.6361 CI 0.5906
[FT] Ep 35: Loss 3.6427 | Val MAE 1.6428 CI 0.5906
[FT] Ep 36: Loss 4.0973 | Val MAE 1.6380 CI 0.5906
[FT] Ep 37: Loss 3.8817 | Val MAE 1.6378 CI 0.5906
[FT] Ep 38: Loss 3.8602 | Val MAE 1.6422 CI 0.5906
[FT] Ep 39: Loss 3.5897 | Val MAE 1.6443 CI 0.5906
[FT] Ep 40: Loss 3.6579 | Val MAE 1.6428 CI 0.5906
[FT] Ep 41: Loss 4.0245 | Val MAE 1.6465 CI 0.5906
[FT] Ep 42: Loss 4.1810 | Val MAE 1.6455 CI 0.5848
[FT] Ep 43: Loss 3.8292 | Val MAE 1.6469 CI 0.5906
[FT] Ep 44: Loss 3.8287 | Val MAE 1.6487 CI 0.5906
[FT] Ep 45: Loss 3.6581 | Val MAE 1.6486 CI 0.5848
[FT] Ep 46: Loss 3.9274 | Val MAE 1.6511 CI 0.5906
[FT] Ep 47: Loss 3.6156 | Val MAE 1.6527 CI 0.5906
[FT] Ep 48: Loss 3.5334 | Val MAE 1.6502 CI 0.5906
[FT] Ep 49: Loss 3.3994 | Val MAE 1.6476 CI 0.5965
[FT] Ep 50: Loss 3.8132 | Val MAE 1.6469 CI 0.6023
[FT] Ep 51: Loss 3.0137 | Val MAE 1.6419 CI 0.6140
[FT] Ep 52: Loss 3.5440 | Val MAE 1.6430 CI 0.6140
[FT] Ep 53: Loss 3.6845 | Val MAE 1.6374 CI 0.6140
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: Soft Random
   MAE:  1.5413
   RMSE: 1.9138
   CI:   0.5000
   RM2:  0.0021
   MAPE: 25.17 %
   Acc:  25.00 %
------------------------------------------------------------
