--- DTA Baseline: Soft Random (Ratio: 0.6) ---

>>> [Stage 0] Sampling...

[Sampler] Running Soft Random | Target: 14973/24956 (60.0%)
Scanning Source (Soft Random):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (Soft Random):   4%|▍         | 1/25 [00:07<02:52,  7.20s/it]Scanning Source (Soft Random):   8%|▊         | 2/25 [00:07<01:14,  3.24s/it]Scanning Source (Soft Random):  12%|█▏        | 3/25 [00:08<00:42,  1.94s/it]Scanning Source (Soft Random):  16%|█▌        | 4/25 [00:08<00:28,  1.33s/it]Scanning Source (Soft Random):  20%|██        | 5/25 [00:11<00:37,  1.86s/it]Scanning Source (Soft Random):  24%|██▍       | 6/25 [00:11<00:25,  1.37s/it]Scanning Source (Soft Random):  28%|██▊       | 7/25 [00:12<00:19,  1.08s/it]Scanning Source (Soft Random):  32%|███▏      | 8/25 [00:12<00:14,  1.16it/s]Scanning Source (Soft Random):  36%|███▌      | 9/25 [00:15<00:25,  1.56s/it]Scanning Source (Soft Random):  40%|████      | 10/25 [00:16<00:21,  1.42s/it]Scanning Source (Soft Random):  44%|████▍     | 11/25 [00:17<00:16,  1.17s/it]Scanning Source (Soft Random):  48%|████▊     | 12/25 [00:17<00:12,  1.07it/s]Scanning Source (Soft Random):  52%|█████▏    | 13/25 [00:21<00:19,  1.65s/it]Scanning Source (Soft Random):  56%|█████▌    | 14/25 [00:23<00:20,  1.85s/it]Scanning Source (Soft Random):  60%|██████    | 15/25 [00:23<00:14,  1.41s/it]Scanning Source (Soft Random):  64%|██████▍   | 16/25 [00:24<00:09,  1.11s/it]Scanning Source (Soft Random):  68%|██████▊   | 17/25 [00:25<00:09,  1.17s/it]Scanning Source (Soft Random):  72%|███████▏  | 18/25 [00:28<00:12,  1.78s/it]Scanning Source (Soft Random):  76%|███████▌  | 19/25 [00:29<00:08,  1.36s/it]Scanning Source (Soft Random):  80%|████████  | 20/25 [00:29<00:05,  1.07s/it]Scanning Source (Soft Random):  84%|████████▍ | 21/25 [00:30<00:03,  1.04it/s]Scanning Source (Soft Random):  88%|████████▊ | 22/25 [00:31<00:03,  1.10s/it]Scanning Source (Soft Random):  92%|█████████▏| 23/25 [00:31<00:01,  1.15it/s]Scanning Source (Soft Random):  96%|█████████▌| 24/25 [00:32<00:00,  1.42it/s]Scanning Source (Soft Random): 100%|██████████| 25/25 [00:32<00:00,  1.88it/s]                                                                              -> Source reduced: 24956 -> 14973

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 1.7539 | Val MAE 1.9291
[P1] Ep 2: Loss 1.0353 | Val MAE 1.9033
[P1] Ep 3: Loss 0.9432 | Val MAE 1.8903
[P1] Ep 4: Loss 0.9233 | Val MAE 2.1164
[P1] Ep 5: Loss 0.8938 | Val MAE 2.0460
[P1] Ep 6: Loss 0.8814 | Val MAE 1.9200
[P1] Ep 7: Loss 0.8736 | Val MAE 2.1133
[P1] Ep 8: Loss 0.8437 | Val MAE 1.7270
[P1] Ep 9: Loss 0.8225 | Val MAE 2.0628
[P1] Ep 10: Loss 0.7962 | Val MAE 2.1746
[P1] Ep 11: Loss 0.7838 | Val MAE 2.0302
[P1] Ep 12: Loss 0.7730 | Val MAE 2.0579
[P1] Ep 13: Loss 0.7856 | Val MAE 1.9726
[P1] Ep 14: Loss 0.7711 | Val MAE 2.0562
[P1] Ep 15: Loss 0.7588 | Val MAE 1.9423
[P1] Ep 16: Loss 0.7481 | Val MAE 1.9987
[P1] Ep 17: Loss 0.7495 | Val MAE 1.9948
[P1] Ep 18: Loss 0.7343 | Val MAE 1.9903
[P1] Ep 19: Loss 0.7385 | Val MAE 2.1301
[P1] Ep 20: Loss 0.7310 | Val MAE 1.9054
[P1] Ep 21: Loss 0.7284 | Val MAE 2.0638
[P1] Ep 22: Loss 0.7100 | Val MAE 1.9411
[P1] Ep 23: Loss 0.7228 | Val MAE 2.0994
[P1] Ep 24: Loss 0.7172 | Val MAE 2.0583
[P1] Ep 25: Loss 0.7051 | Val MAE 2.0166
[P1] Ep 26: Loss 0.6954 | Val MAE 2.0102
[P1] Ep 27: Loss 0.6988 | Val MAE 1.9857
[P1] Ep 28: Loss 0.6857 | Val MAE 2.1093
[P1] Ep 29: Loss 0.6872 | Val MAE 1.9627
[P1] Ep 30: Loss 0.6924 | Val MAE 2.1506
[P1] Ep 31: Loss 0.6729 | Val MAE 1.9819
[P1] Ep 32: Loss 0.6713 | Val MAE 2.0939
[P1] Ep 33: Loss 0.6653 | Val MAE 2.0750
[P1] Ep 34: Loss 0.6677 | Val MAE 2.0866
[P1] Ep 35: Loss 0.6672 | Val MAE 2.0755
[P1] Ep 36: Loss 0.6572 | Val MAE 1.9825
[P1] Ep 37: Loss 0.6583 | Val MAE 2.0663
[P1] Ep 38: Loss 0.6445 | Val MAE 2.0418
[P1] Ep 39: Loss 0.6514 | Val MAE 2.0761
[P1] Ep 40: Loss 0.6396 | Val MAE 2.0339
[P1] Ep 41: Loss 0.6379 | Val MAE 1.9304
[P1] Ep 42: Loss 0.6301 | Val MAE 1.9675
[P1] Ep 43: Loss 0.6270 | Val MAE 1.9911
[P1] Ep 44: Loss 0.6261 | Val MAE 2.0356
[P1] Ep 45: Loss 0.6144 | Val MAE 2.0654
[P1] Ep 46: Loss 0.6162 | Val MAE 2.0310
[P1] Ep 47: Loss 0.6022 | Val MAE 1.8734
[P1] Ep 48: Loss 0.5989 | Val MAE 2.0502
[P1] Ep 49: Loss 0.5967 | Val MAE 2.0186
[P1] Ep 50: Loss 0.5864 | Val MAE 1.8785
[P1] Ep 51: Loss 0.5778 | Val MAE 2.0382
[P1] Ep 52: Loss 0.5819 | Val MAE 2.0083
[P1] Ep 53: Loss 0.5822 | Val MAE 1.9290
[P1] Ep 54: Loss 0.5788 | Val MAE 2.0330
[P1] Ep 55: Loss 0.5692 | Val MAE 2.0100
[P1] Ep 56: Loss 0.5651 | Val MAE 2.1037
[P1] Ep 57: Loss 0.5624 | Val MAE 2.0185
[P1] Ep 58: Loss 0.5540 | Val MAE 2.0264
[P1] Ep 59: Loss 0.5530 | Val MAE 1.9291
[P1] Ep 60: Loss 0.5476 | Val MAE 1.9982
[P1] Ep 61: Loss 0.5484 | Val MAE 2.0758
[P1] Ep 62: Loss 0.5460 | Val MAE 2.0453
[P1] Ep 63: Loss 0.5292 | Val MAE 2.0310
[P1] Ep 64: Loss 0.5292 | Val MAE 1.9740
[P1] Ep 65: Loss 0.5331 | Val MAE 2.1465
[P1] Ep 66: Loss 0.5240 | Val MAE 2.0153
[P1] Ep 67: Loss 0.5165 | Val MAE 2.1226
[P1] Ep 68: Loss 0.5191 | Val MAE 1.9732
[P1] Ep 69: Loss 0.5152 | Val MAE 2.1579
[P1] Ep 70: Loss 0.5099 | Val MAE 2.1277
[P1] Ep 71: Loss 0.5064 | Val MAE 1.9728
[P1] Ep 72: Loss 0.5045 | Val MAE 1.9889
[P1] Ep 73: Loss 0.5011 | Val MAE 2.0735
[P1] Ep 74: Loss 0.4995 | Val MAE 1.9375
[P1] Ep 75: Loss 0.4974 | Val MAE 2.0425
[P1] Ep 76: Loss 0.4847 | Val MAE 1.9144
[P1] Ep 77: Loss 0.4860 | Val MAE 1.9412
[P1] Ep 78: Loss 0.4832 | Val MAE 1.9383
[P1] Ep 79: Loss 0.4754 | Val MAE 1.9717
[P1] Ep 80: Loss 0.4806 | Val MAE 1.9859
[P1] Ep 81: Loss 0.4735 | Val MAE 1.8599
[P1] Ep 82: Loss 0.4806 | Val MAE 1.9021
[P1] Ep 83: Loss 0.4647 | Val MAE 1.9113
[P1] Ep 84: Loss 0.4614 | Val MAE 1.8117
[P1] Ep 85: Loss 0.4544 | Val MAE 1.9577
[P1] Ep 86: Loss 0.4654 | Val MAE 1.8696
[P1] Ep 87: Loss 0.4503 | Val MAE 2.0171
[P1] Ep 88: Loss 0.4556 | Val MAE 1.9530
[P1] Ep 89: Loss 0.4476 | Val MAE 1.9202
[P1] Ep 90: Loss 0.4365 | Val MAE 1.9752
[P1] Ep 91: Loss 0.4316 | Val MAE 2.0787
[P1] Ep 92: Loss 0.4272 | Val MAE 2.0536
[P1] Ep 93: Loss 0.4292 | Val MAE 1.9543
[P1] Ep 94: Loss 0.4257 | Val MAE 2.0464
[P1] Ep 95: Loss 0.4211 | Val MAE 1.9040
[P1] Ep 96: Loss 0.4232 | Val MAE 2.1143
[P1] Ep 97: Loss 0.4063 | Val MAE 2.0405
[P1] Ep 98: Loss 0.4139 | Val MAE 1.9734
[P1] Ep 99: Loss 0.4050 | Val MAE 1.9320
[P1] Ep 100: Loss 0.4013 | Val MAE 2.0132
[P1] Ep 101: Loss 0.4018 | Val MAE 1.9526
[P1] Ep 102: Loss 0.3925 | Val MAE 2.0578
[P1] Ep 103: Loss 0.3989 | Val MAE 2.0316
[P1] Ep 104: Loss 0.3817 | Val MAE 1.9926
[P1] Ep 105: Loss 0.3850 | Val MAE 1.9127
[P1] Ep 106: Loss 0.3799 | Val MAE 1.8806
[P1] Ep 107: Loss 0.3810 | Val MAE 2.0364
[P1] Ep 108: Loss 0.3694 | Val MAE 1.9303
[P1] Ep 109: Loss 0.3772 | Val MAE 1.8633
[P1] Ep 110: Loss 0.3661 | Val MAE 1.7975
[P1] Ep 111: Loss 0.3642 | Val MAE 1.9027
[P1] Ep 112: Loss 0.3688 | Val MAE 1.9315
[P1] Ep 113: Loss 0.3577 | Val MAE 1.8896
[P1] Ep 114: Loss 0.3576 | Val MAE 1.8917
[P1] Ep 115: Loss 0.3538 | Val MAE 1.8445
[P1] Ep 116: Loss 0.3516 | Val MAE 1.7845
[P1] Ep 117: Loss 0.3470 | Val MAE 1.7618
[P1] Ep 118: Loss 0.3429 | Val MAE 1.7866
[P1] Ep 119: Loss 0.3531 | Val MAE 1.8768
[P1] Ep 120: Loss 0.3389 | Val MAE 1.9013
[P1] Ep 121: Loss 0.3410 | Val MAE 1.8352
[P1] Ep 122: Loss 0.3342 | Val MAE 1.8231
[P1] Ep 123: Loss 0.3301 | Val MAE 1.8808
[P1] Ep 124: Loss 0.3384 | Val MAE 1.8125
[P1] Ep 125: Loss 0.3333 | Val MAE 1.9204
[P1] Ep 126: Loss 0.3254 | Val MAE 1.7637
[P1] Ep 127: Loss 0.3219 | Val MAE 1.9193
[P1] Ep 128: Loss 0.3201 | Val MAE 1.8240
[P1] Ep 129: Loss 0.3225 | Val MAE 1.9307
[P1] Ep 130: Loss 0.3185 | Val MAE 1.8631
[P1] Ep 131: Loss 0.3157 | Val MAE 1.8983
[P1] Ep 132: Loss 0.3082 | Val MAE 1.8952
[P1] Ep 133: Loss 0.3101 | Val MAE 1.8700
[P1] Ep 134: Loss 0.3043 | Val MAE 1.8870
[P1] Ep 135: Loss 0.3016 | Val MAE 1.9036
[P1] Ep 136: Loss 0.3068 | Val MAE 1.9205
[P1] Ep 137: Loss 0.3016 | Val MAE 1.8454
[P1] Ep 138: Loss 0.3029 | Val MAE 1.8893
[P1] Ep 139: Loss 0.2993 | Val MAE 1.8053
[P1] Ep 140: Loss 0.2900 | Val MAE 1.9290
[P1] Ep 141: Loss 0.2943 | Val MAE 1.6953
[P1] Ep 142: Loss 0.2920 | Val MAE 1.8350
[P1] Ep 143: Loss 0.2895 | Val MAE 2.0306
[P1] Ep 144: Loss 0.2864 | Val MAE 1.7628
[P1] Ep 145: Loss 0.2829 | Val MAE 1.7328
[P1] Ep 146: Loss 0.2820 | Val MAE 1.8336
[P1] Ep 147: Loss 0.2791 | Val MAE 1.8515
[P1] Ep 148: Loss 0.2846 | Val MAE 1.8254
[P1] Ep 149: Loss 0.2734 | Val MAE 1.8484
[P1] Ep 150: Loss 0.2720 | Val MAE 1.9344
[P1] Ep 151: Loss 0.2673 | Val MAE 1.9098
[P1] Ep 152: Loss 0.2665 | Val MAE 1.7095
[P1] Ep 153: Loss 0.2699 | Val MAE 1.7591
[P1] Ep 154: Loss 0.2659 | Val MAE 1.8000
[P1] Ep 155: Loss 0.2641 | Val MAE 1.7746
[P1] Ep 156: Loss 0.2582 | Val MAE 1.7690
[P1] Ep 157: Loss 0.2627 | Val MAE 1.6338
[P1] Ep 158: Loss 0.2511 | Val MAE 1.8710
[P1] Ep 159: Loss 0.2569 | Val MAE 1.8760
[P1] Ep 160: Loss 0.2515 | Val MAE 1.9569
[P1] Ep 161: Loss 0.2509 | Val MAE 1.8287
[P1] Ep 162: Loss 0.2489 | Val MAE 1.9373
[P1] Ep 163: Loss 0.2446 | Val MAE 1.8947
[P1] Ep 164: Loss 0.2546 | Val MAE 1.8174
[P1] Ep 165: Loss 0.2388 | Val MAE 1.9320
[P1] Ep 166: Loss 0.2389 | Val MAE 1.8709
[P1] Ep 167: Loss 0.2488 | Val MAE 1.8999
[P1] Ep 168: Loss 0.2404 | Val MAE 1.9096
[P1] Ep 169: Loss 0.2322 | Val MAE 1.8608
[P1] Ep 170: Loss 0.2339 | Val MAE 1.9594
[P1] Ep 171: Loss 0.2337 | Val MAE 1.7779
[P1] Ep 172: Loss 0.2306 | Val MAE 1.8756
[P1] Ep 173: Loss 0.2297 | Val MAE 1.8571
[P1] Ep 174: Loss 0.2235 | Val MAE 1.7693
[P1] Ep 175: Loss 0.2249 | Val MAE 1.9336
[P1] Ep 176: Loss 0.2276 | Val MAE 1.8766
[P1] Ep 177: Loss 0.2273 | Val MAE 1.7898
[P1] Ep 178: Loss 0.2212 | Val MAE 1.8354
[P1] Ep 179: Loss 0.2156 | Val MAE 1.8259
[P1] Ep 180: Loss 0.2181 | Val MAE 1.8629
[P1] Ep 181: Loss 0.2180 | Val MAE 1.8143
[P1] Ep 182: Loss 0.2092 | Val MAE 1.9139
[P1] Ep 183: Loss 0.2130 | Val MAE 1.8486
[P1] Ep 184: Loss 0.2154 | Val MAE 1.8851
[P1] Ep 185: Loss 0.2078 | Val MAE 1.8440
[P1] Ep 186: Loss 0.2127 | Val MAE 1.8650
[P1] Ep 187: Loss 0.2123 | Val MAE 1.8997
[P1] Ep 188: Loss 0.2070 | Val MAE 1.8754
[P1] Ep 189: Loss 0.2091 | Val MAE 1.7913
[P1] Ep 190: Loss 0.2049 | Val MAE 1.8016
[P1] Ep 191: Loss 0.2064 | Val MAE 1.7028
[P1] Ep 192: Loss 0.2026 | Val MAE 1.8590
[P1] Ep 193: Loss 0.1997 | Val MAE 1.8118
[P1] Ep 194: Loss 0.2024 | Val MAE 1.7496
[P1] Ep 195: Loss 0.1982 | Val MAE 1.7903
[P1] Ep 196: Loss 0.1961 | Val MAE 1.7557
[P1] Ep 197: Loss 0.1931 | Val MAE 1.7467
[P1] Ep 198: Loss 0.1980 | Val MAE 1.8535
[P1] Ep 199: Loss 0.1998 | Val MAE 1.8351
[P1] Ep 200: Loss 0.1975 | Val MAE 1.7715

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 7.8559 | Val MAE 1.5063 CI 0.5556
[FT] Ep 2: Loss 7.4304 | Val MAE 1.4279 CI 0.5614
[FT] Ep 3: Loss 7.2693 | Val MAE 1.3954 CI 0.5673
[FT] Ep 4: Loss 6.7923 | Val MAE 1.3848 CI 0.5848
[FT] Ep 5: Loss 6.2835 | Val MAE 1.3781 CI 0.6082
[FT] Ep 6: Loss 6.3044 | Val MAE 1.3887 CI 0.6316
[FT] Ep 7: Loss 6.0061 | Val MAE 1.3993 CI 0.6550
[FT] Ep 8: Loss 5.7582 | Val MAE 1.4048 CI 0.6491
[FT] Ep 9: Loss 5.3912 | Val MAE 1.4125 CI 0.6491
[FT] Ep 10: Loss 5.8807 | Val MAE 1.4173 CI 0.6550
[FT] Ep 11: Loss 5.2754 | Val MAE 1.4212 CI 0.6667
[FT] Ep 12: Loss 5.1336 | Val MAE 1.4272 CI 0.6784
[FT] Ep 13: Loss 4.9031 | Val MAE 1.4315 CI 0.6667
[FT] Ep 14: Loss 4.8871 | Val MAE 1.4401 CI 0.6667
[FT] Ep 15: Loss 5.0299 | Val MAE 1.4472 CI 0.6784
[FT] Ep 16: Loss 4.6541 | Val MAE 1.4462 CI 0.6667
[FT] Ep 17: Loss 4.4696 | Val MAE 1.4511 CI 0.6784
[FT] Ep 18: Loss 4.6833 | Val MAE 1.4517 CI 0.6725
[FT] Ep 19: Loss 4.6098 | Val MAE 1.4513 CI 0.6608
[FT] Ep 20: Loss 4.6856 | Val MAE 1.4469 CI 0.6550
[FT] Ep 21: Loss 4.2287 | Val MAE 1.4456 CI 0.6608
[FT] Ep 22: Loss 4.0059 | Val MAE 1.4444 CI 0.6608
[FT] Ep 23: Loss 4.2812 | Val MAE 1.4429 CI 0.6433
[FT] Ep 24: Loss 4.2621 | Val MAE 1.4471 CI 0.6433
[FT] Ep 25: Loss 3.8984 | Val MAE 1.4481 CI 0.6433
[FT] Ep 26: Loss 4.2026 | Val MAE 1.4492 CI 0.6433
[FT] Ep 27: Loss 3.8533 | Val MAE 1.4562 CI 0.6433
[FT] Ep 28: Loss 3.6915 | Val MAE 1.4607 CI 0.6433
[FT] Ep 29: Loss 3.7670 | Val MAE 1.4788 CI 0.6433
[FT] Ep 30: Loss 3.7207 | Val MAE 1.4832 CI 0.6608
[FT] Ep 31: Loss 3.6583 | Val MAE 1.4846 CI 0.6550
[FT] Ep 32: Loss 3.6352 | Val MAE 1.4944 CI 0.6491
[FT] Ep 33: Loss 3.5310 | Val MAE 1.5139 CI 0.6316
[FT] Ep 34: Loss 3.7468 | Val MAE 1.5171 CI 0.6374
[FT] Ep 35: Loss 3.8133 | Val MAE 1.5347 CI 0.6374
[FT] Ep 36: Loss 3.4221 | Val MAE 1.5462 CI 0.6374
[FT] Ep 37: Loss 3.1858 | Val MAE 1.5496 CI 0.6374
[FT] Ep 38: Loss 3.3586 | Val MAE 1.5397 CI 0.6374
[FT] Ep 39: Loss 3.4160 | Val MAE 1.5429 CI 0.6374
[FT] Ep 40: Loss 3.2358 | Val MAE 1.5393 CI 0.6374
[FT] Ep 41: Loss 3.2048 | Val MAE 1.5353 CI 0.6316
[FT] Ep 42: Loss 3.1664 | Val MAE 1.5335 CI 0.6374
[FT] Ep 43: Loss 3.0603 | Val MAE 1.5328 CI 0.6433
[FT] Ep 44: Loss 3.1709 | Val MAE 1.5477 CI 0.6374
[FT] Ep 45: Loss 2.8896 | Val MAE 1.5609 CI 0.6374
[FT] Ep 46: Loss 3.1277 | Val MAE 1.5648 CI 0.6316
[FT] Ep 47: Loss 2.7783 | Val MAE 1.5719 CI 0.6257
[FT] Ep 48: Loss 3.1858 | Val MAE 1.5680 CI 0.6199
[FT] Ep 49: Loss 2.9051 | Val MAE 1.5668 CI 0.6199
[FT] Ep 50: Loss 2.8518 | Val MAE 1.5628 CI 0.6199
[FT] Ep 51: Loss 2.6765 | Val MAE 1.5758 CI 0.6199
[FT] Ep 52: Loss 2.7338 | Val MAE 1.6032 CI 0.6199
[FT] Ep 53: Loss 2.5180 | Val MAE 1.5992 CI 0.6316
[FT] Ep 54: Loss 2.8194 | Val MAE 1.5900 CI 0.6316
[FT] Ep 55: Loss 2.5834 | Val MAE 1.5802 CI 0.6374
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: Soft Random
   MAE:  1.4501
   RMSE: 1.7907
   CI:   0.5474
   RM2:  0.0065
   MAPE: 24.87 %
   Acc:  30.00 %
------------------------------------------------------------
