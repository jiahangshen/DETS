/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
--- DTA Baseline: Hard Random (Ratio: 0.6) ---

>>> [Stage 0] Sampling...

[Sampler] Running Hard Random | Target: 14973/24956 (60.0%)
-> Source reduced: 24956 -> 14973

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 1.6771 | Val MAE 1.9924
[P1] Ep 2: Loss 0.9050 | Val MAE 2.1326
[P1] Ep 3: Loss 0.8479 | Val MAE 2.0227
[P1] Ep 4: Loss 0.8165 | Val MAE 2.0353
[P1] Ep 5: Loss 0.8003 | Val MAE 2.1484
[P1] Ep 6: Loss 0.7854 | Val MAE 2.1047
[P1] Ep 7: Loss 0.7653 | Val MAE 1.9228
[P1] Ep 8: Loss 0.7482 | Val MAE 2.0282
[P1] Ep 9: Loss 0.7290 | Val MAE 2.0531
[P1] Ep 10: Loss 0.7081 | Val MAE 1.9219
[P1] Ep 11: Loss 0.6915 | Val MAE 2.0633
[P1] Ep 12: Loss 0.6991 | Val MAE 1.9265
[P1] Ep 13: Loss 0.6970 | Val MAE 2.1265
[P1] Ep 14: Loss 0.6787 | Val MAE 2.1318
[P1] Ep 15: Loss 0.6754 | Val MAE 1.9874
[P1] Ep 16: Loss 0.6722 | Val MAE 2.0568
[P1] Ep 17: Loss 0.6694 | Val MAE 2.1242
[P1] Ep 18: Loss 0.6560 | Val MAE 2.0086
[P1] Ep 19: Loss 0.6588 | Val MAE 2.0247
[P1] Ep 20: Loss 0.6615 | Val MAE 2.0626
[P1] Ep 21: Loss 0.6403 | Val MAE 2.1447
[P1] Ep 22: Loss 0.6401 | Val MAE 2.0843
[P1] Ep 23: Loss 0.6346 | Val MAE 2.0705
[P1] Ep 24: Loss 0.6330 | Val MAE 2.0287
[P1] Ep 25: Loss 0.6373 | Val MAE 2.1187
[P1] Ep 26: Loss 0.6228 | Val MAE 1.9946
[P1] Ep 27: Loss 0.6110 | Val MAE 2.0919
[P1] Ep 28: Loss 0.6162 | Val MAE 2.0518
[P1] Ep 29: Loss 0.6148 | Val MAE 2.0959
[P1] Ep 30: Loss 0.6055 | Val MAE 2.0869
[P1] Ep 31: Loss 0.6032 | Val MAE 2.1506
[P1] Ep 32: Loss 0.5996 | Val MAE 2.0460
[P1] Ep 33: Loss 0.5927 | Val MAE 2.0599
[P1] Ep 34: Loss 0.5837 | Val MAE 1.9964
[P1] Ep 35: Loss 0.5819 | Val MAE 2.1061
[P1] Ep 36: Loss 0.5819 | Val MAE 2.1253
[P1] Ep 37: Loss 0.5690 | Val MAE 1.9630
[P1] Ep 38: Loss 0.5724 | Val MAE 2.1128
[P1] Ep 39: Loss 0.5608 | Val MAE 2.0140
[P1] Ep 40: Loss 0.5512 | Val MAE 2.0427
[P1] Ep 41: Loss 0.5591 | Val MAE 2.1540
[P1] Ep 42: Loss 0.5629 | Val MAE 1.9637
[P1] Ep 43: Loss 0.5421 | Val MAE 2.0382
[P1] Ep 44: Loss 0.5377 | Val MAE 1.9772
[P1] Ep 45: Loss 0.5408 | Val MAE 2.0299
[P1] Ep 46: Loss 0.5300 | Val MAE 2.0910
[P1] Ep 47: Loss 0.5254 | Val MAE 2.0567
[P1] Ep 48: Loss 0.5206 | Val MAE 2.0273
[P1] Ep 49: Loss 0.5259 | Val MAE 2.1839
[P1] Ep 50: Loss 0.5243 | Val MAE 1.9993
[P1] Ep 51: Loss 0.5075 | Val MAE 2.0194
[P1] Ep 52: Loss 0.5080 | Val MAE 2.0210
[P1] Ep 53: Loss 0.5032 | Val MAE 1.9683
[P1] Ep 54: Loss 0.4931 | Val MAE 1.9372
[P1] Ep 55: Loss 0.5066 | Val MAE 1.9798
[P1] Ep 56: Loss 0.4971 | Val MAE 2.0643
[P1] Ep 57: Loss 0.4859 | Val MAE 2.0163
[P1] Ep 58: Loss 0.4815 | Val MAE 2.0447
[P1] Ep 59: Loss 0.4851 | Val MAE 1.9155
[P1] Ep 60: Loss 0.4719 | Val MAE 1.9815
[P1] Ep 61: Loss 0.4705 | Val MAE 1.9788
[P1] Ep 62: Loss 0.4680 | Val MAE 2.0731
[P1] Ep 63: Loss 0.4637 | Val MAE 1.9327
[P1] Ep 64: Loss 0.4620 | Val MAE 2.0621
[P1] Ep 65: Loss 0.4702 | Val MAE 1.9749
[P1] Ep 66: Loss 0.4618 | Val MAE 1.9439
[P1] Ep 67: Loss 0.4621 | Val MAE 2.0508
[P1] Ep 68: Loss 0.4465 | Val MAE 1.9859
[P1] Ep 69: Loss 0.4508 | Val MAE 2.0293
[P1] Ep 70: Loss 0.4568 | Val MAE 2.1829
[P1] Ep 71: Loss 0.4430 | Val MAE 2.1080
[P1] Ep 72: Loss 0.4437 | Val MAE 2.0422
[P1] Ep 73: Loss 0.4470 | Val MAE 2.0705
[P1] Ep 74: Loss 0.4351 | Val MAE 2.0416
[P1] Ep 75: Loss 0.4338 | Val MAE 1.9859
[P1] Ep 76: Loss 0.4308 | Val MAE 2.0228
[P1] Ep 77: Loss 0.4192 | Val MAE 2.1067
[P1] Ep 78: Loss 0.4262 | Val MAE 2.1814
[P1] Ep 79: Loss 0.4238 | Val MAE 1.9077
[P1] Ep 80: Loss 0.4184 | Val MAE 1.9587
[P1] Ep 81: Loss 0.4118 | Val MAE 2.0445
[P1] Ep 82: Loss 0.4212 | Val MAE 2.1440
[P1] Ep 83: Loss 0.4093 | Val MAE 2.1138
[P1] Ep 84: Loss 0.4045 | Val MAE 2.1606
[P1] Ep 85: Loss 0.4160 | Val MAE 2.0183
[P1] Ep 86: Loss 0.4031 | Val MAE 2.0359
[P1] Ep 87: Loss 0.3969 | Val MAE 2.0287
[P1] Ep 88: Loss 0.3939 | Val MAE 1.9799
[P1] Ep 89: Loss 0.3950 | Val MAE 2.0453
[P1] Ep 90: Loss 0.3990 | Val MAE 1.9332
[P1] Ep 91: Loss 0.3896 | Val MAE 2.0279
[P1] Ep 92: Loss 0.3866 | Val MAE 2.0231
[P1] Ep 93: Loss 0.3829 | Val MAE 2.0248
[P1] Ep 94: Loss 0.3800 | Val MAE 2.1044
[P1] Ep 95: Loss 0.3720 | Val MAE 2.0322
[P1] Ep 96: Loss 0.3824 | Val MAE 2.0237
[P1] Ep 97: Loss 0.3733 | Val MAE 1.9746
[P1] Ep 98: Loss 0.3729 | Val MAE 1.9985
[P1] Ep 99: Loss 0.3754 | Val MAE 1.9161
[P1] Ep 100: Loss 0.3627 | Val MAE 1.9069
[P1] Ep 101: Loss 0.3693 | Val MAE 2.0639
[P1] Ep 102: Loss 0.3537 | Val MAE 1.9134
[P1] Ep 103: Loss 0.3617 | Val MAE 1.7883
[P1] Ep 104: Loss 0.3615 | Val MAE 2.0406
[P1] Ep 105: Loss 0.3534 | Val MAE 1.9901
[P1] Ep 106: Loss 0.3494 | Val MAE 1.9439
[P1] Ep 107: Loss 0.3505 | Val MAE 2.0258
[P1] Ep 108: Loss 0.3557 | Val MAE 1.9673
[P1] Ep 109: Loss 0.3370 | Val MAE 1.8463
[P1] Ep 110: Loss 0.3378 | Val MAE 1.8990
[P1] Ep 111: Loss 0.3415 | Val MAE 1.9768
[P1] Ep 112: Loss 0.3410 | Val MAE 1.8520
[P1] Ep 113: Loss 0.3290 | Val MAE 1.9928
[P1] Ep 114: Loss 0.3311 | Val MAE 1.8949
[P1] Ep 115: Loss 0.3302 | Val MAE 1.8930
[P1] Ep 116: Loss 0.3252 | Val MAE 1.8925
[P1] Ep 117: Loss 0.3236 | Val MAE 1.9248
[P1] Ep 118: Loss 0.3160 | Val MAE 1.9281
[P1] Ep 119: Loss 0.3218 | Val MAE 2.0218
[P1] Ep 120: Loss 0.3143 | Val MAE 1.9009
[P1] Ep 121: Loss 0.3104 | Val MAE 1.9001
[P1] Ep 122: Loss 0.3082 | Val MAE 1.8394
[P1] Ep 123: Loss 0.3078 | Val MAE 1.9915
[P1] Ep 124: Loss 0.3043 | Val MAE 1.9657
[P1] Ep 125: Loss 0.3047 | Val MAE 1.9428
[P1] Ep 126: Loss 0.2974 | Val MAE 1.8242
[P1] Ep 127: Loss 0.2990 | Val MAE 1.8389
[P1] Ep 128: Loss 0.2907 | Val MAE 1.9493
[P1] Ep 129: Loss 0.2902 | Val MAE 1.9617
[P1] Ep 130: Loss 0.2970 | Val MAE 1.9352
[P1] Ep 131: Loss 0.2886 | Val MAE 1.8456
[P1] Ep 132: Loss 0.2776 | Val MAE 1.9337
[P1] Ep 133: Loss 0.2854 | Val MAE 1.9363
[P1] Ep 134: Loss 0.2810 | Val MAE 1.8457
[P1] Ep 135: Loss 0.2751 | Val MAE 1.8304
[P1] Ep 136: Loss 0.2730 | Val MAE 1.8894
[P1] Ep 137: Loss 0.2709 | Val MAE 1.6860
[P1] Ep 138: Loss 0.2743 | Val MAE 1.8926
[P1] Ep 139: Loss 0.2665 | Val MAE 1.9029
[P1] Ep 140: Loss 0.2653 | Val MAE 1.9014
[P1] Ep 141: Loss 0.2583 | Val MAE 1.8391
[P1] Ep 142: Loss 0.2687 | Val MAE 1.8501
[P1] Ep 143: Loss 0.2549 | Val MAE 1.8911
[P1] Ep 144: Loss 0.2562 | Val MAE 1.7901
[P1] Ep 145: Loss 0.2568 | Val MAE 1.8283
[P1] Ep 146: Loss 0.2497 | Val MAE 1.8670
[P1] Ep 147: Loss 0.2477 | Val MAE 1.9342
[P1] Ep 148: Loss 0.2545 | Val MAE 1.7997
[P1] Ep 149: Loss 0.2506 | Val MAE 1.6968
[P1] Ep 150: Loss 0.2442 | Val MAE 1.9236
[P1] Ep 151: Loss 0.2420 | Val MAE 1.7818
[P1] Ep 152: Loss 0.2405 | Val MAE 1.7504
[P1] Ep 153: Loss 0.2368 | Val MAE 1.7957
[P1] Ep 154: Loss 0.2400 | Val MAE 1.7034
[P1] Ep 155: Loss 0.2384 | Val MAE 1.7873
[P1] Ep 156: Loss 0.2297 | Val MAE 1.7004
[P1] Ep 157: Loss 0.2320 | Val MAE 1.7065
[P1] Ep 158: Loss 0.2341 | Val MAE 1.7794
[P1] Ep 159: Loss 0.2291 | Val MAE 1.8047
[P1] Ep 160: Loss 0.2274 | Val MAE 1.8379
[P1] Ep 161: Loss 0.2224 | Val MAE 1.7872
[P1] Ep 162: Loss 0.2262 | Val MAE 1.7695
[P1] Ep 163: Loss 0.2209 | Val MAE 1.6877
[P1] Ep 164: Loss 0.2215 | Val MAE 1.8453
[P1] Ep 165: Loss 0.2206 | Val MAE 1.7218
[P1] Ep 166: Loss 0.2172 | Val MAE 1.7950
[P1] Ep 167: Loss 0.2098 | Val MAE 1.7962
[P1] Ep 168: Loss 0.2097 | Val MAE 1.7809
[P1] Ep 169: Loss 0.2099 | Val MAE 1.7499
[P1] Ep 170: Loss 0.2106 | Val MAE 1.7728
[P1] Ep 171: Loss 0.2040 | Val MAE 1.7148
[P1] Ep 172: Loss 0.2066 | Val MAE 1.7669
[P1] Ep 173: Loss 0.2079 | Val MAE 1.7979
[P1] Ep 174: Loss 0.2041 | Val MAE 1.7881
[P1] Ep 175: Loss 0.1963 | Val MAE 1.8005
[P1] Ep 176: Loss 0.1995 | Val MAE 1.7436
[P1] Ep 177: Loss 0.1968 | Val MAE 1.7592
[P1] Ep 178: Loss 0.1996 | Val MAE 1.9102
[P1] Ep 179: Loss 0.1995 | Val MAE 1.7208
[P1] Ep 180: Loss 0.1933 | Val MAE 1.7367
[P1] Ep 181: Loss 0.1914 | Val MAE 1.8264
[P1] Ep 182: Loss 0.1932 | Val MAE 1.7185
[P1] Ep 183: Loss 0.1917 | Val MAE 1.7029
[P1] Ep 184: Loss 0.1921 | Val MAE 1.8274
[P1] Ep 185: Loss 0.1885 | Val MAE 1.7584
[P1] Ep 186: Loss 0.1890 | Val MAE 1.6989
[P1] Ep 187: Loss 0.1836 | Val MAE 1.8683
[P1] Ep 188: Loss 0.1820 | Val MAE 1.7913
[P1] Ep 189: Loss 0.1804 | Val MAE 1.8576
[P1] Ep 190: Loss 0.1841 | Val MAE 1.8334
[P1] Ep 191: Loss 0.1804 | Val MAE 1.7833
[P1] Ep 192: Loss 0.1781 | Val MAE 1.7887
[P1] Ep 193: Loss 0.1735 | Val MAE 1.7676
[P1] Ep 194: Loss 0.1805 | Val MAE 1.8306
[P1] Ep 195: Loss 0.1706 | Val MAE 1.8454
[P1] Ep 196: Loss 0.1760 | Val MAE 1.8392
[P1] Ep 197: Loss 0.1741 | Val MAE 1.8749
[P1] Ep 198: Loss 0.1727 | Val MAE 1.8246
[P1] Ep 199: Loss 0.1676 | Val MAE 1.7934
[P1] Ep 200: Loss 0.1682 | Val MAE 1.8670

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 7.1905 | Val MAE 1.6032 CI 0.5673
[FT] Ep 2: Loss 6.9354 | Val MAE 1.5373 CI 0.5848
[FT] Ep 3: Loss 6.5724 | Val MAE 1.4939 CI 0.6199
[FT] Ep 4: Loss 6.1751 | Val MAE 1.4772 CI 0.6316
[FT] Ep 5: Loss 5.9555 | Val MAE 1.4724 CI 0.6023
[FT] Ep 6: Loss 6.0320 | Val MAE 1.4807 CI 0.6023
[FT] Ep 7: Loss 5.7045 | Val MAE 1.4902 CI 0.6023
[FT] Ep 8: Loss 5.6649 | Val MAE 1.4993 CI 0.5965
[FT] Ep 9: Loss 5.0966 | Val MAE 1.5109 CI 0.5906
[FT] Ep 10: Loss 5.2719 | Val MAE 1.5255 CI 0.5789
[FT] Ep 11: Loss 5.0128 | Val MAE 1.5362 CI 0.6023
[FT] Ep 12: Loss 5.3085 | Val MAE 1.5507 CI 0.6023
[FT] Ep 13: Loss 5.3257 | Val MAE 1.5576 CI 0.5789
[FT] Ep 14: Loss 5.2067 | Val MAE 1.5628 CI 0.5614
[FT] Ep 15: Loss 4.9205 | Val MAE 1.5688 CI 0.5614
[FT] Ep 16: Loss 4.8700 | Val MAE 1.5736 CI 0.5614
[FT] Ep 17: Loss 4.8597 | Val MAE 1.5814 CI 0.5497
[FT] Ep 18: Loss 4.5614 | Val MAE 1.5901 CI 0.5556
[FT] Ep 19: Loss 4.4466 | Val MAE 1.5971 CI 0.5556
[FT] Ep 20: Loss 4.5819 | Val MAE 1.5985 CI 0.5556
[FT] Ep 21: Loss 4.3830 | Val MAE 1.6034 CI 0.5673
[FT] Ep 22: Loss 4.2772 | Val MAE 1.6074 CI 0.5614
[FT] Ep 23: Loss 4.3130 | Val MAE 1.6106 CI 0.5556
[FT] Ep 24: Loss 4.4624 | Val MAE 1.6175 CI 0.5673
[FT] Ep 25: Loss 4.2044 | Val MAE 1.6190 CI 0.5731
[FT] Ep 26: Loss 4.1632 | Val MAE 1.6226 CI 0.5673
[FT] Ep 27: Loss 4.1453 | Val MAE 1.6235 CI 0.5614
[FT] Ep 28: Loss 3.9744 | Val MAE 1.6265 CI 0.5556
[FT] Ep 29: Loss 4.0142 | Val MAE 1.6303 CI 0.5556
[FT] Ep 30: Loss 4.0525 | Val MAE 1.6311 CI 0.5556
[FT] Ep 31: Loss 3.6556 | Val MAE 1.6302 CI 0.5673
[FT] Ep 32: Loss 3.8820 | Val MAE 1.6277 CI 0.5673
[FT] Ep 33: Loss 3.6083 | Val MAE 1.6201 CI 0.5614
[FT] Ep 34: Loss 3.9125 | Val MAE 1.6179 CI 0.5673
[FT] Ep 35: Loss 3.7950 | Val MAE 1.6200 CI 0.5673
[FT] Ep 36: Loss 3.6181 | Val MAE 1.6182 CI 0.5614
[FT] Ep 37: Loss 3.4739 | Val MAE 1.6194 CI 0.5614
[FT] Ep 38: Loss 3.6739 | Val MAE 1.6151 CI 0.5614
[FT] Ep 39: Loss 3.6084 | Val MAE 1.6209 CI 0.5556
[FT] Ep 40: Loss 3.6826 | Val MAE 1.6238 CI 0.5556
[FT] Ep 41: Loss 3.6409 | Val MAE 1.6193 CI 0.5497
[FT] Ep 42: Loss 3.3047 | Val MAE 1.6235 CI 0.5439
[FT] Ep 43: Loss 3.4693 | Val MAE 1.6230 CI 0.5439
[FT] Ep 44: Loss 3.1467 | Val MAE 1.6214 CI 0.5439
[FT] Ep 45: Loss 3.3030 | Val MAE 1.6207 CI 0.5439
[FT] Ep 46: Loss 3.0161 | Val MAE 1.6249 CI 0.5439
[FT] Ep 47: Loss 3.2682 | Val MAE 1.6243 CI 0.5439
[FT] Ep 48: Loss 3.1484 | Val MAE 1.6202 CI 0.5497
[FT] Ep 49: Loss 3.2373 | Val MAE 1.6214 CI 0.5497
[FT] Ep 50: Loss 3.2525 | Val MAE 1.6202 CI 0.5497
[FT] Ep 51: Loss 3.2939 | Val MAE 1.6154 CI 0.5439
[FT] Ep 52: Loss 3.0077 | Val MAE 1.6045 CI 0.5439
[FT] Ep 53: Loss 2.9890 | Val MAE 1.5979 CI 0.5439
[FT] Ep 54: Loss 2.8515 | Val MAE 1.5925 CI 0.5439
[FT] Ep 55: Loss 3.0797 | Val MAE 1.5876 CI 0.5556
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: Hard Random
   MAE:  1.3600
   RMSE: 1.8533
   CI:   0.5895
   RM2:  0.0008
   MAPE: 22.97 %
   Acc:  40.00 %
------------------------------------------------------------
