--- DTA Baseline: K-Means (Ratio: 0.6) ---

>>> [Stage 0] Sampling...

[Sampler] Running K-Means | Target: 14973/24956 (60.0%)
Scanning Source (K-Means):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (K-Means):   4%|▍         | 1/25 [00:07<02:48,  7.00s/it]Scanning Source (K-Means):   8%|▊         | 2/25 [00:07<01:12,  3.17s/it]Scanning Source (K-Means):  12%|█▏        | 3/25 [00:07<00:41,  1.90s/it]Scanning Source (K-Means):  16%|█▌        | 4/25 [00:08<00:27,  1.31s/it]Scanning Source (K-Means):  20%|██        | 5/25 [00:11<00:36,  1.85s/it]Scanning Source (K-Means):  24%|██▍       | 6/25 [00:11<00:25,  1.35s/it]Scanning Source (K-Means):  28%|██▊       | 7/25 [00:11<00:18,  1.04s/it]Scanning Source (K-Means):  32%|███▏      | 8/25 [00:12<00:14,  1.19it/s]Scanning Source (K-Means):  36%|███▌      | 9/25 [00:16<00:29,  1.83s/it]Scanning Source (K-Means):  40%|████      | 10/25 [00:16<00:20,  1.39s/it]Scanning Source (K-Means):  44%|████▍     | 11/25 [00:17<00:15,  1.09s/it]Scanning Source (K-Means):  48%|████▊     | 12/25 [00:17<00:11,  1.14it/s]Scanning Source (K-Means):  52%|█████▏    | 13/25 [00:21<00:20,  1.73s/it]Scanning Source (K-Means):  56%|█████▌    | 14/25 [00:21<00:14,  1.33s/it]Scanning Source (K-Means):  60%|██████    | 15/25 [00:21<00:10,  1.05s/it]Scanning Source (K-Means):  64%|██████▍   | 16/25 [00:22<00:07,  1.17it/s]Scanning Source (K-Means):  68%|██████▊   | 17/25 [00:25<00:12,  1.62s/it]Scanning Source (K-Means):  72%|███████▏  | 18/25 [00:26<00:08,  1.25s/it]Scanning Source (K-Means):  76%|███████▌  | 19/25 [00:26<00:05,  1.00it/s]Scanning Source (K-Means):  80%|████████  | 20/25 [00:26<00:04,  1.25it/s]Scanning Source (K-Means):  84%|████████▍ | 21/25 [00:29<00:04,  1.23s/it]Scanning Source (K-Means):  88%|████████▊ | 22/25 [00:29<00:02,  1.05it/s]Scanning Source (K-Means):  92%|█████████▏| 23/25 [00:29<00:01,  1.30it/s]Scanning Source (K-Means):  96%|█████████▌| 24/25 [00:30<00:00,  1.57it/s]Scanning Source (K-Means): 100%|██████████| 25/25 [00:30<00:00,  2.08it/s]                                                                             Running MiniBatchKMeans...
Clusters:   0%|          | 0/5000 [00:00<?, ?it/s]Clusters:  47%|████▋     | 2366/5000 [00:00<00:00, 23644.91it/s]Clusters:  96%|█████████▌| 4793/5000 [00:00<00:00, 24010.58it/s]                                                                -> Source reduced: 24956 -> 11840

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 1.7524 | Val MAE 2.0420
[P1] Ep 2: Loss 0.9434 | Val MAE 1.9007
[P1] Ep 3: Loss 0.8886 | Val MAE 2.1097
[P1] Ep 4: Loss 0.8301 | Val MAE 2.1624
[P1] Ep 5: Loss 0.8093 | Val MAE 2.0662
[P1] Ep 6: Loss 0.7883 | Val MAE 2.1241
[P1] Ep 7: Loss 0.7609 | Val MAE 2.2369
[P1] Ep 8: Loss 0.7575 | Val MAE 2.1352
[P1] Ep 9: Loss 0.7464 | Val MAE 2.0408
[P1] Ep 10: Loss 0.7380 | Val MAE 2.1358
[P1] Ep 11: Loss 0.7245 | Val MAE 1.9726
[P1] Ep 12: Loss 0.7093 | Val MAE 1.8930
[P1] Ep 13: Loss 0.6992 | Val MAE 2.0057
[P1] Ep 14: Loss 0.6885 | Val MAE 1.9878
[P1] Ep 15: Loss 0.6921 | Val MAE 2.1657
[P1] Ep 16: Loss 0.6848 | Val MAE 2.0187
[P1] Ep 17: Loss 0.6923 | Val MAE 2.0566
[P1] Ep 18: Loss 0.6750 | Val MAE 1.9985
[P1] Ep 19: Loss 0.6676 | Val MAE 2.0518
[P1] Ep 20: Loss 0.6655 | Val MAE 1.9225
[P1] Ep 21: Loss 0.6666 | Val MAE 2.0853
[P1] Ep 22: Loss 0.6606 | Val MAE 2.0265
[P1] Ep 23: Loss 0.6510 | Val MAE 2.0772
[P1] Ep 24: Loss 0.6535 | Val MAE 2.0467
[P1] Ep 25: Loss 0.6484 | Val MAE 2.0003
[P1] Ep 26: Loss 0.6478 | Val MAE 2.0792
[P1] Ep 27: Loss 0.6361 | Val MAE 2.0636
[P1] Ep 28: Loss 0.6422 | Val MAE 2.1669
[P1] Ep 29: Loss 0.6361 | Val MAE 2.0897
[P1] Ep 30: Loss 0.6367 | Val MAE 2.0545
[P1] Ep 31: Loss 0.6265 | Val MAE 2.1013
[P1] Ep 32: Loss 0.6276 | Val MAE 2.0984
[P1] Ep 33: Loss 0.6000 | Val MAE 1.9866
[P1] Ep 34: Loss 0.6125 | Val MAE 1.9947
[P1] Ep 35: Loss 0.6243 | Val MAE 2.0394
[P1] Ep 36: Loss 0.5965 | Val MAE 2.0477
[P1] Ep 37: Loss 0.6115 | Val MAE 2.0618
[P1] Ep 38: Loss 0.6007 | Val MAE 2.1719
[P1] Ep 39: Loss 0.5993 | Val MAE 2.0241
[P1] Ep 40: Loss 0.5997 | Val MAE 2.0448
[P1] Ep 41: Loss 0.5845 | Val MAE 2.0104
[P1] Ep 42: Loss 0.5773 | Val MAE 2.0103
[P1] Ep 43: Loss 0.5722 | Val MAE 2.0393
[P1] Ep 44: Loss 0.5822 | Val MAE 1.9429
[P1] Ep 45: Loss 0.5717 | Val MAE 2.0391
[P1] Ep 46: Loss 0.5697 | Val MAE 1.9997
[P1] Ep 47: Loss 0.5682 | Val MAE 1.9498
[P1] Ep 48: Loss 0.5709 | Val MAE 2.0348
[P1] Ep 49: Loss 0.5586 | Val MAE 2.0271
[P1] Ep 50: Loss 0.5507 | Val MAE 1.9821
[P1] Ep 51: Loss 0.5421 | Val MAE 2.0108
[P1] Ep 52: Loss 0.5415 | Val MAE 1.9106
[P1] Ep 53: Loss 0.5427 | Val MAE 1.9447
[P1] Ep 54: Loss 0.5397 | Val MAE 2.0089
[P1] Ep 55: Loss 0.5273 | Val MAE 2.0348
[P1] Ep 56: Loss 0.5266 | Val MAE 2.0141
[P1] Ep 57: Loss 0.5297 | Val MAE 1.9892
[P1] Ep 58: Loss 0.5117 | Val MAE 1.9136
[P1] Ep 59: Loss 0.5151 | Val MAE 1.9910
[P1] Ep 60: Loss 0.5151 | Val MAE 1.8207
[P1] Ep 61: Loss 0.5123 | Val MAE 1.8950
[P1] Ep 62: Loss 0.5088 | Val MAE 1.9894
[P1] Ep 63: Loss 0.5020 | Val MAE 1.8404
[P1] Ep 64: Loss 0.4981 | Val MAE 1.8839
[P1] Ep 65: Loss 0.4931 | Val MAE 1.9915
[P1] Ep 66: Loss 0.4946 | Val MAE 1.9564
[P1] Ep 67: Loss 0.4818 | Val MAE 1.9030
[P1] Ep 68: Loss 0.4858 | Val MAE 1.9089
[P1] Ep 69: Loss 0.4791 | Val MAE 1.8914
[P1] Ep 70: Loss 0.4751 | Val MAE 1.9818
[P1] Ep 71: Loss 0.4772 | Val MAE 1.8904
[P1] Ep 72: Loss 0.4803 | Val MAE 1.8363
[P1] Ep 73: Loss 0.4654 | Val MAE 1.9131
[P1] Ep 74: Loss 0.4763 | Val MAE 1.8028
[P1] Ep 75: Loss 0.4547 | Val MAE 1.7746
[P1] Ep 76: Loss 0.4714 | Val MAE 1.7709
[P1] Ep 77: Loss 0.4530 | Val MAE 1.8405
[P1] Ep 78: Loss 0.4558 | Val MAE 1.9210
[P1] Ep 79: Loss 0.4558 | Val MAE 1.8180
[P1] Ep 80: Loss 0.4551 | Val MAE 1.8415
[P1] Ep 81: Loss 0.4658 | Val MAE 2.0171
[P1] Ep 82: Loss 0.4459 | Val MAE 1.9769
[P1] Ep 83: Loss 0.4378 | Val MAE 1.7480
[P1] Ep 84: Loss 0.4471 | Val MAE 1.9564
[P1] Ep 85: Loss 0.4545 | Val MAE 1.8492
[P1] Ep 86: Loss 0.4339 | Val MAE 1.8624
[P1] Ep 87: Loss 0.4364 | Val MAE 1.8041
[P1] Ep 88: Loss 0.4355 | Val MAE 1.7441
[P1] Ep 89: Loss 0.4357 | Val MAE 1.9514
[P1] Ep 90: Loss 0.4264 | Val MAE 1.9981
[P1] Ep 91: Loss 0.4386 | Val MAE 1.9239
[P1] Ep 92: Loss 0.4223 | Val MAE 1.7885
[P1] Ep 93: Loss 0.4282 | Val MAE 1.8620
[P1] Ep 94: Loss 0.4217 | Val MAE 1.8957
[P1] Ep 95: Loss 0.4189 | Val MAE 1.8976
[P1] Ep 96: Loss 0.4124 | Val MAE 1.8971
[P1] Ep 97: Loss 0.4101 | Val MAE 1.9490
[P1] Ep 98: Loss 0.4135 | Val MAE 1.9563
[P1] Ep 99: Loss 0.4070 | Val MAE 1.9692
[P1] Ep 100: Loss 0.4041 | Val MAE 1.8458
[P1] Ep 101: Loss 0.3985 | Val MAE 1.9625
[P1] Ep 102: Loss 0.4022 | Val MAE 1.8783
[P1] Ep 103: Loss 0.3962 | Val MAE 1.8627
[P1] Ep 104: Loss 0.3891 | Val MAE 1.8943
[P1] Ep 105: Loss 0.3850 | Val MAE 1.9158
[P1] Ep 106: Loss 0.3909 | Val MAE 1.9817
[P1] Ep 107: Loss 0.3797 | Val MAE 1.9674
[P1] Ep 108: Loss 0.3837 | Val MAE 1.9098
[P1] Ep 109: Loss 0.3867 | Val MAE 1.9687
[P1] Ep 110: Loss 0.3773 | Val MAE 1.9032
[P1] Ep 111: Loss 0.3736 | Val MAE 1.9734
[P1] Ep 112: Loss 0.3771 | Val MAE 1.9460
[P1] Ep 113: Loss 0.3678 | Val MAE 1.7577
[P1] Ep 114: Loss 0.3731 | Val MAE 1.9322
[P1] Ep 115: Loss 0.3722 | Val MAE 1.8691
[P1] Ep 116: Loss 0.3662 | Val MAE 1.7276
[P1] Ep 117: Loss 0.3676 | Val MAE 1.8250
[P1] Ep 118: Loss 0.3560 | Val MAE 1.8048
[P1] Ep 119: Loss 0.3582 | Val MAE 1.8423
[P1] Ep 120: Loss 0.3513 | Val MAE 1.8243
[P1] Ep 121: Loss 0.3492 | Val MAE 1.8413
[P1] Ep 122: Loss 0.3546 | Val MAE 1.9152
[P1] Ep 123: Loss 0.3502 | Val MAE 1.8585
[P1] Ep 124: Loss 0.3406 | Val MAE 1.7789
[P1] Ep 125: Loss 0.3453 | Val MAE 1.8875
[P1] Ep 126: Loss 0.3358 | Val MAE 1.7566
[P1] Ep 127: Loss 0.3317 | Val MAE 1.7702
[P1] Ep 128: Loss 0.3282 | Val MAE 1.8229
[P1] Ep 129: Loss 0.3360 | Val MAE 1.7413
[P1] Ep 130: Loss 0.3280 | Val MAE 1.8307
[P1] Ep 131: Loss 0.3274 | Val MAE 1.8473
[P1] Ep 132: Loss 0.3362 | Val MAE 1.8922
[P1] Ep 133: Loss 0.3204 | Val MAE 1.7565
[P1] Ep 134: Loss 0.3207 | Val MAE 1.7886
[P1] Ep 135: Loss 0.3229 | Val MAE 1.8420
[P1] Ep 136: Loss 0.3151 | Val MAE 1.8004
[P1] Ep 137: Loss 0.3154 | Val MAE 1.7250
[P1] Ep 138: Loss 0.3109 | Val MAE 1.8480
[P1] Ep 139: Loss 0.3144 | Val MAE 1.8684
[P1] Ep 140: Loss 0.3043 | Val MAE 1.8576
[P1] Ep 141: Loss 0.2971 | Val MAE 1.7983
[P1] Ep 142: Loss 0.2987 | Val MAE 1.8947
[P1] Ep 143: Loss 0.2926 | Val MAE 1.7318
[P1] Ep 144: Loss 0.2955 | Val MAE 1.8588
[P1] Ep 145: Loss 0.2903 | Val MAE 1.6594
[P1] Ep 146: Loss 0.2862 | Val MAE 1.7231
[P1] Ep 147: Loss 0.2900 | Val MAE 1.8441
[P1] Ep 148: Loss 0.2779 | Val MAE 1.6944
[P1] Ep 149: Loss 0.2801 | Val MAE 1.8132
[P1] Ep 150: Loss 0.2764 | Val MAE 1.7577
[P1] Ep 151: Loss 0.2769 | Val MAE 1.6985
[P1] Ep 152: Loss 0.2756 | Val MAE 1.5707
[P1] Ep 153: Loss 0.2748 | Val MAE 1.8229
[P1] Ep 154: Loss 0.2743 | Val MAE 1.8331
[P1] Ep 155: Loss 0.2653 | Val MAE 1.7775
[P1] Ep 156: Loss 0.2650 | Val MAE 1.7572
[P1] Ep 157: Loss 0.2641 | Val MAE 1.6513
[P1] Ep 158: Loss 0.2657 | Val MAE 1.6891
[P1] Ep 159: Loss 0.2608 | Val MAE 1.8104
[P1] Ep 160: Loss 0.2627 | Val MAE 1.6188
[P1] Ep 161: Loss 0.2595 | Val MAE 1.7053
[P1] Ep 162: Loss 0.2578 | Val MAE 1.6868
[P1] Ep 163: Loss 0.2581 | Val MAE 1.7301
[P1] Ep 164: Loss 0.2580 | Val MAE 1.7169
[P1] Ep 165: Loss 0.2473 | Val MAE 1.6301
[P1] Ep 166: Loss 0.2485 | Val MAE 1.7418
[P1] Ep 167: Loss 0.2486 | Val MAE 1.7923
[P1] Ep 168: Loss 0.2463 | Val MAE 1.7118
[P1] Ep 169: Loss 0.2332 | Val MAE 1.6399
[P1] Ep 170: Loss 0.2453 | Val MAE 1.6723
[P1] Ep 171: Loss 0.2360 | Val MAE 1.8034
[P1] Ep 172: Loss 0.2358 | Val MAE 1.7418
[P1] Ep 173: Loss 0.2411 | Val MAE 1.6902
[P1] Ep 174: Loss 0.2361 | Val MAE 1.6442
[P1] Ep 175: Loss 0.2373 | Val MAE 1.6661
[P1] Ep 176: Loss 0.2321 | Val MAE 1.7782
[P1] Ep 177: Loss 0.2342 | Val MAE 1.6219
[P1] Ep 178: Loss 0.2362 | Val MAE 1.6569
[P1] Ep 179: Loss 0.2323 | Val MAE 1.7506
[P1] Ep 180: Loss 0.2259 | Val MAE 1.6988
[P1] Ep 181: Loss 0.2263 | Val MAE 1.6709
[P1] Ep 182: Loss 0.2196 | Val MAE 1.7586
[P1] Ep 183: Loss 0.2199 | Val MAE 1.6622
[P1] Ep 184: Loss 0.2211 | Val MAE 1.7264
[P1] Ep 185: Loss 0.2185 | Val MAE 1.6623
[P1] Ep 186: Loss 0.2158 | Val MAE 1.6983
[P1] Ep 187: Loss 0.2074 | Val MAE 1.7291
[P1] Ep 188: Loss 0.2144 | Val MAE 1.6506
[P1] Ep 189: Loss 0.2163 | Val MAE 1.7453
[P1] Ep 190: Loss 0.2133 | Val MAE 1.8450
[P1] Ep 191: Loss 0.2014 | Val MAE 1.8357
[P1] Ep 192: Loss 0.2064 | Val MAE 1.7533
[P1] Ep 193: Loss 0.2090 | Val MAE 1.6698
[P1] Ep 194: Loss 0.2073 | Val MAE 1.8330
[P1] Ep 195: Loss 0.2038 | Val MAE 1.5849
[P1] Ep 196: Loss 0.2010 | Val MAE 1.6875
[P1] Ep 197: Loss 0.2017 | Val MAE 1.6899
[P1] Ep 198: Loss 0.2019 | Val MAE 1.7281
[P1] Ep 199: Loss 0.1963 | Val MAE 1.7084
[P1] Ep 200: Loss 0.1978 | Val MAE 1.6847

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 7.9710 | Val MAE 1.5731 CI 0.5088
[FT] Ep 2: Loss 8.2552 | Val MAE 1.4927 CI 0.5088
[FT] Ep 3: Loss 7.1059 | Val MAE 1.4443 CI 0.5263
[FT] Ep 4: Loss 6.5248 | Val MAE 1.4141 CI 0.5205
[FT] Ep 5: Loss 6.7624 | Val MAE 1.4106 CI 0.5322
[FT] Ep 6: Loss 6.2914 | Val MAE 1.4195 CI 0.5322
[FT] Ep 7: Loss 5.8962 | Val MAE 1.4345 CI 0.5146
[FT] Ep 8: Loss 5.7459 | Val MAE 1.4527 CI 0.5088
[FT] Ep 9: Loss 5.4468 | Val MAE 1.4727 CI 0.5146
[FT] Ep 10: Loss 5.3336 | Val MAE 1.4937 CI 0.5205
[FT] Ep 11: Loss 5.3955 | Val MAE 1.5100 CI 0.5205
[FT] Ep 12: Loss 5.0612 | Val MAE 1.5256 CI 0.5380
[FT] Ep 13: Loss 5.3002 | Val MAE 1.5413 CI 0.5322
[FT] Ep 14: Loss 5.3229 | Val MAE 1.5602 CI 0.5146
[FT] Ep 15: Loss 4.7859 | Val MAE 1.5748 CI 0.5088
[FT] Ep 16: Loss 4.8593 | Val MAE 1.5916 CI 0.5146
[FT] Ep 17: Loss 4.7142 | Val MAE 1.6056 CI 0.5088
[FT] Ep 18: Loss 4.4491 | Val MAE 1.6171 CI 0.5146
[FT] Ep 19: Loss 4.5576 | Val MAE 1.6260 CI 0.5146
[FT] Ep 20: Loss 4.4854 | Val MAE 1.6352 CI 0.5146
[FT] Ep 21: Loss 4.3799 | Val MAE 1.6416 CI 0.5205
[FT] Ep 22: Loss 4.3641 | Val MAE 1.6466 CI 0.5146
[FT] Ep 23: Loss 4.6372 | Val MAE 1.6534 CI 0.5029
[FT] Ep 24: Loss 4.2955 | Val MAE 1.6579 CI 0.5029
[FT] Ep 25: Loss 4.3656 | Val MAE 1.6576 CI 0.5029
[FT] Ep 26: Loss 4.1128 | Val MAE 1.6597 CI 0.5029
[FT] Ep 27: Loss 4.0591 | Val MAE 1.6578 CI 0.5029
[FT] Ep 28: Loss 3.9963 | Val MAE 1.6563 CI 0.5029
[FT] Ep 29: Loss 4.0333 | Val MAE 1.6573 CI 0.5088
[FT] Ep 30: Loss 3.8571 | Val MAE 1.6630 CI 0.5029
[FT] Ep 31: Loss 3.9582 | Val MAE 1.6646 CI 0.5029
[FT] Ep 32: Loss 3.8719 | Val MAE 1.6671 CI 0.5088
[FT] Ep 33: Loss 3.8949 | Val MAE 1.6699 CI 0.5029
[FT] Ep 34: Loss 3.9450 | Val MAE 1.6720 CI 0.5029
[FT] Ep 35: Loss 3.5521 | Val MAE 1.6707 CI 0.5029
[FT] Ep 36: Loss 3.8203 | Val MAE 1.6701 CI 0.5029
[FT] Ep 37: Loss 3.7703 | Val MAE 1.6704 CI 0.5029
[FT] Ep 38: Loss 3.7015 | Val MAE 1.6703 CI 0.5205
[FT] Ep 39: Loss 3.3934 | Val MAE 1.6652 CI 0.5263
[FT] Ep 40: Loss 3.6273 | Val MAE 1.6649 CI 0.5263
[FT] Ep 41: Loss 3.5822 | Val MAE 1.6613 CI 0.5263
[FT] Ep 42: Loss 3.2633 | Val MAE 1.6593 CI 0.5263
[FT] Ep 43: Loss 3.4044 | Val MAE 1.6571 CI 0.5263
[FT] Ep 44: Loss 3.3598 | Val MAE 1.6577 CI 0.5322
[FT] Ep 45: Loss 3.4060 | Val MAE 1.6586 CI 0.5205
[FT] Ep 46: Loss 3.2801 | Val MAE 1.6584 CI 0.5146
[FT] Ep 47: Loss 3.2679 | Val MAE 1.6596 CI 0.5146
[FT] Ep 48: Loss 3.1072 | Val MAE 1.6636 CI 0.5146
[FT] Ep 49: Loss 3.0820 | Val MAE 1.6611 CI 0.5146
[FT] Ep 50: Loss 2.9984 | Val MAE 1.6597 CI 0.5205
[FT] Ep 51: Loss 3.1261 | Val MAE 1.6575 CI 0.5146
[FT] Ep 52: Loss 3.1555 | Val MAE 1.6563 CI 0.5205
[FT] Ep 53: Loss 2.8863 | Val MAE 1.6546 CI 0.5205
[FT] Ep 54: Loss 2.9090 | Val MAE 1.6577 CI 0.5263
[FT] Ep 55: Loss 3.0873 | Val MAE 1.6639 CI 0.5263
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: K-Means
   MAE:  1.3076
   RMSE: 1.6996
   CI:   0.6579
   RM2:  0.1150
   MAPE: 21.90 %
   Acc:  35.00 %
------------------------------------------------------------
