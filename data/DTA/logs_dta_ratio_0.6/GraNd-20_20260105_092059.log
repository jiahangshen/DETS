--- DTA Baseline: GraNd-20 (Ratio: 0.6) ---

>>> [Stage 0] Sampling...

[Sampler] Running GraNd-20 | Target: 14973/24956 (60.0%)
Scanning Source (GraNd-20):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (GraNd-20):   4%|▍         | 1/25 [00:08<03:18,  8.26s/it]Scanning Source (GraNd-20):   8%|▊         | 2/25 [00:08<01:23,  3.64s/it]Scanning Source (GraNd-20):  12%|█▏        | 3/25 [00:09<00:47,  2.16s/it]Scanning Source (GraNd-20):  16%|█▌        | 4/25 [00:09<00:31,  1.50s/it]Scanning Source (GraNd-20):  20%|██        | 5/25 [00:11<00:34,  1.72s/it]Scanning Source (GraNd-20):  24%|██▍       | 6/25 [00:12<00:24,  1.27s/it]Scanning Source (GraNd-20):  28%|██▊       | 7/25 [00:12<00:17,  1.01it/s]Scanning Source (GraNd-20):  32%|███▏      | 8/25 [00:12<00:13,  1.25it/s]Scanning Source (GraNd-20):  36%|███▌      | 9/25 [00:17<00:33,  2.11s/it]Scanning Source (GraNd-20):  40%|████      | 10/25 [00:18<00:23,  1.58s/it]Scanning Source (GraNd-20):  44%|████▍     | 11/25 [00:18<00:17,  1.22s/it]Scanning Source (GraNd-20):  48%|████▊     | 12/25 [00:19<00:12,  1.03it/s]Scanning Source (GraNd-20):  52%|█████▏    | 13/25 [00:23<00:23,  1.93s/it]Scanning Source (GraNd-20):  56%|█████▌    | 14/25 [00:24<00:19,  1.79s/it]Scanning Source (GraNd-20):  60%|██████    | 15/25 [00:25<00:13,  1.37s/it]Scanning Source (GraNd-20):  64%|██████▍   | 16/25 [00:25<00:09,  1.08s/it]Scanning Source (GraNd-20):  68%|██████▊   | 17/25 [00:29<00:15,  1.93s/it]Scanning Source (GraNd-20):  72%|███████▏  | 18/25 [00:29<00:10,  1.53s/it]Scanning Source (GraNd-20):  76%|███████▌  | 19/25 [00:30<00:07,  1.19s/it]Scanning Source (GraNd-20):  80%|████████  | 20/25 [00:30<00:04,  1.05it/s]Scanning Source (GraNd-20):  84%|████████▍ | 21/25 [00:34<00:06,  1.74s/it]Scanning Source (GraNd-20):  88%|████████▊ | 22/25 [00:34<00:03,  1.31s/it]Scanning Source (GraNd-20):  92%|█████████▏| 23/25 [00:34<00:02,  1.02s/it]Scanning Source (GraNd-20):  96%|█████████▌| 24/25 [00:35<00:00,  1.23it/s]Scanning Source (GraNd-20): 100%|██████████| 25/25 [00:35<00:00,  1.65it/s]                                                                           -> Source reduced: 24956 -> 14973

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 1.8382 | Val MAE 1.8796
[P1] Ep 2: Loss 1.0528 | Val MAE 1.7155
[P1] Ep 3: Loss 0.9559 | Val MAE 1.9184
[P1] Ep 4: Loss 0.9183 | Val MAE 1.7794
[P1] Ep 5: Loss 0.8601 | Val MAE 1.8200
[P1] Ep 6: Loss 0.8399 | Val MAE 1.8093
[P1] Ep 7: Loss 0.8231 | Val MAE 1.7438
[P1] Ep 8: Loss 0.8056 | Val MAE 1.8004
[P1] Ep 9: Loss 0.7772 | Val MAE 1.8114
[P1] Ep 10: Loss 0.7545 | Val MAE 1.7109
[P1] Ep 11: Loss 0.7426 | Val MAE 1.9608
[P1] Ep 12: Loss 0.7264 | Val MAE 1.7950
[P1] Ep 13: Loss 0.7240 | Val MAE 1.7013
[P1] Ep 14: Loss 0.7074 | Val MAE 1.8166
[P1] Ep 15: Loss 0.7125 | Val MAE 1.8068
[P1] Ep 16: Loss 0.7026 | Val MAE 1.8401
[P1] Ep 17: Loss 0.6954 | Val MAE 1.7920
[P1] Ep 18: Loss 0.6977 | Val MAE 1.8174
[P1] Ep 19: Loss 0.6937 | Val MAE 1.8187
[P1] Ep 20: Loss 0.6835 | Val MAE 1.7554
[P1] Ep 21: Loss 0.6651 | Val MAE 1.7917
[P1] Ep 22: Loss 0.6615 | Val MAE 1.8125
[P1] Ep 23: Loss 0.6675 | Val MAE 1.8039
[P1] Ep 24: Loss 0.6648 | Val MAE 1.7146
[P1] Ep 25: Loss 0.6606 | Val MAE 1.6627
[P1] Ep 26: Loss 0.6579 | Val MAE 1.6849
[P1] Ep 27: Loss 0.6538 | Val MAE 1.7654
[P1] Ep 28: Loss 0.6544 | Val MAE 1.7177
[P1] Ep 29: Loss 0.6448 | Val MAE 1.7404
[P1] Ep 30: Loss 0.6479 | Val MAE 1.7264
[P1] Ep 31: Loss 0.6245 | Val MAE 1.7393
[P1] Ep 32: Loss 0.6311 | Val MAE 1.6971
[P1] Ep 33: Loss 0.6228 | Val MAE 1.6561
[P1] Ep 34: Loss 0.6224 | Val MAE 1.6437
[P1] Ep 35: Loss 0.6197 | Val MAE 1.7388
[P1] Ep 36: Loss 0.6121 | Val MAE 1.7135
[P1] Ep 37: Loss 0.6044 | Val MAE 1.7587
[P1] Ep 38: Loss 0.6042 | Val MAE 1.6949
[P1] Ep 39: Loss 0.6052 | Val MAE 1.7419
[P1] Ep 40: Loss 0.5975 | Val MAE 1.8550
[P1] Ep 41: Loss 0.6045 | Val MAE 1.7438
[P1] Ep 42: Loss 0.5865 | Val MAE 1.7461
[P1] Ep 43: Loss 0.5930 | Val MAE 1.7067
[P1] Ep 44: Loss 0.5848 | Val MAE 1.7778
[P1] Ep 45: Loss 0.5778 | Val MAE 1.7463
[P1] Ep 46: Loss 0.5780 | Val MAE 1.7424
[P1] Ep 47: Loss 0.5756 | Val MAE 1.6642
[P1] Ep 48: Loss 0.5688 | Val MAE 1.6575
[P1] Ep 49: Loss 0.5671 | Val MAE 1.7056
[P1] Ep 50: Loss 0.5550 | Val MAE 1.7694
[P1] Ep 51: Loss 0.5555 | Val MAE 1.7155
[P1] Ep 52: Loss 0.5470 | Val MAE 1.6317
[P1] Ep 53: Loss 0.5444 | Val MAE 1.6360
[P1] Ep 54: Loss 0.5466 | Val MAE 1.7191
[P1] Ep 55: Loss 0.5368 | Val MAE 1.6562
[P1] Ep 56: Loss 0.5311 | Val MAE 1.7574
[P1] Ep 57: Loss 0.5216 | Val MAE 1.7251
[P1] Ep 58: Loss 0.5111 | Val MAE 1.7658
[P1] Ep 59: Loss 0.5102 | Val MAE 1.8610
[P1] Ep 60: Loss 0.4977 | Val MAE 1.7964
[P1] Ep 61: Loss 0.5038 | Val MAE 1.7647
[P1] Ep 62: Loss 0.4969 | Val MAE 1.8707
[P1] Ep 63: Loss 0.4860 | Val MAE 1.7228
[P1] Ep 64: Loss 0.4912 | Val MAE 1.7728
[P1] Ep 65: Loss 0.4878 | Val MAE 1.7257
[P1] Ep 66: Loss 0.4819 | Val MAE 1.6700
[P1] Ep 67: Loss 0.4767 | Val MAE 1.6298
[P1] Ep 68: Loss 0.4628 | Val MAE 1.7276
[P1] Ep 69: Loss 0.4579 | Val MAE 1.7289
[P1] Ep 70: Loss 0.4620 | Val MAE 1.7946
[P1] Ep 71: Loss 0.4508 | Val MAE 1.8027
[P1] Ep 72: Loss 0.4585 | Val MAE 1.8377
[P1] Ep 73: Loss 0.4467 | Val MAE 1.7171
[P1] Ep 74: Loss 0.4497 | Val MAE 1.7002
[P1] Ep 75: Loss 0.4491 | Val MAE 1.7000
[P1] Ep 76: Loss 0.4375 | Val MAE 1.8388
[P1] Ep 77: Loss 0.4350 | Val MAE 1.7843
[P1] Ep 78: Loss 0.4338 | Val MAE 1.8275
[P1] Ep 79: Loss 0.4325 | Val MAE 1.7371
[P1] Ep 80: Loss 0.4240 | Val MAE 1.7371
[P1] Ep 81: Loss 0.4240 | Val MAE 1.6590
[P1] Ep 82: Loss 0.4103 | Val MAE 1.6763
[P1] Ep 83: Loss 0.4156 | Val MAE 1.8890
[P1] Ep 84: Loss 0.4104 | Val MAE 1.7437
[P1] Ep 85: Loss 0.4066 | Val MAE 1.7158
[P1] Ep 86: Loss 0.4061 | Val MAE 1.7341
[P1] Ep 87: Loss 0.4054 | Val MAE 1.6774
[P1] Ep 88: Loss 0.3967 | Val MAE 1.7939
[P1] Ep 89: Loss 0.4031 | Val MAE 1.7780
[P1] Ep 90: Loss 0.3931 | Val MAE 1.7596
[P1] Ep 91: Loss 0.3980 | Val MAE 1.7391
[P1] Ep 92: Loss 0.3844 | Val MAE 1.6748
[P1] Ep 93: Loss 0.3832 | Val MAE 1.7048
[P1] Ep 94: Loss 0.3773 | Val MAE 1.7797
[P1] Ep 95: Loss 0.3810 | Val MAE 1.7759
[P1] Ep 96: Loss 0.3715 | Val MAE 1.7226
[P1] Ep 97: Loss 0.3866 | Val MAE 1.6655
[P1] Ep 98: Loss 0.3662 | Val MAE 1.7053
[P1] Ep 99: Loss 0.3721 | Val MAE 1.7378
[P1] Ep 100: Loss 0.3639 | Val MAE 1.7079
[P1] Ep 101: Loss 0.3662 | Val MAE 1.6481
[P1] Ep 102: Loss 0.3653 | Val MAE 1.8049
[P1] Ep 103: Loss 0.3574 | Val MAE 1.7064
[P1] Ep 104: Loss 0.3492 | Val MAE 1.7599
[P1] Ep 105: Loss 0.3601 | Val MAE 1.6852
[P1] Ep 106: Loss 0.3583 | Val MAE 1.7059
[P1] Ep 107: Loss 0.3430 | Val MAE 1.7384
[P1] Ep 108: Loss 0.3473 | Val MAE 1.6944
[P1] Ep 109: Loss 0.3482 | Val MAE 1.6421
[P1] Ep 110: Loss 0.3410 | Val MAE 1.6062
[P1] Ep 111: Loss 0.3383 | Val MAE 1.5876
[P1] Ep 112: Loss 0.3422 | Val MAE 1.7667
[P1] Ep 113: Loss 0.3358 | Val MAE 1.6908
[P1] Ep 114: Loss 0.3329 | Val MAE 1.5918
[P1] Ep 115: Loss 0.3250 | Val MAE 1.5964
[P1] Ep 116: Loss 0.3292 | Val MAE 1.7439
[P1] Ep 117: Loss 0.3240 | Val MAE 1.6080
[P1] Ep 118: Loss 0.3217 | Val MAE 1.5083
[P1] Ep 119: Loss 0.3212 | Val MAE 1.5433
[P1] Ep 120: Loss 0.3212 | Val MAE 1.5431
[P1] Ep 121: Loss 0.3110 | Val MAE 1.6779
[P1] Ep 122: Loss 0.3131 | Val MAE 1.7143
[P1] Ep 123: Loss 0.3172 | Val MAE 1.7623
[P1] Ep 124: Loss 0.3093 | Val MAE 1.6691
[P1] Ep 125: Loss 0.3070 | Val MAE 1.5641
[P1] Ep 126: Loss 0.3046 | Val MAE 1.6646
[P1] Ep 127: Loss 0.3041 | Val MAE 1.7287
[P1] Ep 128: Loss 0.3026 | Val MAE 1.6541
[P1] Ep 129: Loss 0.3024 | Val MAE 1.6085
[P1] Ep 130: Loss 0.2977 | Val MAE 1.6541
[P1] Ep 131: Loss 0.2908 | Val MAE 1.6262
[P1] Ep 132: Loss 0.3038 | Val MAE 1.5298
[P1] Ep 133: Loss 0.2890 | Val MAE 1.5359
[P1] Ep 134: Loss 0.2831 | Val MAE 1.5254
[P1] Ep 135: Loss 0.2878 | Val MAE 1.6563
[P1] Ep 136: Loss 0.2808 | Val MAE 1.5695
[P1] Ep 137: Loss 0.2835 | Val MAE 1.5830
[P1] Ep 138: Loss 0.2823 | Val MAE 1.6547
[P1] Ep 139: Loss 0.2754 | Val MAE 1.6564
[P1] Ep 140: Loss 0.2807 | Val MAE 1.6621
[P1] Ep 141: Loss 0.2742 | Val MAE 1.6179
[P1] Ep 142: Loss 0.2683 | Val MAE 1.6427
[P1] Ep 143: Loss 0.2699 | Val MAE 1.6006
[P1] Ep 144: Loss 0.2659 | Val MAE 1.6593
[P1] Ep 145: Loss 0.2736 | Val MAE 1.5880
[P1] Ep 146: Loss 0.2671 | Val MAE 1.6355
[P1] Ep 147: Loss 0.2679 | Val MAE 1.6421
[P1] Ep 148: Loss 0.2607 | Val MAE 1.6959
[P1] Ep 149: Loss 0.2604 | Val MAE 1.6934
[P1] Ep 150: Loss 0.2565 | Val MAE 1.6565
[P1] Ep 151: Loss 0.2534 | Val MAE 1.6516
[P1] Ep 152: Loss 0.2536 | Val MAE 1.6033
[P1] Ep 153: Loss 0.2484 | Val MAE 1.6388
[P1] Ep 154: Loss 0.2510 | Val MAE 1.6466
[P1] Ep 155: Loss 0.2442 | Val MAE 1.6622
[P1] Ep 156: Loss 0.2472 | Val MAE 1.6930
[P1] Ep 157: Loss 0.2470 | Val MAE 1.6797
[P1] Ep 158: Loss 0.2457 | Val MAE 1.7235
[P1] Ep 159: Loss 0.2461 | Val MAE 1.6401
[P1] Ep 160: Loss 0.2379 | Val MAE 1.6797
[P1] Ep 161: Loss 0.2355 | Val MAE 1.7509
[P1] Ep 162: Loss 0.2354 | Val MAE 1.6513
[P1] Ep 163: Loss 0.2343 | Val MAE 1.6848
[P1] Ep 164: Loss 0.2351 | Val MAE 1.7397
[P1] Ep 165: Loss 0.2251 | Val MAE 1.6881
[P1] Ep 166: Loss 0.2311 | Val MAE 1.7506
[P1] Ep 167: Loss 0.2275 | Val MAE 1.7509
[P1] Ep 168: Loss 0.2216 | Val MAE 1.7187
[P1] Ep 169: Loss 0.2304 | Val MAE 1.7131
[P1] Ep 170: Loss 0.2198 | Val MAE 1.7075
[P1] Ep 171: Loss 0.2208 | Val MAE 1.7807
[P1] Ep 172: Loss 0.2197 | Val MAE 1.7001
[P1] Ep 173: Loss 0.2200 | Val MAE 1.7276
[P1] Ep 174: Loss 0.2171 | Val MAE 1.7296
[P1] Ep 175: Loss 0.2148 | Val MAE 1.6941
[P1] Ep 176: Loss 0.2167 | Val MAE 1.6667
[P1] Ep 177: Loss 0.2140 | Val MAE 1.7124
[P1] Ep 178: Loss 0.2101 | Val MAE 1.6923
[P1] Ep 179: Loss 0.2097 | Val MAE 1.7351
[P1] Ep 180: Loss 0.2081 | Val MAE 1.6363
[P1] Ep 181: Loss 0.2056 | Val MAE 1.6934
[P1] Ep 182: Loss 0.2091 | Val MAE 1.6789
[P1] Ep 183: Loss 0.2013 | Val MAE 1.7309
[P1] Ep 184: Loss 0.2042 | Val MAE 1.6519
[P1] Ep 185: Loss 0.2048 | Val MAE 1.8159
[P1] Ep 186: Loss 0.1995 | Val MAE 1.7961
[P1] Ep 187: Loss 0.1979 | Val MAE 1.8626
[P1] Ep 188: Loss 0.1987 | Val MAE 1.7350
[P1] Ep 189: Loss 0.1986 | Val MAE 1.6720
[P1] Ep 190: Loss 0.1923 | Val MAE 1.6822
[P1] Ep 191: Loss 0.1911 | Val MAE 1.6541
[P1] Ep 192: Loss 0.1932 | Val MAE 1.7493
[P1] Ep 193: Loss 0.1881 | Val MAE 1.6520
[P1] Ep 194: Loss 0.1895 | Val MAE 1.6605
[P1] Ep 195: Loss 0.1916 | Val MAE 1.7146
[P1] Ep 196: Loss 0.1865 | Val MAE 1.6920
[P1] Ep 197: Loss 0.1839 | Val MAE 1.7760
[P1] Ep 198: Loss 0.1854 | Val MAE 1.6934
[P1] Ep 199: Loss 0.1794 | Val MAE 1.7273
[P1] Ep 200: Loss 0.1822 | Val MAE 1.7517

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 8.0965 | Val MAE 1.6590 CI 0.5673
[FT] Ep 2: Loss 7.6164 | Val MAE 1.6121 CI 0.5497
[FT] Ep 3: Loss 7.3377 | Val MAE 1.5704 CI 0.5614
[FT] Ep 4: Loss 6.8387 | Val MAE 1.5405 CI 0.5673
[FT] Ep 5: Loss 6.6851 | Val MAE 1.5095 CI 0.5789
[FT] Ep 6: Loss 6.5824 | Val MAE 1.4840 CI 0.5906
[FT] Ep 7: Loss 5.9774 | Val MAE 1.4808 CI 0.5965
[FT] Ep 8: Loss 5.9173 | Val MAE 1.4893 CI 0.6082
[FT] Ep 9: Loss 5.8815 | Val MAE 1.4994 CI 0.6023
[FT] Ep 10: Loss 5.5369 | Val MAE 1.5181 CI 0.6023
[FT] Ep 11: Loss 5.2250 | Val MAE 1.5342 CI 0.6082
[FT] Ep 12: Loss 5.1809 | Val MAE 1.5487 CI 0.6082
[FT] Ep 13: Loss 4.9436 | Val MAE 1.5650 CI 0.6140
[FT] Ep 14: Loss 4.9280 | Val MAE 1.5773 CI 0.6082
[FT] Ep 15: Loss 4.8056 | Val MAE 1.5881 CI 0.6082
[FT] Ep 16: Loss 4.6286 | Val MAE 1.5963 CI 0.6082
[FT] Ep 17: Loss 4.6524 | Val MAE 1.5994 CI 0.5965
[FT] Ep 18: Loss 4.2640 | Val MAE 1.6041 CI 0.6023
[FT] Ep 19: Loss 4.2552 | Val MAE 1.6094 CI 0.6023
[FT] Ep 20: Loss 4.4741 | Val MAE 1.6091 CI 0.5965
[FT] Ep 21: Loss 4.0651 | Val MAE 1.6098 CI 0.5965
[FT] Ep 22: Loss 3.9948 | Val MAE 1.6080 CI 0.5848
[FT] Ep 23: Loss 3.9719 | Val MAE 1.6077 CI 0.5789
[FT] Ep 24: Loss 4.0147 | Val MAE 1.6133 CI 0.5614
[FT] Ep 25: Loss 3.4870 | Val MAE 1.6180 CI 0.5614
[FT] Ep 26: Loss 4.0663 | Val MAE 1.6207 CI 0.5497
[FT] Ep 27: Loss 3.7214 | Val MAE 1.6233 CI 0.5263
[FT] Ep 28: Loss 3.6016 | Val MAE 1.6219 CI 0.5322
[FT] Ep 29: Loss 3.4221 | Val MAE 1.6220 CI 0.5322
[FT] Ep 30: Loss 3.2409 | Val MAE 1.6244 CI 0.5322
[FT] Ep 31: Loss 3.2454 | Val MAE 1.6283 CI 0.5146
[FT] Ep 32: Loss 3.2904 | Val MAE 1.6336 CI 0.5146
[FT] Ep 33: Loss 3.1977 | Val MAE 1.6324 CI 0.5263
[FT] Ep 34: Loss 3.4866 | Val MAE 1.6236 CI 0.5263
[FT] Ep 35: Loss 3.0489 | Val MAE 1.6254 CI 0.5322
[FT] Ep 36: Loss 3.1816 | Val MAE 1.6258 CI 0.5322
[FT] Ep 37: Loss 3.1107 | Val MAE 1.6247 CI 0.5322
[FT] Ep 38: Loss 3.0839 | Val MAE 1.6224 CI 0.5380
[FT] Ep 39: Loss 2.8512 | Val MAE 1.6257 CI 0.5439
[FT] Ep 40: Loss 2.7585 | Val MAE 1.6212 CI 0.5614
[FT] Ep 41: Loss 2.9519 | Val MAE 1.6178 CI 0.5556
[FT] Ep 42: Loss 2.7731 | Val MAE 1.6128 CI 0.5614
[FT] Ep 43: Loss 2.4350 | Val MAE 1.6131 CI 0.5556
[FT] Ep 44: Loss 2.6871 | Val MAE 1.6167 CI 0.5556
[FT] Ep 45: Loss 2.6251 | Val MAE 1.6154 CI 0.5556
[FT] Ep 46: Loss 2.4957 | Val MAE 1.6219 CI 0.5497
[FT] Ep 47: Loss 2.3567 | Val MAE 1.6331 CI 0.5497
[FT] Ep 48: Loss 2.1844 | Val MAE 1.6380 CI 0.5439
[FT] Ep 49: Loss 2.4189 | Val MAE 1.6389 CI 0.5439
[FT] Ep 50: Loss 2.1636 | Val MAE 1.6462 CI 0.5439
[FT] Ep 51: Loss 1.9916 | Val MAE 1.6504 CI 0.5439
[FT] Ep 52: Loss 2.1382 | Val MAE 1.6507 CI 0.5497
[FT] Ep 53: Loss 2.0093 | Val MAE 1.6555 CI 0.5614
[FT] Ep 54: Loss 1.9651 | Val MAE 1.6592 CI 0.5556
[FT] Ep 55: Loss 2.1103 | Val MAE 1.6658 CI 0.5614
[FT] Ep 56: Loss 1.9825 | Val MAE 1.6666 CI 0.5614
[FT] Ep 57: Loss 1.9171 | Val MAE 1.6572 CI 0.5556
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: GraNd-20
   MAE:  1.5031
   RMSE: 1.9704
   CI:   0.5368
   RM2:  0.0094
   MAPE: 24.71 %
   Acc:  30.00 %
------------------------------------------------------------
