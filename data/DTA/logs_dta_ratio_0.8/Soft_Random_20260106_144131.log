--- DTA Baseline: Soft Random (Ratio: 0.8) ---

>>> [Stage 0] Sampling...

[Sampler] Running Soft Random | Target: 19964/24956 (80.0%)
Scanning Source (Soft Random):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (Soft Random):   4%|▍         | 1/25 [00:03<01:22,  3.45s/it]Scanning Source (Soft Random):   8%|▊         | 2/25 [00:03<00:37,  1.62s/it]Scanning Source (Soft Random):  12%|█▏        | 3/25 [00:04<00:23,  1.05s/it]Scanning Source (Soft Random):  16%|█▌        | 4/25 [00:04<00:16,  1.29it/s]Scanning Source (Soft Random):  20%|██        | 5/25 [00:05<00:15,  1.27it/s]Scanning Source (Soft Random):  24%|██▍       | 6/25 [00:05<00:12,  1.57it/s]Scanning Source (Soft Random):  28%|██▊       | 7/25 [00:06<00:09,  1.84it/s]Scanning Source (Soft Random):  32%|███▏      | 8/25 [00:06<00:08,  2.08it/s]Scanning Source (Soft Random):  36%|███▌      | 9/25 [00:07<00:10,  1.54it/s]Scanning Source (Soft Random):  40%|████      | 10/25 [00:07<00:08,  1.79it/s]Scanning Source (Soft Random):  44%|████▍     | 11/25 [00:08<00:06,  2.04it/s]Scanning Source (Soft Random):  48%|████▊     | 12/25 [00:08<00:05,  2.24it/s]Scanning Source (Soft Random):  52%|█████▏    | 13/25 [00:09<00:08,  1.45it/s]Scanning Source (Soft Random):  56%|█████▌    | 14/25 [00:10<00:06,  1.62it/s]Scanning Source (Soft Random):  60%|██████    | 15/25 [00:10<00:05,  1.87it/s]Scanning Source (Soft Random):  64%|██████▍   | 16/25 [00:10<00:04,  2.08it/s]Scanning Source (Soft Random):  68%|██████▊   | 17/25 [00:11<00:04,  1.64it/s]Scanning Source (Soft Random):  72%|███████▏  | 18/25 [00:12<00:03,  1.89it/s]Scanning Source (Soft Random):  76%|███████▌  | 19/25 [00:12<00:02,  2.09it/s]Scanning Source (Soft Random):  80%|████████  | 20/25 [00:12<00:02,  2.29it/s]Scanning Source (Soft Random):  84%|████████▍ | 21/25 [00:13<00:02,  1.73it/s]Scanning Source (Soft Random):  88%|████████▊ | 22/25 [00:14<00:01,  1.98it/s]Scanning Source (Soft Random):  92%|█████████▏| 23/25 [00:14<00:00,  2.20it/s]Scanning Source (Soft Random):  96%|█████████▌| 24/25 [00:14<00:00,  2.36it/s]Scanning Source (Soft Random): 100%|██████████| 25/25 [00:14<00:00,  3.00it/s]                                                                              -> Source reduced: 24956 -> 19964

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 1.5275 | Val MAE 2.1056
[P1] Ep 2: Loss 0.9444 | Val MAE 2.0915
[P1] Ep 3: Loss 0.8867 | Val MAE 2.0410
[P1] Ep 4: Loss 0.8428 | Val MAE 2.1610
[P1] Ep 5: Loss 0.8297 | Val MAE 1.9523
[P1] Ep 6: Loss 0.8101 | Val MAE 1.8830
[P1] Ep 7: Loss 0.7853 | Val MAE 1.9106
[P1] Ep 8: Loss 0.7652 | Val MAE 1.8517
[P1] Ep 9: Loss 0.7475 | Val MAE 1.8547
[P1] Ep 10: Loss 0.7412 | Val MAE 1.9566
[P1] Ep 11: Loss 0.7304 | Val MAE 2.1045
[P1] Ep 12: Loss 0.7208 | Val MAE 1.9010
[P1] Ep 13: Loss 0.7188 | Val MAE 1.8156
[P1] Ep 14: Loss 0.7112 | Val MAE 1.9217
[P1] Ep 15: Loss 0.7102 | Val MAE 1.7627
[P1] Ep 16: Loss 0.6890 | Val MAE 1.9020
[P1] Ep 17: Loss 0.6804 | Val MAE 1.9406
[P1] Ep 18: Loss 0.6727 | Val MAE 1.9459
[P1] Ep 19: Loss 0.6764 | Val MAE 1.9802
[P1] Ep 20: Loss 0.6618 | Val MAE 1.9310
[P1] Ep 21: Loss 0.6604 | Val MAE 2.0564
[P1] Ep 22: Loss 0.6518 | Val MAE 2.0093
[P1] Ep 23: Loss 0.6484 | Val MAE 2.0094
[P1] Ep 24: Loss 0.6334 | Val MAE 1.9277
[P1] Ep 25: Loss 0.6379 | Val MAE 1.9601
[P1] Ep 26: Loss 0.6182 | Val MAE 1.9744
[P1] Ep 27: Loss 0.6173 | Val MAE 1.9702
[P1] Ep 28: Loss 0.6180 | Val MAE 1.9670
[P1] Ep 29: Loss 0.6097 | Val MAE 1.8786
[P1] Ep 30: Loss 0.6040 | Val MAE 1.9828
[P1] Ep 31: Loss 0.5914 | Val MAE 2.0426
[P1] Ep 32: Loss 0.5980 | Val MAE 1.8704
[P1] Ep 33: Loss 0.5862 | Val MAE 1.9613
[P1] Ep 34: Loss 0.5775 | Val MAE 1.9542
[P1] Ep 35: Loss 0.5797 | Val MAE 1.8472
[P1] Ep 36: Loss 0.5784 | Val MAE 1.9483
[P1] Ep 37: Loss 0.5665 | Val MAE 1.8254
[P1] Ep 38: Loss 0.5620 | Val MAE 2.0030
[P1] Ep 39: Loss 0.5562 | Val MAE 1.9566
[P1] Ep 40: Loss 0.5512 | Val MAE 1.9961
[P1] Ep 41: Loss 0.5436 | Val MAE 2.0039
[P1] Ep 42: Loss 0.5392 | Val MAE 1.9619
[P1] Ep 43: Loss 0.5279 | Val MAE 2.0347
[P1] Ep 44: Loss 0.5299 | Val MAE 1.9915
[P1] Ep 45: Loss 0.5358 | Val MAE 1.9048
[P1] Ep 46: Loss 0.5198 | Val MAE 1.8206
[P1] Ep 47: Loss 0.5161 | Val MAE 1.8822
[P1] Ep 48: Loss 0.5094 | Val MAE 1.8899
[P1] Ep 49: Loss 0.5100 | Val MAE 2.0086
[P1] Ep 50: Loss 0.5048 | Val MAE 1.8985
[P1] Ep 51: Loss 0.5010 | Val MAE 1.9550
[P1] Ep 52: Loss 0.5023 | Val MAE 1.9569
[P1] Ep 53: Loss 0.4975 | Val MAE 1.9525
[P1] Ep 54: Loss 0.4921 | Val MAE 1.9927
[P1] Ep 55: Loss 0.4936 | Val MAE 2.1789
[P1] Ep 56: Loss 0.4851 | Val MAE 2.0867
[P1] Ep 57: Loss 0.4826 | Val MAE 2.1169
[P1] Ep 58: Loss 0.4795 | Val MAE 2.1465
[P1] Ep 59: Loss 0.4688 | Val MAE 2.0983
[P1] Ep 60: Loss 0.4668 | Val MAE 1.9816
[P1] Ep 61: Loss 0.4626 | Val MAE 1.7835
[P1] Ep 62: Loss 0.4644 | Val MAE 1.8944
[P1] Ep 63: Loss 0.4556 | Val MAE 1.8770
[P1] Ep 64: Loss 0.4558 | Val MAE 1.8972
[P1] Ep 65: Loss 0.4505 | Val MAE 1.9226
[P1] Ep 66: Loss 0.4430 | Val MAE 1.8350
[P1] Ep 67: Loss 0.4364 | Val MAE 1.6933
[P1] Ep 68: Loss 0.4354 | Val MAE 1.9048
[P1] Ep 69: Loss 0.4372 | Val MAE 1.8424
[P1] Ep 70: Loss 0.4330 | Val MAE 1.8535
[P1] Ep 71: Loss 0.4331 | Val MAE 1.8153
[P1] Ep 72: Loss 0.4306 | Val MAE 1.7156
[P1] Ep 73: Loss 0.4201 | Val MAE 1.8524
[P1] Ep 74: Loss 0.4219 | Val MAE 1.8147
[P1] Ep 75: Loss 0.4141 | Val MAE 1.8574
[P1] Ep 76: Loss 0.4208 | Val MAE 1.8531
[P1] Ep 77: Loss 0.4098 | Val MAE 1.8038
[P1] Ep 78: Loss 0.4083 | Val MAE 1.8623
[P1] Ep 79: Loss 0.4010 | Val MAE 1.8668
[P1] Ep 80: Loss 0.4020 | Val MAE 1.8638
[P1] Ep 81: Loss 0.4025 | Val MAE 1.9712
[P1] Ep 82: Loss 0.3979 | Val MAE 1.9381
[P1] Ep 83: Loss 0.3920 | Val MAE 1.8987
[P1] Ep 84: Loss 0.3844 | Val MAE 1.8625
[P1] Ep 85: Loss 0.3858 | Val MAE 1.9141
[P1] Ep 86: Loss 0.3826 | Val MAE 1.9271
[P1] Ep 87: Loss 0.3850 | Val MAE 1.9135
[P1] Ep 88: Loss 0.3774 | Val MAE 1.8504
[P1] Ep 89: Loss 0.3751 | Val MAE 1.9831
[P1] Ep 90: Loss 0.3681 | Val MAE 1.9836
[P1] Ep 91: Loss 0.3629 | Val MAE 1.8968
[P1] Ep 92: Loss 0.3622 | Val MAE 2.0337
[P1] Ep 93: Loss 0.3597 | Val MAE 1.8953
[P1] Ep 94: Loss 0.3516 | Val MAE 2.0122
[P1] Ep 95: Loss 0.3453 | Val MAE 2.0250
[P1] Ep 96: Loss 0.3414 | Val MAE 1.9568
[P1] Ep 97: Loss 0.3361 | Val MAE 2.0280
[P1] Ep 98: Loss 0.3426 | Val MAE 1.9990
[P1] Ep 99: Loss 0.3385 | Val MAE 2.0033
[P1] Ep 100: Loss 0.3357 | Val MAE 1.9175
[P1] Ep 101: Loss 0.3303 | Val MAE 2.0599
[P1] Ep 102: Loss 0.3300 | Val MAE 2.1017
[P1] Ep 103: Loss 0.3229 | Val MAE 2.1233
[P1] Ep 104: Loss 0.3181 | Val MAE 1.9431
[P1] Ep 105: Loss 0.3187 | Val MAE 2.0088
[P1] Ep 106: Loss 0.3106 | Val MAE 2.0466
[P1] Ep 107: Loss 0.3126 | Val MAE 1.9036
[P1] Ep 108: Loss 0.3102 | Val MAE 2.0432
[P1] Ep 109: Loss 0.3120 | Val MAE 2.1410
[P1] Ep 110: Loss 0.3031 | Val MAE 2.0489
[P1] Ep 111: Loss 0.2998 | Val MAE 1.9626
[P1] Ep 112: Loss 0.2950 | Val MAE 2.0343
[P1] Ep 113: Loss 0.2986 | Val MAE 1.9606
[P1] Ep 114: Loss 0.3003 | Val MAE 2.0293
[P1] Ep 115: Loss 0.2949 | Val MAE 2.0675
[P1] Ep 116: Loss 0.2875 | Val MAE 1.9953
[P1] Ep 117: Loss 0.2882 | Val MAE 1.9604
[P1] Ep 118: Loss 0.2777 | Val MAE 1.8304
[P1] Ep 119: Loss 0.2847 | Val MAE 1.8783
[P1] Ep 120: Loss 0.2769 | Val MAE 1.8722
[P1] Ep 121: Loss 0.2753 | Val MAE 1.8714
[P1] Ep 122: Loss 0.2727 | Val MAE 1.7814
[P1] Ep 123: Loss 0.2704 | Val MAE 1.8489
[P1] Ep 124: Loss 0.2706 | Val MAE 1.7879
[P1] Ep 125: Loss 0.2721 | Val MAE 1.7503
[P1] Ep 126: Loss 0.2634 | Val MAE 1.8927
[P1] Ep 127: Loss 0.2622 | Val MAE 1.7498
[P1] Ep 128: Loss 0.2625 | Val MAE 1.9330
[P1] Ep 129: Loss 0.2566 | Val MAE 1.8549
[P1] Ep 130: Loss 0.2572 | Val MAE 1.8871
[P1] Ep 131: Loss 0.2534 | Val MAE 1.7916
[P1] Ep 132: Loss 0.2511 | Val MAE 1.9806
[P1] Ep 133: Loss 0.2442 | Val MAE 1.8063
[P1] Ep 134: Loss 0.2471 | Val MAE 1.8643
[P1] Ep 135: Loss 0.2471 | Val MAE 1.9612
[P1] Ep 136: Loss 0.2418 | Val MAE 1.7791
[P1] Ep 137: Loss 0.2448 | Val MAE 1.8212
[P1] Ep 138: Loss 0.2461 | Val MAE 1.8483
[P1] Ep 139: Loss 0.2359 | Val MAE 1.7776
[P1] Ep 140: Loss 0.2391 | Val MAE 1.8548
[P1] Ep 141: Loss 0.2390 | Val MAE 1.7680
[P1] Ep 142: Loss 0.2357 | Val MAE 1.8046
[P1] Ep 143: Loss 0.2336 | Val MAE 1.8793
[P1] Ep 144: Loss 0.2264 | Val MAE 1.8149
[P1] Ep 145: Loss 0.2278 | Val MAE 1.8251
[P1] Ep 146: Loss 0.2240 | Val MAE 1.6621
[P1] Ep 147: Loss 0.2247 | Val MAE 1.8759
[P1] Ep 148: Loss 0.2246 | Val MAE 1.8421
[P1] Ep 149: Loss 0.2147 | Val MAE 1.8563
[P1] Ep 150: Loss 0.2197 | Val MAE 1.7909
[P1] Ep 151: Loss 0.2204 | Val MAE 1.7903
[P1] Ep 152: Loss 0.2118 | Val MAE 1.7744
[P1] Ep 153: Loss 0.2129 | Val MAE 1.8692
[P1] Ep 154: Loss 0.2141 | Val MAE 1.8755
[P1] Ep 155: Loss 0.2076 | Val MAE 1.8033
[P1] Ep 156: Loss 0.2152 | Val MAE 1.8549
[P1] Ep 157: Loss 0.2062 | Val MAE 1.8500
[P1] Ep 158: Loss 0.2098 | Val MAE 1.8420
[P1] Ep 159: Loss 0.2051 | Val MAE 1.8415
[P1] Ep 160: Loss 0.2113 | Val MAE 1.8614
[P1] Ep 161: Loss 0.2011 | Val MAE 1.8329
[P1] Ep 162: Loss 0.2018 | Val MAE 1.7567
[P1] Ep 163: Loss 0.2022 | Val MAE 1.8712
[P1] Ep 164: Loss 0.2013 | Val MAE 1.7661
[P1] Ep 165: Loss 0.1991 | Val MAE 1.7589
[P1] Ep 166: Loss 0.1988 | Val MAE 1.8936
[P1] Ep 167: Loss 0.1896 | Val MAE 1.8472
[P1] Ep 168: Loss 0.1904 | Val MAE 1.7157
[P1] Ep 169: Loss 0.1954 | Val MAE 1.7656
[P1] Ep 170: Loss 0.1929 | Val MAE 2.0052
[P1] Ep 171: Loss 0.1909 | Val MAE 1.8930
[P1] Ep 172: Loss 0.1857 | Val MAE 1.8353
[P1] Ep 173: Loss 0.1875 | Val MAE 1.9927
[P1] Ep 174: Loss 0.1842 | Val MAE 1.8416
[P1] Ep 175: Loss 0.1878 | Val MAE 1.9596
[P1] Ep 176: Loss 0.1830 | Val MAE 1.8654
[P1] Ep 177: Loss 0.1822 | Val MAE 1.7239
[P1] Ep 178: Loss 0.1777 | Val MAE 1.9426
[P1] Ep 179: Loss 0.1763 | Val MAE 1.7493
[P1] Ep 180: Loss 0.1786 | Val MAE 1.8578
[P1] Ep 181: Loss 0.1799 | Val MAE 1.7448
[P1] Ep 182: Loss 0.1773 | Val MAE 1.8270
[P1] Ep 183: Loss 0.1749 | Val MAE 1.8592
[P1] Ep 184: Loss 0.1782 | Val MAE 1.8974
[P1] Ep 185: Loss 0.1695 | Val MAE 1.9462
[P1] Ep 186: Loss 0.1708 | Val MAE 1.8366
[P1] Ep 187: Loss 0.1713 | Val MAE 1.8406
[P1] Ep 188: Loss 0.1713 | Val MAE 1.9279
[P1] Ep 189: Loss 0.1642 | Val MAE 1.9421
[P1] Ep 190: Loss 0.1628 | Val MAE 2.0707
[P1] Ep 191: Loss 0.1669 | Val MAE 1.8665
[P1] Ep 192: Loss 0.1666 | Val MAE 1.9205
[P1] Ep 193: Loss 0.1594 | Val MAE 1.8072
[P1] Ep 194: Loss 0.1593 | Val MAE 1.7965
[P1] Ep 195: Loss 0.1613 | Val MAE 1.8998
[P1] Ep 196: Loss 0.1592 | Val MAE 1.8627
[P1] Ep 197: Loss 0.1553 | Val MAE 1.7658
[P1] Ep 198: Loss 0.1549 | Val MAE 1.9317
[P1] Ep 199: Loss 0.1582 | Val MAE 1.8495
[P1] Ep 200: Loss 0.1545 | Val MAE 1.8149

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 8.5754 | Val MAE 1.5700 CI 0.6023
[FT] Ep 2: Loss 7.7823 | Val MAE 1.5029 CI 0.5965
[FT] Ep 3: Loss 8.1884 | Val MAE 1.4410 CI 0.6023
[FT] Ep 4: Loss 7.4924 | Val MAE 1.3921 CI 0.6023
[FT] Ep 5: Loss 7.3307 | Val MAE 1.3557 CI 0.6491
[FT] Ep 6: Loss 6.6825 | Val MAE 1.3197 CI 0.6667
[FT] Ep 7: Loss 6.1397 | Val MAE 1.2922 CI 0.6608
[FT] Ep 8: Loss 5.7794 | Val MAE 1.2681 CI 0.6842
[FT] Ep 9: Loss 5.5881 | Val MAE 1.2472 CI 0.7076
[FT] Ep 10: Loss 5.4954 | Val MAE 1.2331 CI 0.7193
[FT] Ep 11: Loss 5.3105 | Val MAE 1.2240 CI 0.7310
[FT] Ep 12: Loss 5.1817 | Val MAE 1.2258 CI 0.7193
[FT] Ep 13: Loss 5.0085 | Val MAE 1.2281 CI 0.7193
[FT] Ep 14: Loss 5.0434 | Val MAE 1.2354 CI 0.7310
[FT] Ep 15: Loss 4.7717 | Val MAE 1.2458 CI 0.7251
[FT] Ep 16: Loss 4.3276 | Val MAE 1.2583 CI 0.7193
[FT] Ep 17: Loss 4.5533 | Val MAE 1.2637 CI 0.7193
[FT] Ep 18: Loss 4.4663 | Val MAE 1.2738 CI 0.7076
[FT] Ep 19: Loss 4.4736 | Val MAE 1.2792 CI 0.7018
[FT] Ep 20: Loss 4.4097 | Val MAE 1.2884 CI 0.6901
[FT] Ep 21: Loss 4.0186 | Val MAE 1.2999 CI 0.6901
[FT] Ep 22: Loss 4.3296 | Val MAE 1.3109 CI 0.6784
[FT] Ep 23: Loss 4.0654 | Val MAE 1.3256 CI 0.6784
[FT] Ep 24: Loss 4.2746 | Val MAE 1.3393 CI 0.6725
[FT] Ep 25: Loss 3.9331 | Val MAE 1.3470 CI 0.6725
[FT] Ep 26: Loss 4.0417 | Val MAE 1.3558 CI 0.6725
[FT] Ep 27: Loss 3.8898 | Val MAE 1.3567 CI 0.6784
[FT] Ep 28: Loss 3.9465 | Val MAE 1.3602 CI 0.6608
[FT] Ep 29: Loss 3.7367 | Val MAE 1.3579 CI 0.6550
[FT] Ep 30: Loss 3.4742 | Val MAE 1.3627 CI 0.6433
[FT] Ep 31: Loss 3.3977 | Val MAE 1.3677 CI 0.6491
[FT] Ep 32: Loss 3.3209 | Val MAE 1.3776 CI 0.6433
[FT] Ep 33: Loss 3.3237 | Val MAE 1.3857 CI 0.6257
[FT] Ep 34: Loss 3.2864 | Val MAE 1.3949 CI 0.6374
[FT] Ep 35: Loss 3.4504 | Val MAE 1.3988 CI 0.6433
[FT] Ep 36: Loss 3.2859 | Val MAE 1.4049 CI 0.6374
[FT] Ep 37: Loss 3.4269 | Val MAE 1.4071 CI 0.6316
[FT] Ep 38: Loss 2.9650 | Val MAE 1.4139 CI 0.6316
[FT] Ep 39: Loss 3.1454 | Val MAE 1.4211 CI 0.6140
[FT] Ep 40: Loss 2.8415 | Val MAE 1.4279 CI 0.6140
[FT] Ep 41: Loss 2.9212 | Val MAE 1.4320 CI 0.6140
[FT] Ep 42: Loss 2.9057 | Val MAE 1.4324 CI 0.6082
[FT] Ep 43: Loss 2.9873 | Val MAE 1.4322 CI 0.5965
[FT] Ep 44: Loss 2.7901 | Val MAE 1.4299 CI 0.5789
[FT] Ep 45: Loss 2.8360 | Val MAE 1.4268 CI 0.5789
[FT] Ep 46: Loss 2.5644 | Val MAE 1.4284 CI 0.5789
[FT] Ep 47: Loss 2.5859 | Val MAE 1.4334 CI 0.5789
[FT] Ep 48: Loss 2.6588 | Val MAE 1.4441 CI 0.5789
[FT] Ep 49: Loss 2.5382 | Val MAE 1.4473 CI 0.5789
[FT] Ep 50: Loss 2.3459 | Val MAE 1.4513 CI 0.5789
[FT] Ep 51: Loss 2.5055 | Val MAE 1.4579 CI 0.5848
[FT] Ep 52: Loss 2.5045 | Val MAE 1.4574 CI 0.5731
[FT] Ep 53: Loss 2.3407 | Val MAE 1.4588 CI 0.5789
[FT] Ep 54: Loss 2.2884 | Val MAE 1.4625 CI 0.5789
[FT] Ep 55: Loss 2.4064 | Val MAE 1.4694 CI 0.5731
[FT] Ep 56: Loss 2.1431 | Val MAE 1.4733 CI 0.5731
[FT] Ep 57: Loss 2.2302 | Val MAE 1.4744 CI 0.5731
[FT] Ep 58: Loss 2.1869 | Val MAE 1.4780 CI 0.5789
[FT] Ep 59: Loss 2.1972 | Val MAE 1.4817 CI 0.5789
[FT] Ep 60: Loss 2.1512 | Val MAE 1.4848 CI 0.5789
[FT] Ep 61: Loss 2.1924 | Val MAE 1.4852 CI 0.5789
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: Soft Random
   MAE:  1.3982
   RMSE: 1.7040
   CI:   0.5895
   RM2:  0.0756
   MAPE: 23.93 %
   Acc:  25.00 %
------------------------------------------------------------
