--- DTA Baseline: epsilon-greedy (Ratio: 0.8) ---

>>> [Stage 0] Sampling...

[Sampler] Running epsilon-greedy | Target: 19964/24956 (80.0%)
Scanning Source (epsilon-greedy):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (epsilon-greedy):   4%|▍         | 1/25 [00:03<01:16,  3.17s/it]Scanning Source (epsilon-greedy):   8%|▊         | 2/25 [00:03<00:34,  1.52s/it]Scanning Source (epsilon-greedy):  12%|█▏        | 3/25 [00:03<00:21,  1.02it/s]Scanning Source (epsilon-greedy):  16%|█▌        | 4/25 [00:04<00:15,  1.35it/s]Scanning Source (epsilon-greedy):  20%|██        | 5/25 [00:05<00:15,  1.29it/s]Scanning Source (epsilon-greedy):  24%|██▍       | 6/25 [00:05<00:12,  1.58it/s]Scanning Source (epsilon-greedy):  28%|██▊       | 7/25 [00:05<00:09,  1.86it/s]Scanning Source (epsilon-greedy):  32%|███▏      | 8/25 [00:06<00:08,  2.09it/s]Scanning Source (epsilon-greedy):  36%|███▌      | 9/25 [00:06<00:09,  1.69it/s]Scanning Source (epsilon-greedy):  40%|████      | 10/25 [00:07<00:07,  1.92it/s]Scanning Source (epsilon-greedy):  44%|████▍     | 11/25 [00:07<00:06,  2.15it/s]Scanning Source (epsilon-greedy):  48%|████▊     | 12/25 [00:08<00:05,  2.30it/s]Scanning Source (epsilon-greedy):  52%|█████▏    | 13/25 [00:09<00:07,  1.58it/s]Scanning Source (epsilon-greedy):  56%|█████▌    | 14/25 [00:09<00:06,  1.67it/s]Scanning Source (epsilon-greedy):  60%|██████    | 15/25 [00:09<00:05,  1.92it/s]Scanning Source (epsilon-greedy):  64%|██████▍   | 16/25 [00:10<00:04,  2.14it/s]Scanning Source (epsilon-greedy):  68%|██████▊   | 17/25 [00:11<00:04,  1.68it/s]Scanning Source (epsilon-greedy):  72%|███████▏  | 18/25 [00:11<00:03,  1.92it/s]Scanning Source (epsilon-greedy):  76%|███████▌  | 19/25 [00:11<00:02,  2.13it/s]Scanning Source (epsilon-greedy):  80%|████████  | 20/25 [00:12<00:02,  2.33it/s]Scanning Source (epsilon-greedy):  84%|████████▍ | 21/25 [00:13<00:02,  1.88it/s]Scanning Source (epsilon-greedy):  88%|████████▊ | 22/25 [00:13<00:01,  2.10it/s]Scanning Source (epsilon-greedy):  92%|█████████▏| 23/25 [00:13<00:00,  2.30it/s]Scanning Source (epsilon-greedy):  96%|█████████▌| 24/25 [00:14<00:00,  2.45it/s]Scanning Source (epsilon-greedy): 100%|██████████| 25/25 [00:14<00:00,  3.09it/s]                                                                                 -> Source reduced: 24956 -> 19964

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 1.5272 | Val MAE 1.7340
[P1] Ep 2: Loss 0.9490 | Val MAE 1.9348
[P1] Ep 3: Loss 0.8721 | Val MAE 1.9011
[P1] Ep 4: Loss 0.8438 | Val MAE 2.0128
[P1] Ep 5: Loss 0.8179 | Val MAE 1.8745
[P1] Ep 6: Loss 0.8055 | Val MAE 1.8839
[P1] Ep 7: Loss 0.7594 | Val MAE 1.7576
[P1] Ep 8: Loss 0.7364 | Val MAE 1.8383
[P1] Ep 9: Loss 0.7351 | Val MAE 1.9237
[P1] Ep 10: Loss 0.7265 | Val MAE 1.9621
[P1] Ep 11: Loss 0.7106 | Val MAE 1.8304
[P1] Ep 12: Loss 0.7073 | Val MAE 1.8532
[P1] Ep 13: Loss 0.6980 | Val MAE 1.7631
[P1] Ep 14: Loss 0.6930 | Val MAE 1.9055
[P1] Ep 15: Loss 0.6950 | Val MAE 1.9424
[P1] Ep 16: Loss 0.6759 | Val MAE 1.8763
[P1] Ep 17: Loss 0.6878 | Val MAE 1.9774
[P1] Ep 18: Loss 0.6640 | Val MAE 1.8200
[P1] Ep 19: Loss 0.6708 | Val MAE 1.9400
[P1] Ep 20: Loss 0.6704 | Val MAE 1.9719
[P1] Ep 21: Loss 0.6555 | Val MAE 1.8518
[P1] Ep 22: Loss 0.6572 | Val MAE 1.8308
[P1] Ep 23: Loss 0.6480 | Val MAE 1.9637
[P1] Ep 24: Loss 0.6479 | Val MAE 1.9235
[P1] Ep 25: Loss 0.6425 | Val MAE 1.9624
[P1] Ep 26: Loss 0.6447 | Val MAE 1.8557
[P1] Ep 27: Loss 0.6289 | Val MAE 1.8184
[P1] Ep 28: Loss 0.6367 | Val MAE 1.9708
[P1] Ep 29: Loss 0.6234 | Val MAE 1.8843
[P1] Ep 30: Loss 0.6152 | Val MAE 2.0026
[P1] Ep 31: Loss 0.6207 | Val MAE 1.8853
[P1] Ep 32: Loss 0.6120 | Val MAE 1.8578
[P1] Ep 33: Loss 0.6132 | Val MAE 1.9964
[P1] Ep 34: Loss 0.5977 | Val MAE 2.0219
[P1] Ep 35: Loss 0.5770 | Val MAE 1.9690
[P1] Ep 36: Loss 0.5853 | Val MAE 2.0104
[P1] Ep 37: Loss 0.5701 | Val MAE 1.9291
[P1] Ep 38: Loss 0.5635 | Val MAE 1.9659
[P1] Ep 39: Loss 0.5548 | Val MAE 2.0681
[P1] Ep 40: Loss 0.5602 | Val MAE 1.9473
[P1] Ep 41: Loss 0.5499 | Val MAE 1.8773
[P1] Ep 42: Loss 0.5509 | Val MAE 1.8288
[P1] Ep 43: Loss 0.5406 | Val MAE 1.8680
[P1] Ep 44: Loss 0.5302 | Val MAE 1.7901
[P1] Ep 45: Loss 0.5338 | Val MAE 1.8521
[P1] Ep 46: Loss 0.5234 | Val MAE 1.8685
[P1] Ep 47: Loss 0.5141 | Val MAE 1.9454
[P1] Ep 48: Loss 0.5131 | Val MAE 1.7669
[P1] Ep 49: Loss 0.5119 | Val MAE 1.7935
[P1] Ep 50: Loss 0.5083 | Val MAE 1.7506
[P1] Ep 51: Loss 0.5120 | Val MAE 1.8156
[P1] Ep 52: Loss 0.4970 | Val MAE 1.9694
[P1] Ep 53: Loss 0.4927 | Val MAE 1.7660
[P1] Ep 54: Loss 0.4864 | Val MAE 1.9772
[P1] Ep 55: Loss 0.4902 | Val MAE 1.8676
[P1] Ep 56: Loss 0.4772 | Val MAE 1.8392
[P1] Ep 57: Loss 0.4787 | Val MAE 1.7912
[P1] Ep 58: Loss 0.4755 | Val MAE 1.8300
[P1] Ep 59: Loss 0.4677 | Val MAE 1.7847
[P1] Ep 60: Loss 0.4685 | Val MAE 1.7745
[P1] Ep 61: Loss 0.4576 | Val MAE 1.8934
[P1] Ep 62: Loss 0.4535 | Val MAE 1.7650
[P1] Ep 63: Loss 0.4510 | Val MAE 1.7877
[P1] Ep 64: Loss 0.4482 | Val MAE 1.7845
[P1] Ep 65: Loss 0.4524 | Val MAE 1.7685
[P1] Ep 66: Loss 0.4430 | Val MAE 1.9012
[P1] Ep 67: Loss 0.4438 | Val MAE 1.7872
[P1] Ep 68: Loss 0.4300 | Val MAE 1.7231
[P1] Ep 69: Loss 0.4345 | Val MAE 1.7048
[P1] Ep 70: Loss 0.4176 | Val MAE 1.8082
[P1] Ep 71: Loss 0.4229 | Val MAE 1.7712
[P1] Ep 72: Loss 0.4171 | Val MAE 1.8454
[P1] Ep 73: Loss 0.4117 | Val MAE 1.8097
[P1] Ep 74: Loss 0.4128 | Val MAE 1.7521
[P1] Ep 75: Loss 0.4078 | Val MAE 1.7593
[P1] Ep 76: Loss 0.4060 | Val MAE 1.7762
[P1] Ep 77: Loss 0.4071 | Val MAE 1.7303
[P1] Ep 78: Loss 0.3982 | Val MAE 1.7462
[P1] Ep 79: Loss 0.4039 | Val MAE 1.7385
[P1] Ep 80: Loss 0.3935 | Val MAE 1.9652
[P1] Ep 81: Loss 0.3863 | Val MAE 1.7908
[P1] Ep 82: Loss 0.3860 | Val MAE 1.7893
[P1] Ep 83: Loss 0.3830 | Val MAE 1.9132
[P1] Ep 84: Loss 0.3771 | Val MAE 1.7546
[P1] Ep 85: Loss 0.3737 | Val MAE 1.8330
[P1] Ep 86: Loss 0.3692 | Val MAE 1.9457
[P1] Ep 87: Loss 0.3707 | Val MAE 1.8556
[P1] Ep 88: Loss 0.3655 | Val MAE 1.7522
[P1] Ep 89: Loss 0.3603 | Val MAE 1.9193
[P1] Ep 90: Loss 0.3571 | Val MAE 1.7324
[P1] Ep 91: Loss 0.3570 | Val MAE 1.8202
[P1] Ep 92: Loss 0.3538 | Val MAE 1.7590
[P1] Ep 93: Loss 0.3438 | Val MAE 1.7848
[P1] Ep 94: Loss 0.3454 | Val MAE 1.7406
[P1] Ep 95: Loss 0.3489 | Val MAE 1.7047
[P1] Ep 96: Loss 0.3365 | Val MAE 1.7705
[P1] Ep 97: Loss 0.3333 | Val MAE 1.7020
[P1] Ep 98: Loss 0.3325 | Val MAE 1.7501
[P1] Ep 99: Loss 0.3349 | Val MAE 1.7668
[P1] Ep 100: Loss 0.3227 | Val MAE 1.8270
[P1] Ep 101: Loss 0.3250 | Val MAE 1.7933
[P1] Ep 102: Loss 0.3191 | Val MAE 1.7838
[P1] Ep 103: Loss 0.3200 | Val MAE 1.6962
[P1] Ep 104: Loss 0.3190 | Val MAE 1.6887
[P1] Ep 105: Loss 0.3142 | Val MAE 1.6245
[P1] Ep 106: Loss 0.3092 | Val MAE 1.6501
[P1] Ep 107: Loss 0.3072 | Val MAE 1.7333
[P1] Ep 108: Loss 0.3047 | Val MAE 1.6403
[P1] Ep 109: Loss 0.2982 | Val MAE 1.6107
[P1] Ep 110: Loss 0.3009 | Val MAE 1.7084
[P1] Ep 111: Loss 0.2983 | Val MAE 1.6541
[P1] Ep 112: Loss 0.2939 | Val MAE 1.6425
[P1] Ep 113: Loss 0.2910 | Val MAE 1.7016
[P1] Ep 114: Loss 0.2864 | Val MAE 1.6974
[P1] Ep 115: Loss 0.2867 | Val MAE 1.6616
[P1] Ep 116: Loss 0.2830 | Val MAE 1.6439
[P1] Ep 117: Loss 0.2780 | Val MAE 1.7128
[P1] Ep 118: Loss 0.2745 | Val MAE 1.6561
[P1] Ep 119: Loss 0.2719 | Val MAE 1.6771
[P1] Ep 120: Loss 0.2702 | Val MAE 1.6298
[P1] Ep 121: Loss 0.2724 | Val MAE 1.6568
[P1] Ep 122: Loss 0.2696 | Val MAE 1.6140
[P1] Ep 123: Loss 0.2622 | Val MAE 1.7036
[P1] Ep 124: Loss 0.2637 | Val MAE 1.5556
[P1] Ep 125: Loss 0.2594 | Val MAE 1.6410
[P1] Ep 126: Loss 0.2560 | Val MAE 1.7471
[P1] Ep 127: Loss 0.2578 | Val MAE 1.7210
[P1] Ep 128: Loss 0.2482 | Val MAE 1.7413
[P1] Ep 129: Loss 0.2534 | Val MAE 1.5517
[P1] Ep 130: Loss 0.2506 | Val MAE 1.7439
[P1] Ep 131: Loss 0.2433 | Val MAE 1.6089
[P1] Ep 132: Loss 0.2430 | Val MAE 1.5497
[P1] Ep 133: Loss 0.2432 | Val MAE 1.6103
[P1] Ep 134: Loss 0.2385 | Val MAE 1.6138
[P1] Ep 135: Loss 0.2396 | Val MAE 1.5196
[P1] Ep 136: Loss 0.2385 | Val MAE 1.5578
[P1] Ep 137: Loss 0.2322 | Val MAE 1.6560
[P1] Ep 138: Loss 0.2345 | Val MAE 1.6441
[P1] Ep 139: Loss 0.2291 | Val MAE 1.5764
[P1] Ep 140: Loss 0.2315 | Val MAE 1.7121
[P1] Ep 141: Loss 0.2286 | Val MAE 1.5845
[P1] Ep 142: Loss 0.2254 | Val MAE 1.6359
[P1] Ep 143: Loss 0.2227 | Val MAE 1.6351
[P1] Ep 144: Loss 0.2171 | Val MAE 1.6595
[P1] Ep 145: Loss 0.2220 | Val MAE 1.6134
[P1] Ep 146: Loss 0.2191 | Val MAE 1.6235
[P1] Ep 147: Loss 0.2168 | Val MAE 1.5142
[P1] Ep 148: Loss 0.2197 | Val MAE 1.6616
[P1] Ep 149: Loss 0.2144 | Val MAE 1.6371
[P1] Ep 150: Loss 0.2122 | Val MAE 1.7129
[P1] Ep 151: Loss 0.2137 | Val MAE 1.6452
[P1] Ep 152: Loss 0.2091 | Val MAE 1.6734
[P1] Ep 153: Loss 0.2054 | Val MAE 1.5598
[P1] Ep 154: Loss 0.2054 | Val MAE 1.7270
[P1] Ep 155: Loss 0.2045 | Val MAE 1.6667
[P1] Ep 156: Loss 0.2055 | Val MAE 1.6113
[P1] Ep 157: Loss 0.2029 | Val MAE 1.5945
[P1] Ep 158: Loss 0.2036 | Val MAE 1.6256
[P1] Ep 159: Loss 0.2002 | Val MAE 1.6467
[P1] Ep 160: Loss 0.1913 | Val MAE 1.6887
[P1] Ep 161: Loss 0.1970 | Val MAE 1.6869
[P1] Ep 162: Loss 0.1960 | Val MAE 1.6988
[P1] Ep 163: Loss 0.1902 | Val MAE 1.7054
[P1] Ep 164: Loss 0.1929 | Val MAE 1.6624
[P1] Ep 165: Loss 0.1914 | Val MAE 1.6325
[P1] Ep 166: Loss 0.1927 | Val MAE 1.5547
[P1] Ep 167: Loss 0.1892 | Val MAE 1.7116
[P1] Ep 168: Loss 0.1858 | Val MAE 1.6133
[P1] Ep 169: Loss 0.1869 | Val MAE 1.6764
[P1] Ep 170: Loss 0.1833 | Val MAE 1.7164
[P1] Ep 171: Loss 0.1757 | Val MAE 1.7106
[P1] Ep 172: Loss 0.1845 | Val MAE 1.6532
[P1] Ep 173: Loss 0.1803 | Val MAE 1.7111
[P1] Ep 174: Loss 0.1744 | Val MAE 1.6290
[P1] Ep 175: Loss 0.1798 | Val MAE 1.5781
[P1] Ep 176: Loss 0.1734 | Val MAE 1.6576
[P1] Ep 177: Loss 0.1729 | Val MAE 1.7268
[P1] Ep 178: Loss 0.1709 | Val MAE 1.6436
[P1] Ep 179: Loss 0.1762 | Val MAE 1.7298
[P1] Ep 180: Loss 0.1680 | Val MAE 1.6388
[P1] Ep 181: Loss 0.1707 | Val MAE 1.6721
[P1] Ep 182: Loss 0.1677 | Val MAE 1.6711
[P1] Ep 183: Loss 0.1665 | Val MAE 1.7395
[P1] Ep 184: Loss 0.1622 | Val MAE 1.6294
[P1] Ep 185: Loss 0.1666 | Val MAE 1.6295
[P1] Ep 186: Loss 0.1647 | Val MAE 1.6304
[P1] Ep 187: Loss 0.1642 | Val MAE 1.6371
[P1] Ep 188: Loss 0.1610 | Val MAE 1.7075
[P1] Ep 189: Loss 0.1572 | Val MAE 1.7069
[P1] Ep 190: Loss 0.1604 | Val MAE 1.6739
[P1] Ep 191: Loss 0.1559 | Val MAE 1.6447
[P1] Ep 192: Loss 0.1590 | Val MAE 1.7535
[P1] Ep 193: Loss 0.1546 | Val MAE 1.6875
[P1] Ep 194: Loss 0.1553 | Val MAE 1.6803
[P1] Ep 195: Loss 0.1542 | Val MAE 1.7234
[P1] Ep 196: Loss 0.1521 | Val MAE 1.6678
[P1] Ep 197: Loss 0.1516 | Val MAE 1.7027
[P1] Ep 198: Loss 0.1494 | Val MAE 1.7241
[P1] Ep 199: Loss 0.1462 | Val MAE 1.6756
[P1] Ep 200: Loss 0.1483 | Val MAE 1.7896

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 7.7418 | Val MAE 1.4356 CI 0.6316
[FT] Ep 2: Loss 7.3420 | Val MAE 1.3613 CI 0.6667
[FT] Ep 3: Loss 6.9447 | Val MAE 1.2995 CI 0.6784
[FT] Ep 4: Loss 6.6117 | Val MAE 1.2546 CI 0.6959
[FT] Ep 5: Loss 6.5597 | Val MAE 1.2230 CI 0.6842
[FT] Ep 6: Loss 6.2171 | Val MAE 1.1966 CI 0.6901
[FT] Ep 7: Loss 5.9642 | Val MAE 1.1998 CI 0.6725
[FT] Ep 8: Loss 5.9757 | Val MAE 1.2194 CI 0.6725
[FT] Ep 9: Loss 5.4536 | Val MAE 1.2370 CI 0.6842
[FT] Ep 10: Loss 5.3215 | Val MAE 1.2517 CI 0.6725
[FT] Ep 11: Loss 4.9998 | Val MAE 1.2714 CI 0.6667
[FT] Ep 12: Loss 4.9339 | Val MAE 1.2966 CI 0.6550
[FT] Ep 13: Loss 4.8118 | Val MAE 1.3174 CI 0.6608
[FT] Ep 14: Loss 4.6731 | Val MAE 1.3385 CI 0.6550
[FT] Ep 15: Loss 4.9351 | Val MAE 1.3579 CI 0.6608
[FT] Ep 16: Loss 4.6183 | Val MAE 1.3730 CI 0.6667
[FT] Ep 17: Loss 4.3587 | Val MAE 1.3894 CI 0.6725
[FT] Ep 18: Loss 4.1786 | Val MAE 1.4100 CI 0.6550
[FT] Ep 19: Loss 4.4485 | Val MAE 1.4261 CI 0.6491
[FT] Ep 20: Loss 4.3716 | Val MAE 1.4369 CI 0.6550
[FT] Ep 21: Loss 4.0104 | Val MAE 1.4461 CI 0.6491
[FT] Ep 22: Loss 3.9071 | Val MAE 1.4522 CI 0.6374
[FT] Ep 23: Loss 3.9931 | Val MAE 1.4618 CI 0.6316
[FT] Ep 24: Loss 3.9427 | Val MAE 1.4717 CI 0.6199
[FT] Ep 25: Loss 3.6067 | Val MAE 1.4755 CI 0.6140
[FT] Ep 26: Loss 3.7363 | Val MAE 1.4837 CI 0.6140
[FT] Ep 27: Loss 3.5538 | Val MAE 1.4872 CI 0.6140
[FT] Ep 28: Loss 3.3806 | Val MAE 1.4894 CI 0.6140
[FT] Ep 29: Loss 3.6561 | Val MAE 1.4949 CI 0.6140
[FT] Ep 30: Loss 3.3900 | Val MAE 1.5023 CI 0.6140
[FT] Ep 31: Loss 3.2754 | Val MAE 1.5078 CI 0.6023
[FT] Ep 32: Loss 3.2849 | Val MAE 1.5152 CI 0.6140
[FT] Ep 33: Loss 3.1931 | Val MAE 1.5222 CI 0.6023
[FT] Ep 34: Loss 3.1504 | Val MAE 1.5279 CI 0.5906
[FT] Ep 35: Loss 2.9664 | Val MAE 1.5400 CI 0.5906
[FT] Ep 36: Loss 3.0551 | Val MAE 1.5495 CI 0.5848
[FT] Ep 37: Loss 2.8951 | Val MAE 1.5555 CI 0.5848
[FT] Ep 38: Loss 3.0958 | Val MAE 1.5573 CI 0.5789
[FT] Ep 39: Loss 3.1549 | Val MAE 1.5638 CI 0.5906
[FT] Ep 40: Loss 2.9436 | Val MAE 1.5696 CI 0.5848
[FT] Ep 41: Loss 2.7064 | Val MAE 1.5693 CI 0.5906
[FT] Ep 42: Loss 2.8176 | Val MAE 1.5691 CI 0.6023
[FT] Ep 43: Loss 2.9514 | Val MAE 1.5679 CI 0.6023
[FT] Ep 44: Loss 2.4493 | Val MAE 1.5699 CI 0.6023
[FT] Ep 45: Loss 2.5458 | Val MAE 1.5686 CI 0.6140
[FT] Ep 46: Loss 2.3623 | Val MAE 1.5675 CI 0.6082
[FT] Ep 47: Loss 2.5185 | Val MAE 1.5665 CI 0.6023
[FT] Ep 48: Loss 2.4205 | Val MAE 1.5707 CI 0.6023
[FT] Ep 49: Loss 2.3492 | Val MAE 1.5757 CI 0.5965
[FT] Ep 50: Loss 2.3541 | Val MAE 1.5797 CI 0.5965
[FT] Ep 51: Loss 2.2197 | Val MAE 1.5775 CI 0.5965
[FT] Ep 52: Loss 2.0627 | Val MAE 1.5677 CI 0.6023
[FT] Ep 53: Loss 2.2241 | Val MAE 1.5620 CI 0.6023
[FT] Ep 54: Loss 2.2085 | Val MAE 1.5556 CI 0.6023
[FT] Ep 55: Loss 2.2596 | Val MAE 1.5512 CI 0.6023
[FT] Ep 56: Loss 2.1748 | Val MAE 1.5555 CI 0.5965
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: epsilon-greedy
   MAE:  1.4387
   RMSE: 1.8522
   CI:   0.5000
   RM2:  0.0012
   MAPE: 23.66 %
   Acc:  35.00 %
------------------------------------------------------------
