--- DTA Baseline: MolPeg (Ratio: 0.8) ---

>>> [Stage 0] Sampling...

[Sampler] Running MolPeg | Target: 19964/24956 (80.0%)
Scanning Source (MolPeg):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (MolPeg):   4%|▍         | 1/25 [00:03<01:21,  3.41s/it]Scanning Source (MolPeg):   8%|▊         | 2/25 [00:03<00:36,  1.60s/it]Scanning Source (MolPeg):  12%|█▏        | 3/25 [00:04<00:22,  1.03s/it]Scanning Source (MolPeg):  16%|█▌        | 4/25 [00:04<00:15,  1.32it/s]Scanning Source (MolPeg):  20%|██        | 5/25 [00:04<00:13,  1.46it/s]Scanning Source (MolPeg):  24%|██▍       | 6/25 [00:05<00:10,  1.76it/s]Scanning Source (MolPeg):  28%|██▊       | 7/25 [00:05<00:08,  2.04it/s]Scanning Source (MolPeg):  32%|███▏      | 8/25 [00:06<00:07,  2.25it/s]Scanning Source (MolPeg):  36%|███▌      | 9/25 [00:07<00:12,  1.33it/s]Scanning Source (MolPeg):  40%|████      | 10/25 [00:07<00:09,  1.61it/s]Scanning Source (MolPeg):  44%|████▍     | 11/25 [00:08<00:07,  1.86it/s]Scanning Source (MolPeg):  48%|████▊     | 12/25 [00:08<00:06,  2.12it/s]Scanning Source (MolPeg):  52%|█████▏    | 13/25 [00:09<00:08,  1.35it/s]Scanning Source (MolPeg):  56%|█████▌    | 14/25 [00:10<00:06,  1.61it/s]Scanning Source (MolPeg):  60%|██████    | 15/25 [00:10<00:05,  1.88it/s]Scanning Source (MolPeg):  64%|██████▍   | 16/25 [00:10<00:04,  2.11it/s]Scanning Source (MolPeg):  68%|██████▊   | 17/25 [00:12<00:05,  1.39it/s]Scanning Source (MolPeg):  72%|███████▏  | 18/25 [00:12<00:04,  1.67it/s]Scanning Source (MolPeg):  76%|███████▌  | 19/25 [00:12<00:03,  1.93it/s]Scanning Source (MolPeg):  80%|████████  | 20/25 [00:13<00:02,  2.14it/s]Scanning Source (MolPeg):  84%|████████▍ | 21/25 [00:14<00:02,  1.43it/s]Scanning Source (MolPeg):  88%|████████▊ | 22/25 [00:14<00:01,  1.70it/s]Scanning Source (MolPeg):  92%|█████████▏| 23/25 [00:14<00:01,  1.97it/s]Scanning Source (MolPeg):  96%|█████████▌| 24/25 [00:15<00:00,  2.20it/s]Scanning Source (MolPeg): 100%|██████████| 25/25 [00:15<00:00,  2.81it/s]                                                                         -> Source reduced: 24956 -> 19964

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 1.5170 | Val MAE 1.7968
[P1] Ep 2: Loss 0.9081 | Val MAE 1.9623
[P1] Ep 3: Loss 0.8318 | Val MAE 1.8392
[P1] Ep 4: Loss 0.8013 | Val MAE 1.8663
[P1] Ep 5: Loss 0.7707 | Val MAE 1.8344
[P1] Ep 6: Loss 0.7460 | Val MAE 1.8392
[P1] Ep 7: Loss 0.7025 | Val MAE 1.8032
[P1] Ep 8: Loss 0.6764 | Val MAE 1.8443
[P1] Ep 9: Loss 0.6730 | Val MAE 1.9272
[P1] Ep 10: Loss 0.6558 | Val MAE 1.9175
[P1] Ep 11: Loss 0.6508 | Val MAE 1.8656
[P1] Ep 12: Loss 0.6410 | Val MAE 1.9680
[P1] Ep 13: Loss 0.6349 | Val MAE 1.7672
[P1] Ep 14: Loss 0.6359 | Val MAE 1.9194
[P1] Ep 15: Loss 0.6181 | Val MAE 1.8902
[P1] Ep 16: Loss 0.6214 | Val MAE 1.8899
[P1] Ep 17: Loss 0.6062 | Val MAE 1.8508
[P1] Ep 18: Loss 0.6058 | Val MAE 1.8245
[P1] Ep 19: Loss 0.6065 | Val MAE 1.8240
[P1] Ep 20: Loss 0.5963 | Val MAE 1.8446
[P1] Ep 21: Loss 0.5864 | Val MAE 1.8746
[P1] Ep 22: Loss 0.5924 | Val MAE 1.8038
[P1] Ep 23: Loss 0.5841 | Val MAE 1.8800
[P1] Ep 24: Loss 0.5831 | Val MAE 1.7679
[P1] Ep 25: Loss 0.5683 | Val MAE 1.7851
[P1] Ep 26: Loss 0.5733 | Val MAE 1.7089
[P1] Ep 27: Loss 0.5649 | Val MAE 1.6817
[P1] Ep 28: Loss 0.5670 | Val MAE 1.7499
[P1] Ep 29: Loss 0.5597 | Val MAE 1.7337
[P1] Ep 30: Loss 0.5563 | Val MAE 1.8053
[P1] Ep 31: Loss 0.5433 | Val MAE 1.6084
[P1] Ep 32: Loss 0.5428 | Val MAE 1.6493
[P1] Ep 33: Loss 0.5400 | Val MAE 1.7070
[P1] Ep 34: Loss 0.5390 | Val MAE 1.6965
[P1] Ep 35: Loss 0.5300 | Val MAE 1.7236
[P1] Ep 36: Loss 0.5340 | Val MAE 1.7646
[P1] Ep 37: Loss 0.5261 | Val MAE 1.8240
[P1] Ep 38: Loss 0.5230 | Val MAE 1.7621
[P1] Ep 39: Loss 0.5222 | Val MAE 1.7053
[P1] Ep 40: Loss 0.5206 | Val MAE 1.8025
[P1] Ep 41: Loss 0.5051 | Val MAE 1.8077
[P1] Ep 42: Loss 0.5128 | Val MAE 1.8423
[P1] Ep 43: Loss 0.5032 | Val MAE 1.7720
[P1] Ep 44: Loss 0.5010 | Val MAE 1.7586
[P1] Ep 45: Loss 0.4909 | Val MAE 1.6537
[P1] Ep 46: Loss 0.4971 | Val MAE 1.7393
[P1] Ep 47: Loss 0.4936 | Val MAE 1.8686
[P1] Ep 48: Loss 0.4923 | Val MAE 1.6820
[P1] Ep 49: Loss 0.4816 | Val MAE 1.6910
[P1] Ep 50: Loss 0.4803 | Val MAE 1.6855
[P1] Ep 51: Loss 0.4717 | Val MAE 1.5939
[P1] Ep 52: Loss 0.4785 | Val MAE 1.6060
[P1] Ep 53: Loss 0.4651 | Val MAE 1.7431
[P1] Ep 54: Loss 0.4670 | Val MAE 1.6521
[P1] Ep 55: Loss 0.4630 | Val MAE 1.7531
[P1] Ep 56: Loss 0.4536 | Val MAE 1.6111
[P1] Ep 57: Loss 0.4458 | Val MAE 1.6500
[P1] Ep 58: Loss 0.4403 | Val MAE 1.7616
[P1] Ep 59: Loss 0.4383 | Val MAE 1.6322
[P1] Ep 60: Loss 0.4416 | Val MAE 1.6297
[P1] Ep 61: Loss 0.4353 | Val MAE 1.6864
[P1] Ep 62: Loss 0.4306 | Val MAE 1.6186
[P1] Ep 63: Loss 0.4256 | Val MAE 1.5922
[P1] Ep 64: Loss 0.4260 | Val MAE 1.7097
[P1] Ep 65: Loss 0.4213 | Val MAE 1.6480
[P1] Ep 66: Loss 0.4199 | Val MAE 1.6822
[P1] Ep 67: Loss 0.4094 | Val MAE 1.6773
[P1] Ep 68: Loss 0.4111 | Val MAE 1.6559
[P1] Ep 69: Loss 0.4133 | Val MAE 1.6684
[P1] Ep 70: Loss 0.4034 | Val MAE 1.6775
[P1] Ep 71: Loss 0.4055 | Val MAE 1.7161
[P1] Ep 72: Loss 0.3940 | Val MAE 1.7128
[P1] Ep 73: Loss 0.3922 | Val MAE 1.6788
[P1] Ep 74: Loss 0.3954 | Val MAE 1.6500
[P1] Ep 75: Loss 0.3912 | Val MAE 1.6241
[P1] Ep 76: Loss 0.3888 | Val MAE 1.6027
[P1] Ep 77: Loss 0.3801 | Val MAE 1.5449
[P1] Ep 78: Loss 0.3786 | Val MAE 1.6295
[P1] Ep 79: Loss 0.3727 | Val MAE 1.6694
[P1] Ep 80: Loss 0.3737 | Val MAE 1.6530
[P1] Ep 81: Loss 0.3679 | Val MAE 1.6521
[P1] Ep 82: Loss 0.3629 | Val MAE 1.6475
[P1] Ep 83: Loss 0.3604 | Val MAE 1.6362
[P1] Ep 84: Loss 0.3555 | Val MAE 1.6821
[P1] Ep 85: Loss 0.3573 | Val MAE 1.6014
[P1] Ep 86: Loss 0.3536 | Val MAE 1.6385
[P1] Ep 87: Loss 0.3526 | Val MAE 1.5619
[P1] Ep 88: Loss 0.3507 | Val MAE 1.6803
[P1] Ep 89: Loss 0.3441 | Val MAE 1.7527
[P1] Ep 90: Loss 0.3411 | Val MAE 1.6611
[P1] Ep 91: Loss 0.3388 | Val MAE 1.5548
[P1] Ep 92: Loss 0.3421 | Val MAE 1.6662
[P1] Ep 93: Loss 0.3315 | Val MAE 1.7196
[P1] Ep 94: Loss 0.3310 | Val MAE 1.6494
[P1] Ep 95: Loss 0.3305 | Val MAE 1.8245
[P1] Ep 96: Loss 0.3268 | Val MAE 1.7895
[P1] Ep 97: Loss 0.3295 | Val MAE 1.8238
[P1] Ep 98: Loss 0.3262 | Val MAE 1.6558
[P1] Ep 99: Loss 0.3197 | Val MAE 1.6533
[P1] Ep 100: Loss 0.3170 | Val MAE 1.7447
[P1] Ep 101: Loss 0.3194 | Val MAE 1.6791
[P1] Ep 102: Loss 0.3103 | Val MAE 1.7868
[P1] Ep 103: Loss 0.3059 | Val MAE 1.8459
[P1] Ep 104: Loss 0.3056 | Val MAE 1.6814
[P1] Ep 105: Loss 0.3094 | Val MAE 1.7926
[P1] Ep 106: Loss 0.3027 | Val MAE 1.7969
[P1] Ep 107: Loss 0.2984 | Val MAE 1.8087
[P1] Ep 108: Loss 0.3022 | Val MAE 1.8023
[P1] Ep 109: Loss 0.2929 | Val MAE 1.7280
[P1] Ep 110: Loss 0.2921 | Val MAE 1.7134
[P1] Ep 111: Loss 0.2872 | Val MAE 1.7383
[P1] Ep 112: Loss 0.2828 | Val MAE 1.7183
[P1] Ep 113: Loss 0.2797 | Val MAE 1.7469
[P1] Ep 114: Loss 0.2839 | Val MAE 1.7345
[P1] Ep 115: Loss 0.2764 | Val MAE 1.7565
[P1] Ep 116: Loss 0.2756 | Val MAE 1.7036
[P1] Ep 117: Loss 0.2732 | Val MAE 1.7806
[P1] Ep 118: Loss 0.2683 | Val MAE 1.8266
[P1] Ep 119: Loss 0.2698 | Val MAE 1.7360
[P1] Ep 120: Loss 0.2682 | Val MAE 1.8340
[P1] Ep 121: Loss 0.2632 | Val MAE 1.9083
[P1] Ep 122: Loss 0.2624 | Val MAE 1.9025
[P1] Ep 123: Loss 0.2585 | Val MAE 2.0307
[P1] Ep 124: Loss 0.2584 | Val MAE 1.9806
[P1] Ep 125: Loss 0.2535 | Val MAE 1.8941
[P1] Ep 126: Loss 0.2514 | Val MAE 1.8095
[P1] Ep 127: Loss 0.2468 | Val MAE 1.8310
[P1] Ep 128: Loss 0.2490 | Val MAE 1.7598
[P1] Ep 129: Loss 0.2427 | Val MAE 1.6444
[P1] Ep 130: Loss 0.2437 | Val MAE 1.9116
[P1] Ep 131: Loss 0.2418 | Val MAE 1.8081
[P1] Ep 132: Loss 0.2313 | Val MAE 1.7350
[P1] Ep 133: Loss 0.2344 | Val MAE 1.8268
[P1] Ep 134: Loss 0.2310 | Val MAE 1.5768
[P1] Ep 135: Loss 0.2276 | Val MAE 1.6359
[P1] Ep 136: Loss 0.2283 | Val MAE 1.6976
[P1] Ep 137: Loss 0.2271 | Val MAE 1.7500
[P1] Ep 138: Loss 0.2335 | Val MAE 1.6711
[P1] Ep 139: Loss 0.2210 | Val MAE 1.6879
[P1] Ep 140: Loss 0.2247 | Val MAE 1.7308
[P1] Ep 141: Loss 0.2200 | Val MAE 1.7827
[P1] Ep 142: Loss 0.2180 | Val MAE 1.6196
[P1] Ep 143: Loss 0.2163 | Val MAE 1.6152
[P1] Ep 144: Loss 0.2219 | Val MAE 1.7959
[P1] Ep 145: Loss 0.2147 | Val MAE 1.7000
[P1] Ep 146: Loss 0.2123 | Val MAE 1.5906
[P1] Ep 147: Loss 0.2100 | Val MAE 1.7125
[P1] Ep 148: Loss 0.2128 | Val MAE 1.6313
[P1] Ep 149: Loss 0.2077 | Val MAE 1.5980
[P1] Ep 150: Loss 0.2101 | Val MAE 1.6622
[P1] Ep 151: Loss 0.2088 | Val MAE 1.7447
[P1] Ep 152: Loss 0.2042 | Val MAE 1.7432
[P1] Ep 153: Loss 0.2006 | Val MAE 1.6411
[P1] Ep 154: Loss 0.2000 | Val MAE 1.8843
[P1] Ep 155: Loss 0.1992 | Val MAE 1.6952
[P1] Ep 156: Loss 0.1982 | Val MAE 1.6361
[P1] Ep 157: Loss 0.1992 | Val MAE 1.6432
[P1] Ep 158: Loss 0.1979 | Val MAE 1.7335
[P1] Ep 159: Loss 0.1999 | Val MAE 1.7724
[P1] Ep 160: Loss 0.1953 | Val MAE 1.6679
[P1] Ep 161: Loss 0.1921 | Val MAE 1.5796
[P1] Ep 162: Loss 0.1942 | Val MAE 1.6626
[P1] Ep 163: Loss 0.1956 | Val MAE 1.6976
[P1] Ep 164: Loss 0.1841 | Val MAE 1.5933
[P1] Ep 165: Loss 0.1871 | Val MAE 1.5628
[P1] Ep 166: Loss 0.1879 | Val MAE 1.5277
[P1] Ep 167: Loss 0.1850 | Val MAE 1.6465
[P1] Ep 168: Loss 0.1851 | Val MAE 1.6437
[P1] Ep 169: Loss 0.1847 | Val MAE 1.4753
[P1] Ep 170: Loss 0.1894 | Val MAE 1.4986
[P1] Ep 171: Loss 0.1857 | Val MAE 1.5851
[P1] Ep 172: Loss 0.1776 | Val MAE 1.5119
[P1] Ep 173: Loss 0.1820 | Val MAE 1.5927
[P1] Ep 174: Loss 0.1779 | Val MAE 1.5999
[P1] Ep 175: Loss 0.1800 | Val MAE 1.5655
[P1] Ep 176: Loss 0.1774 | Val MAE 1.6254
[P1] Ep 177: Loss 0.1756 | Val MAE 1.5560
[P1] Ep 178: Loss 0.1717 | Val MAE 1.5676
[P1] Ep 179: Loss 0.1764 | Val MAE 1.5332
[P1] Ep 180: Loss 0.1774 | Val MAE 1.6014
[P1] Ep 181: Loss 0.1724 | Val MAE 1.5555
[P1] Ep 182: Loss 0.1711 | Val MAE 1.5034
[P1] Ep 183: Loss 0.1689 | Val MAE 1.4996
[P1] Ep 184: Loss 0.1653 | Val MAE 1.6455
[P1] Ep 185: Loss 0.1655 | Val MAE 1.5631
[P1] Ep 186: Loss 0.1640 | Val MAE 1.5672
[P1] Ep 187: Loss 0.1689 | Val MAE 1.5323
[P1] Ep 188: Loss 0.1653 | Val MAE 1.5936
[P1] Ep 189: Loss 0.1634 | Val MAE 1.5383
[P1] Ep 190: Loss 0.1613 | Val MAE 1.5413
[P1] Ep 191: Loss 0.1584 | Val MAE 1.5452
[P1] Ep 192: Loss 0.1583 | Val MAE 1.5335
[P1] Ep 193: Loss 0.1593 | Val MAE 1.5474
[P1] Ep 194: Loss 0.1585 | Val MAE 1.5263
[P1] Ep 195: Loss 0.1551 | Val MAE 1.4972
[P1] Ep 196: Loss 0.1605 | Val MAE 1.5253
[P1] Ep 197: Loss 0.1551 | Val MAE 1.6038
[P1] Ep 198: Loss 0.1539 | Val MAE 1.5042
[P1] Ep 199: Loss 0.1557 | Val MAE 1.5920
[P1] Ep 200: Loss 0.1526 | Val MAE 1.6070

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 8.0714 | Val MAE 1.4304 CI 0.6725
[FT] Ep 2: Loss 7.6324 | Val MAE 1.3921 CI 0.6725
[FT] Ep 3: Loss 7.4114 | Val MAE 1.3578 CI 0.6667
[FT] Ep 4: Loss 7.1337 | Val MAE 1.3299 CI 0.6550
[FT] Ep 5: Loss 6.9218 | Val MAE 1.3000 CI 0.6725
[FT] Ep 6: Loss 6.7979 | Val MAE 1.2706 CI 0.6784
[FT] Ep 7: Loss 6.6829 | Val MAE 1.2706 CI 0.6901
[FT] Ep 8: Loss 6.2020 | Val MAE 1.2745 CI 0.6901
[FT] Ep 9: Loss 6.3529 | Val MAE 1.2804 CI 0.6842
[FT] Ep 10: Loss 6.2052 | Val MAE 1.2865 CI 0.6901
[FT] Ep 11: Loss 5.7516 | Val MAE 1.2910 CI 0.6959
[FT] Ep 12: Loss 5.7331 | Val MAE 1.2980 CI 0.7076
[FT] Ep 13: Loss 5.2801 | Val MAE 1.3060 CI 0.7076
[FT] Ep 14: Loss 5.5562 | Val MAE 1.3201 CI 0.7076
[FT] Ep 15: Loss 5.0914 | Val MAE 1.3363 CI 0.7193
[FT] Ep 16: Loss 4.8061 | Val MAE 1.3447 CI 0.7251
[FT] Ep 17: Loss 4.7814 | Val MAE 1.3553 CI 0.7485
[FT] Ep 18: Loss 5.0633 | Val MAE 1.3651 CI 0.7368
[FT] Ep 19: Loss 4.7175 | Val MAE 1.3776 CI 0.7251
[FT] Ep 20: Loss 4.3940 | Val MAE 1.3805 CI 0.7251
[FT] Ep 21: Loss 4.5400 | Val MAE 1.3889 CI 0.7193
[FT] Ep 22: Loss 4.2430 | Val MAE 1.4003 CI 0.7018
[FT] Ep 23: Loss 4.6096 | Val MAE 1.4057 CI 0.7076
[FT] Ep 24: Loss 4.3483 | Val MAE 1.4125 CI 0.7076
[FT] Ep 25: Loss 4.1870 | Val MAE 1.4146 CI 0.7251
[FT] Ep 26: Loss 3.7182 | Val MAE 1.4175 CI 0.7193
[FT] Ep 27: Loss 3.9000 | Val MAE 1.4227 CI 0.7193
[FT] Ep 28: Loss 3.8884 | Val MAE 1.4287 CI 0.7193
[FT] Ep 29: Loss 3.8138 | Val MAE 1.4371 CI 0.7076
[FT] Ep 30: Loss 3.7772 | Val MAE 1.4451 CI 0.7076
[FT] Ep 31: Loss 3.4273 | Val MAE 1.4549 CI 0.6959
[FT] Ep 32: Loss 3.5410 | Val MAE 1.4675 CI 0.6901
[FT] Ep 33: Loss 3.5111 | Val MAE 1.4721 CI 0.6842
[FT] Ep 34: Loss 3.4321 | Val MAE 1.4739 CI 0.6901
[FT] Ep 35: Loss 3.3822 | Val MAE 1.4786 CI 0.6901
[FT] Ep 36: Loss 3.2663 | Val MAE 1.4831 CI 0.6901
[FT] Ep 37: Loss 3.0592 | Val MAE 1.4929 CI 0.6901
[FT] Ep 38: Loss 3.0452 | Val MAE 1.4937 CI 0.6901
[FT] Ep 39: Loss 3.0164 | Val MAE 1.5018 CI 0.6842
[FT] Ep 40: Loss 3.0200 | Val MAE 1.5092 CI 0.6784
[FT] Ep 41: Loss 2.7927 | Val MAE 1.5146 CI 0.6784
[FT] Ep 42: Loss 3.0264 | Val MAE 1.5171 CI 0.6725
[FT] Ep 43: Loss 3.0464 | Val MAE 1.5205 CI 0.6725
[FT] Ep 44: Loss 2.8776 | Val MAE 1.5244 CI 0.6608
[FT] Ep 45: Loss 2.7317 | Val MAE 1.5223 CI 0.6608
[FT] Ep 46: Loss 2.8709 | Val MAE 1.5280 CI 0.6550
[FT] Ep 47: Loss 2.4856 | Val MAE 1.5332 CI 0.6433
[FT] Ep 48: Loss 2.4019 | Val MAE 1.5384 CI 0.6550
[FT] Ep 49: Loss 2.5191 | Val MAE 1.5417 CI 0.6550
[FT] Ep 50: Loss 2.4917 | Val MAE 1.5394 CI 0.6550
[FT] Ep 51: Loss 2.3814 | Val MAE 1.5431 CI 0.6491
[FT] Ep 52: Loss 2.4066 | Val MAE 1.5526 CI 0.6433
[FT] Ep 53: Loss 2.5275 | Val MAE 1.5530 CI 0.6491
[FT] Ep 54: Loss 2.2899 | Val MAE 1.5603 CI 0.6491
[FT] Ep 55: Loss 2.2418 | Val MAE 1.5630 CI 0.6491
[FT] Ep 56: Loss 2.0319 | Val MAE 1.5672 CI 0.6491
[FT] Ep 57: Loss 1.9873 | Val MAE 1.5685 CI 0.6491
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: MolPeg
   MAE:  1.7276
   RMSE: 2.2759
   CI:   0.5053
   RM2:  0.0049
   MAPE: 29.78 %
   Acc:  30.00 %
------------------------------------------------------------
