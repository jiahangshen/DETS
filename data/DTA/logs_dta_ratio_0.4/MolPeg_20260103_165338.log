--- DTA Baseline: MolPeg (Ratio: 0.4) ---

>>> [Stage 0] Sampling...

[Sampler] Running MolPeg | Target: 9982/24956 (40.0%)
Scanning Source (MolPeg):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (MolPeg):   4%|▍         | 1/25 [00:03<01:12,  3.04s/it]Scanning Source (MolPeg):   8%|▊         | 2/25 [00:03<00:31,  1.38s/it]Scanning Source (MolPeg):  12%|█▏        | 3/25 [00:03<00:18,  1.16it/s]Scanning Source (MolPeg):  16%|█▌        | 4/25 [00:03<00:12,  1.65it/s]Scanning Source (MolPeg):  20%|██        | 5/25 [00:04<00:11,  1.78it/s]Scanning Source (MolPeg):  24%|██▍       | 6/25 [00:04<00:08,  2.26it/s]Scanning Source (MolPeg):  28%|██▊       | 7/25 [00:04<00:06,  2.71it/s]Scanning Source (MolPeg):  32%|███▏      | 8/25 [00:05<00:06,  2.70it/s]Scanning Source (MolPeg):  36%|███▌      | 9/25 [00:06<00:11,  1.44it/s]Scanning Source (MolPeg):  40%|████      | 10/25 [00:06<00:08,  1.83it/s]Scanning Source (MolPeg):  44%|████▍     | 11/25 [00:06<00:06,  2.25it/s]Scanning Source (MolPeg):  48%|████▊     | 12/25 [00:07<00:05,  2.22it/s]Scanning Source (MolPeg):  52%|█████▏    | 13/25 [00:08<00:06,  1.77it/s]Scanning Source (MolPeg):  56%|█████▌    | 14/25 [00:08<00:05,  1.84it/s]Scanning Source (MolPeg):  60%|██████    | 15/25 [00:08<00:04,  2.24it/s]Scanning Source (MolPeg):  64%|██████▍   | 16/25 [00:09<00:03,  2.66it/s]Scanning Source (MolPeg):  68%|██████▊   | 17/25 [00:10<00:04,  1.73it/s]Scanning Source (MolPeg):  72%|███████▏  | 18/25 [00:10<00:03,  2.00it/s]Scanning Source (MolPeg):  76%|███████▌  | 19/25 [00:10<00:02,  2.41it/s]Scanning Source (MolPeg):  80%|████████  | 20/25 [00:10<00:01,  2.82it/s]Scanning Source (MolPeg):  84%|████████▍ | 21/25 [00:11<00:02,  1.85it/s]Scanning Source (MolPeg):  88%|████████▊ | 22/25 [00:12<00:01,  2.00it/s]Scanning Source (MolPeg):  92%|█████████▏| 23/25 [00:12<00:00,  2.42it/s]Scanning Source (MolPeg):  96%|█████████▌| 24/25 [00:12<00:00,  2.67it/s]                                                                         -> Source reduced: 24956 -> 9982

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.4825 | Val MAE 1.7463
[P1] Ep 2: Loss 1.1863 | Val MAE 1.6764
[P1] Ep 3: Loss 1.0167 | Val MAE 1.7681
[P1] Ep 4: Loss 0.9659 | Val MAE 1.7649
[P1] Ep 5: Loss 0.9214 | Val MAE 1.6590
[P1] Ep 6: Loss 0.8756 | Val MAE 1.7302
[P1] Ep 7: Loss 0.8633 | Val MAE 1.7145
[P1] Ep 8: Loss 0.8707 | Val MAE 1.6820
[P1] Ep 9: Loss 0.8310 | Val MAE 1.7059
[P1] Ep 10: Loss 0.8150 | Val MAE 1.7009
[P1] Ep 11: Loss 0.8103 | Val MAE 1.6776
[P1] Ep 12: Loss 0.7949 | Val MAE 1.8084
[P1] Ep 13: Loss 0.7831 | Val MAE 1.6771
[P1] Ep 14: Loss 0.7703 | Val MAE 1.6955
[P1] Ep 15: Loss 0.7587 | Val MAE 1.7187
[P1] Ep 16: Loss 0.7331 | Val MAE 1.6927
[P1] Ep 17: Loss 0.7533 | Val MAE 1.7239
[P1] Ep 18: Loss 0.7368 | Val MAE 1.7375
[P1] Ep 19: Loss 0.7502 | Val MAE 1.7302
[P1] Ep 20: Loss 0.7144 | Val MAE 1.6784
[P1] Ep 21: Loss 0.7409 | Val MAE 1.6070
[P1] Ep 22: Loss 0.7199 | Val MAE 1.7090
[P1] Ep 23: Loss 0.7158 | Val MAE 1.6502
[P1] Ep 24: Loss 0.7151 | Val MAE 1.6600
[P1] Ep 25: Loss 0.6981 | Val MAE 1.6895
[P1] Ep 26: Loss 0.7125 | Val MAE 1.6689
[P1] Ep 27: Loss 0.7028 | Val MAE 1.5743
[P1] Ep 28: Loss 0.7171 | Val MAE 1.6988
[P1] Ep 29: Loss 0.6954 | Val MAE 1.6573
[P1] Ep 30: Loss 0.6901 | Val MAE 1.7011
[P1] Ep 31: Loss 0.7137 | Val MAE 1.6463
[P1] Ep 32: Loss 0.6988 | Val MAE 1.6626
[P1] Ep 33: Loss 0.6967 | Val MAE 1.6490
[P1] Ep 34: Loss 0.6917 | Val MAE 1.7262
[P1] Ep 35: Loss 0.6841 | Val MAE 1.6697
[P1] Ep 36: Loss 0.6902 | Val MAE 1.6387
[P1] Ep 37: Loss 0.6874 | Val MAE 1.6848
[P1] Ep 38: Loss 0.6917 | Val MAE 1.7039
[P1] Ep 39: Loss 0.6860 | Val MAE 1.7423
[P1] Ep 40: Loss 0.6759 | Val MAE 1.6345
[P1] Ep 41: Loss 0.6638 | Val MAE 1.5881
[P1] Ep 42: Loss 0.6727 | Val MAE 1.6476
[P1] Ep 43: Loss 0.6828 | Val MAE 1.6264
[P1] Ep 44: Loss 0.6623 | Val MAE 1.6349
[P1] Ep 45: Loss 0.6550 | Val MAE 1.6027
[P1] Ep 46: Loss 0.6649 | Val MAE 1.7060
[P1] Ep 47: Loss 0.6592 | Val MAE 1.6187
[P1] Ep 48: Loss 0.6472 | Val MAE 1.6429
[P1] Ep 49: Loss 0.6490 | Val MAE 1.6702
[P1] Ep 50: Loss 0.6509 | Val MAE 1.6427
[P1] Ep 51: Loss 0.6397 | Val MAE 1.7548
[P1] Ep 52: Loss 0.6447 | Val MAE 1.6843
[P1] Ep 53: Loss 0.6349 | Val MAE 1.7259
[P1] Ep 54: Loss 0.6280 | Val MAE 1.6537
[P1] Ep 55: Loss 0.6219 | Val MAE 1.7198
[P1] Ep 56: Loss 0.6292 | Val MAE 1.7480
[P1] Ep 57: Loss 0.6206 | Val MAE 1.7662
[P1] Ep 58: Loss 0.6278 | Val MAE 1.7746
[P1] Ep 59: Loss 0.6123 | Val MAE 1.6991
[P1] Ep 60: Loss 0.6210 | Val MAE 1.7505
[P1] Ep 61: Loss 0.6069 | Val MAE 1.7309
[P1] Ep 62: Loss 0.6037 | Val MAE 1.7728
[P1] Ep 63: Loss 0.6048 | Val MAE 1.7684
[P1] Ep 64: Loss 0.5882 | Val MAE 1.7936
[P1] Ep 65: Loss 0.5927 | Val MAE 1.8109
[P1] Ep 66: Loss 0.5862 | Val MAE 1.8177
[P1] Ep 67: Loss 0.5985 | Val MAE 1.7776
[P1] Ep 68: Loss 0.5813 | Val MAE 1.7572
[P1] Ep 69: Loss 0.5882 | Val MAE 1.7634
[P1] Ep 70: Loss 0.5891 | Val MAE 1.7449
[P1] Ep 71: Loss 0.5899 | Val MAE 1.6917
[P1] Ep 72: Loss 0.5863 | Val MAE 1.7644
[P1] Ep 73: Loss 0.5810 | Val MAE 1.7206
[P1] Ep 74: Loss 0.5774 | Val MAE 1.7481
[P1] Ep 75: Loss 0.5680 | Val MAE 1.7570
[P1] Ep 76: Loss 0.5535 | Val MAE 1.7083
[P1] Ep 77: Loss 0.5606 | Val MAE 1.7471
[P1] Ep 78: Loss 0.5552 | Val MAE 1.6797
[P1] Ep 79: Loss 0.5680 | Val MAE 1.7328
[P1] Ep 80: Loss 0.5515 | Val MAE 1.7694
[P1] Ep 81: Loss 0.5376 | Val MAE 1.7574
[P1] Ep 82: Loss 0.5489 | Val MAE 1.7234
[P1] Ep 83: Loss 0.5389 | Val MAE 1.7092
[P1] Ep 84: Loss 0.5457 | Val MAE 1.7019
[P1] Ep 85: Loss 0.5428 | Val MAE 1.7104
[P1] Ep 86: Loss 0.5395 | Val MAE 1.7060
[P1] Ep 87: Loss 0.5278 | Val MAE 1.7096
[P1] Ep 88: Loss 0.5386 | Val MAE 1.6737
[P1] Ep 89: Loss 0.5312 | Val MAE 1.6971
[P1] Ep 90: Loss 0.5292 | Val MAE 1.7428
[P1] Ep 91: Loss 0.5297 | Val MAE 1.7079
[P1] Ep 92: Loss 0.5333 | Val MAE 1.6624
[P1] Ep 93: Loss 0.5235 | Val MAE 1.7530
[P1] Ep 94: Loss 0.5157 | Val MAE 1.7304
[P1] Ep 95: Loss 0.5185 | Val MAE 1.6935
[P1] Ep 96: Loss 0.5119 | Val MAE 1.7525
[P1] Ep 97: Loss 0.5087 | Val MAE 1.7423
[P1] Ep 98: Loss 0.5088 | Val MAE 1.7087
[P1] Ep 99: Loss 0.5050 | Val MAE 1.7673
[P1] Ep 100: Loss 0.4998 | Val MAE 1.6960
[P1] Ep 101: Loss 0.4962 | Val MAE 1.7500
[P1] Ep 102: Loss 0.4940 | Val MAE 1.7837
[P1] Ep 103: Loss 0.5023 | Val MAE 1.7554
[P1] Ep 104: Loss 0.4913 | Val MAE 1.8056
[P1] Ep 105: Loss 0.4814 | Val MAE 1.7495
[P1] Ep 106: Loss 0.4875 | Val MAE 1.7027
[P1] Ep 107: Loss 0.4794 | Val MAE 1.7602
[P1] Ep 108: Loss 0.4867 | Val MAE 1.8063
[P1] Ep 109: Loss 0.4887 | Val MAE 1.7686
[P1] Ep 110: Loss 0.4789 | Val MAE 1.8378
[P1] Ep 111: Loss 0.4795 | Val MAE 1.7619
[P1] Ep 112: Loss 0.4787 | Val MAE 1.7769
[P1] Ep 113: Loss 0.4745 | Val MAE 1.7636
[P1] Ep 114: Loss 0.4687 | Val MAE 1.8090
[P1] Ep 115: Loss 0.4607 | Val MAE 1.7644
[P1] Ep 116: Loss 0.4701 | Val MAE 1.7802
[P1] Ep 117: Loss 0.4635 | Val MAE 1.7753
[P1] Ep 118: Loss 0.4596 | Val MAE 1.7661
[P1] Ep 119: Loss 0.4520 | Val MAE 1.7299
[P1] Ep 120: Loss 0.4622 | Val MAE 1.7818
[P1] Ep 121: Loss 0.4587 | Val MAE 1.8040
[P1] Ep 122: Loss 0.4540 | Val MAE 1.8275
[P1] Ep 123: Loss 0.4478 | Val MAE 1.7781
[P1] Ep 124: Loss 0.4514 | Val MAE 1.7483
[P1] Ep 125: Loss 0.4506 | Val MAE 1.7684
[P1] Ep 126: Loss 0.4434 | Val MAE 1.7228
[P1] Ep 127: Loss 0.4439 | Val MAE 1.7195
[P1] Ep 128: Loss 0.4379 | Val MAE 1.7396
[P1] Ep 129: Loss 0.4422 | Val MAE 1.7354
[P1] Ep 130: Loss 0.4256 | Val MAE 1.7850
[P1] Ep 131: Loss 0.4271 | Val MAE 1.6701
[P1] Ep 132: Loss 0.4243 | Val MAE 1.7596
[P1] Ep 133: Loss 0.4236 | Val MAE 1.8050
[P1] Ep 134: Loss 0.4300 | Val MAE 1.7547
[P1] Ep 135: Loss 0.4260 | Val MAE 1.7736
[P1] Ep 136: Loss 0.4272 | Val MAE 1.8360
[P1] Ep 137: Loss 0.4170 | Val MAE 1.7514
[P1] Ep 138: Loss 0.4254 | Val MAE 1.8050
[P1] Ep 139: Loss 0.4077 | Val MAE 1.7074
[P1] Ep 140: Loss 0.4138 | Val MAE 1.7586
[P1] Ep 141: Loss 0.4059 | Val MAE 1.8849
[P1] Ep 142: Loss 0.4128 | Val MAE 1.6863
[P1] Ep 143: Loss 0.3962 | Val MAE 1.7794
[P1] Ep 144: Loss 0.3942 | Val MAE 1.8647
[P1] Ep 145: Loss 0.3996 | Val MAE 1.7796
[P1] Ep 146: Loss 0.4009 | Val MAE 1.8209
[P1] Ep 147: Loss 0.3937 | Val MAE 1.7431
[P1] Ep 148: Loss 0.3932 | Val MAE 1.8143
[P1] Ep 149: Loss 0.3911 | Val MAE 1.7859
[P1] Ep 150: Loss 0.3829 | Val MAE 1.7704
[P1] Ep 151: Loss 0.3911 | Val MAE 1.7277
[P1] Ep 152: Loss 0.3858 | Val MAE 1.8129
[P1] Ep 153: Loss 0.3881 | Val MAE 1.7344
[P1] Ep 154: Loss 0.3961 | Val MAE 1.8051
[P1] Ep 155: Loss 0.3759 | Val MAE 1.8169
[P1] Ep 156: Loss 0.3796 | Val MAE 1.8002
[P1] Ep 157: Loss 0.3783 | Val MAE 1.7715
[P1] Ep 158: Loss 0.3729 | Val MAE 1.7702
[P1] Ep 159: Loss 0.3706 | Val MAE 1.7123
[P1] Ep 160: Loss 0.3732 | Val MAE 1.7700
[P1] Ep 161: Loss 0.3701 | Val MAE 1.8125
[P1] Ep 162: Loss 0.3605 | Val MAE 1.7777
[P1] Ep 163: Loss 0.3638 | Val MAE 1.7305
[P1] Ep 164: Loss 0.3627 | Val MAE 1.7378
[P1] Ep 165: Loss 0.3682 | Val MAE 1.7932
[P1] Ep 166: Loss 0.3518 | Val MAE 1.7336
[P1] Ep 167: Loss 0.3511 | Val MAE 1.7272
[P1] Ep 168: Loss 0.3556 | Val MAE 1.6957
[P1] Ep 169: Loss 0.3503 | Val MAE 1.6995
[P1] Ep 170: Loss 0.3562 | Val MAE 1.7821
[P1] Ep 171: Loss 0.3394 | Val MAE 1.7134
[P1] Ep 172: Loss 0.3439 | Val MAE 1.8405
[P1] Ep 173: Loss 0.3394 | Val MAE 1.8187
[P1] Ep 174: Loss 0.3429 | Val MAE 1.7065
[P1] Ep 175: Loss 0.3246 | Val MAE 1.6827
[P1] Ep 176: Loss 0.3276 | Val MAE 1.7859
[P1] Ep 177: Loss 0.3299 | Val MAE 1.6674
[P1] Ep 178: Loss 0.3303 | Val MAE 1.6911
[P1] Ep 179: Loss 0.3279 | Val MAE 1.7718
[P1] Ep 180: Loss 0.3347 | Val MAE 1.7463
[P1] Ep 181: Loss 0.3357 | Val MAE 1.6974
[P1] Ep 182: Loss 0.3185 | Val MAE 1.7046
[P1] Ep 183: Loss 0.3173 | Val MAE 1.7682
[P1] Ep 184: Loss 0.3335 | Val MAE 1.8269
[P1] Ep 185: Loss 0.3211 | Val MAE 1.7278
[P1] Ep 186: Loss 0.3161 | Val MAE 1.7701
[P1] Ep 187: Loss 0.3057 | Val MAE 1.7143
[P1] Ep 188: Loss 0.3103 | Val MAE 1.7613
[P1] Ep 189: Loss 0.3050 | Val MAE 1.6736
[P1] Ep 190: Loss 0.3113 | Val MAE 1.7236
[P1] Ep 191: Loss 0.3155 | Val MAE 1.5885
[P1] Ep 192: Loss 0.3081 | Val MAE 1.7236
[P1] Ep 193: Loss 0.3042 | Val MAE 1.7526
[P1] Ep 194: Loss 0.3072 | Val MAE 1.7537
[P1] Ep 195: Loss 0.3019 | Val MAE 1.6882
[P1] Ep 196: Loss 0.2991 | Val MAE 1.8121
[P1] Ep 197: Loss 0.2994 | Val MAE 1.6676
[P1] Ep 198: Loss 0.2893 | Val MAE 1.7304
[P1] Ep 199: Loss 0.3011 | Val MAE 1.6561
[P1] Ep 200: Loss 0.2899 | Val MAE 1.7387

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 6.2322 | Val MAE 1.5723 CI 0.5029
[FT] Ep 2: Loss 5.9947 | Val MAE 1.5683 CI 0.5029
[FT] Ep 3: Loss 6.1495 | Val MAE 1.5622 CI 0.5029
[FT] Ep 4: Loss 5.8441 | Val MAE 1.5579 CI 0.5146
[FT] Ep 5: Loss 5.9791 | Val MAE 1.5678 CI 0.5263
[FT] Ep 6: Loss 5.5078 | Val MAE 1.5806 CI 0.5146
[FT] Ep 7: Loss 5.5937 | Val MAE 1.5873 CI 0.5029
[FT] Ep 8: Loss 5.4468 | Val MAE 1.6001 CI 0.4620
[FT] Ep 9: Loss 5.7173 | Val MAE 1.6088 CI 0.4620
[FT] Ep 10: Loss 5.3901 | Val MAE 1.6223 CI 0.4561
[FT] Ep 11: Loss 4.9518 | Val MAE 1.6333 CI 0.4737
[FT] Ep 12: Loss 5.3018 | Val MAE 1.6405 CI 0.4678
[FT] Ep 13: Loss 5.2286 | Val MAE 1.6446 CI 0.4737
[FT] Ep 14: Loss 5.2639 | Val MAE 1.6493 CI 0.4561
[FT] Ep 15: Loss 5.5337 | Val MAE 1.6536 CI 0.4620
[FT] Ep 16: Loss 5.0044 | Val MAE 1.6650 CI 0.4678
[FT] Ep 17: Loss 5.4804 | Val MAE 1.6673 CI 0.4503
[FT] Ep 18: Loss 5.2551 | Val MAE 1.6729 CI 0.4503
[FT] Ep 19: Loss 5.3396 | Val MAE 1.6746 CI 0.4503
[FT] Ep 20: Loss 5.6051 | Val MAE 1.6834 CI 0.4327
[FT] Ep 21: Loss 5.2551 | Val MAE 1.6825 CI 0.4444
[FT] Ep 22: Loss 5.2567 | Val MAE 1.6794 CI 0.4737
[FT] Ep 23: Loss 5.4777 | Val MAE 1.6823 CI 0.4737
[FT] Ep 24: Loss 5.0192 | Val MAE 1.6826 CI 0.4795
[FT] Ep 25: Loss 5.0820 | Val MAE 1.6852 CI 0.4620
[FT] Ep 26: Loss 5.2596 | Val MAE 1.6936 CI 0.4561
[FT] Ep 27: Loss 5.3858 | Val MAE 1.6934 CI 0.4678
[FT] Ep 28: Loss 5.1487 | Val MAE 1.6987 CI 0.4503
[FT] Ep 29: Loss 5.5137 | Val MAE 1.7001 CI 0.4503
[FT] Ep 30: Loss 5.1132 | Val MAE 1.7047 CI 0.4444
[FT] Ep 31: Loss 5.1024 | Val MAE 1.7110 CI 0.4444
[FT] Ep 32: Loss 5.0412 | Val MAE 1.7168 CI 0.4386
[FT] Ep 33: Loss 5.2797 | Val MAE 1.7128 CI 0.4444
[FT] Ep 34: Loss 5.2900 | Val MAE 1.7120 CI 0.4503
[FT] Ep 35: Loss 4.7727 | Val MAE 1.7094 CI 0.4561
[FT] Ep 36: Loss 5.2585 | Val MAE 1.7138 CI 0.4620
[FT] Ep 37: Loss 5.1151 | Val MAE 1.7176 CI 0.4561
[FT] Ep 38: Loss 5.2236 | Val MAE 1.7229 CI 0.4678
[FT] Ep 39: Loss 5.5861 | Val MAE 1.7213 CI 0.4678
[FT] Ep 40: Loss 5.0230 | Val MAE 1.7253 CI 0.4737
[FT] Ep 41: Loss 4.6491 | Val MAE 1.7268 CI 0.4737
[FT] Ep 42: Loss 5.0222 | Val MAE 1.7341 CI 0.4620
[FT] Ep 43: Loss 4.8424 | Val MAE 1.7389 CI 0.4561
[FT] Ep 44: Loss 5.0627 | Val MAE 1.7388 CI 0.4620
[FT] Ep 45: Loss 5.1479 | Val MAE 1.7389 CI 0.4620
[FT] Ep 46: Loss 5.0907 | Val MAE 1.7347 CI 0.4678
[FT] Ep 47: Loss 5.0738 | Val MAE 1.7367 CI 0.4795
[FT] Ep 48: Loss 5.3850 | Val MAE 1.7424 CI 0.4795
[FT] Ep 49: Loss 5.1878 | Val MAE 1.7350 CI 0.4971
[FT] Ep 50: Loss 5.2773 | Val MAE 1.7301 CI 0.4912
[FT] Ep 51: Loss 5.2843 | Val MAE 1.7243 CI 0.4971
[FT] Ep 52: Loss 4.9799 | Val MAE 1.7254 CI 0.4971
[FT] Ep 53: Loss 4.8660 | Val MAE 1.7353 CI 0.4971
[FT] Ep 54: Loss 4.8125 | Val MAE 1.7453 CI 0.4971
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: MolPeg
   MAE:  1.6113
   RMSE: 1.9638
   CI:   0.4368
   RM2:  0.0168
   MAPE: 26.80 %
   Acc:  20.00 %
------------------------------------------------------------
