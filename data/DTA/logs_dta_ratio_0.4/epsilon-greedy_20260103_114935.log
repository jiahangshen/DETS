--- DTA Baseline: epsilon-greedy (Ratio: 0.4) ---

>>> [Stage 0] Sampling...

[Sampler] Running epsilon-greedy | Target: 9982/24956 (40.0%)
Scanning Source (epsilon-greedy):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (epsilon-greedy):   4%|▍         | 1/25 [00:02<01:07,  2.82s/it]Scanning Source (epsilon-greedy):   8%|▊         | 2/25 [00:03<00:29,  1.30s/it]Scanning Source (epsilon-greedy):  12%|█▏        | 3/25 [00:03<00:17,  1.25it/s]Scanning Source (epsilon-greedy):  16%|█▌        | 4/25 [00:03<00:11,  1.75it/s]Scanning Source (epsilon-greedy):  20%|██        | 5/25 [00:04<00:11,  1.73it/s]Scanning Source (epsilon-greedy):  24%|██▍       | 6/25 [00:04<00:08,  2.21it/s]Scanning Source (epsilon-greedy):  28%|██▊       | 7/25 [00:04<00:07,  2.53it/s]Scanning Source (epsilon-greedy):  32%|███▏      | 8/25 [00:04<00:05,  2.97it/s]Scanning Source (epsilon-greedy):  36%|███▌      | 9/25 [00:06<00:09,  1.62it/s]Scanning Source (epsilon-greedy):  40%|████      | 10/25 [00:06<00:07,  1.99it/s]Scanning Source (epsilon-greedy):  44%|████▍     | 11/25 [00:06<00:06,  2.32it/s]Scanning Source (epsilon-greedy):  48%|████▊     | 12/25 [00:06<00:04,  2.69it/s]Scanning Source (epsilon-greedy):  52%|█████▏    | 13/25 [00:08<00:07,  1.53it/s]Scanning Source (epsilon-greedy):  56%|█████▌    | 14/25 [00:08<00:05,  1.92it/s]Scanning Source (epsilon-greedy):  60%|██████    | 15/25 [00:08<00:04,  2.34it/s]Scanning Source (epsilon-greedy):  64%|██████▍   | 16/25 [00:08<00:03,  2.75it/s]Scanning Source (epsilon-greedy):  68%|██████▊   | 17/25 [00:09<00:04,  1.82it/s]Scanning Source (epsilon-greedy):  72%|███████▏  | 18/25 [00:09<00:03,  2.23it/s]Scanning Source (epsilon-greedy):  76%|███████▌  | 19/25 [00:10<00:02,  2.49it/s]Scanning Source (epsilon-greedy):  80%|████████  | 20/25 [00:10<00:01,  2.91it/s]Scanning Source (epsilon-greedy):  84%|████████▍ | 21/25 [00:11<00:02,  1.70it/s]Scanning Source (epsilon-greedy):  88%|████████▊ | 22/25 [00:11<00:01,  2.11it/s]Scanning Source (epsilon-greedy):  92%|█████████▏| 23/25 [00:11<00:00,  2.53it/s]Scanning Source (epsilon-greedy):  96%|█████████▌| 24/25 [00:12<00:00,  2.94it/s]                                                                                 -> Source reduced: 24956 -> 9982

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.4977 | Val MAE 1.7588
[P1] Ep 2: Loss 1.2878 | Val MAE 1.6750
[P1] Ep 3: Loss 1.1219 | Val MAE 1.7563
[P1] Ep 4: Loss 1.0676 | Val MAE 1.7191
[P1] Ep 5: Loss 1.0428 | Val MAE 1.6395
[P1] Ep 6: Loss 1.0049 | Val MAE 1.7853
[P1] Ep 7: Loss 0.9870 | Val MAE 1.6720
[P1] Ep 8: Loss 0.9884 | Val MAE 1.7622
[P1] Ep 9: Loss 0.9681 | Val MAE 1.6514
[P1] Ep 10: Loss 0.9206 | Val MAE 1.6499
[P1] Ep 11: Loss 0.9067 | Val MAE 1.6673
[P1] Ep 12: Loss 0.8915 | Val MAE 1.6711
[P1] Ep 13: Loss 0.9019 | Val MAE 1.6723
[P1] Ep 14: Loss 0.8788 | Val MAE 1.7180
[P1] Ep 15: Loss 0.8702 | Val MAE 1.7404
[P1] Ep 16: Loss 0.8489 | Val MAE 1.5996
[P1] Ep 17: Loss 0.8591 | Val MAE 1.6638
[P1] Ep 18: Loss 0.8425 | Val MAE 1.7565
[P1] Ep 19: Loss 0.8390 | Val MAE 1.7656
[P1] Ep 20: Loss 0.8330 | Val MAE 1.7765
[P1] Ep 21: Loss 0.8286 | Val MAE 1.6416
[P1] Ep 22: Loss 0.8334 | Val MAE 1.7575
[P1] Ep 23: Loss 0.8266 | Val MAE 1.6314
[P1] Ep 24: Loss 0.8323 | Val MAE 1.6977
[P1] Ep 25: Loss 0.8207 | Val MAE 1.8086
[P1] Ep 26: Loss 0.8228 | Val MAE 1.6753
[P1] Ep 27: Loss 0.8025 | Val MAE 1.6212
[P1] Ep 28: Loss 0.7862 | Val MAE 1.6532
[P1] Ep 29: Loss 0.8029 | Val MAE 1.6062
[P1] Ep 30: Loss 0.7892 | Val MAE 1.6252
[P1] Ep 31: Loss 0.7959 | Val MAE 1.6222
[P1] Ep 32: Loss 0.8018 | Val MAE 1.5992
[P1] Ep 33: Loss 0.8005 | Val MAE 1.6262
[P1] Ep 34: Loss 0.7851 | Val MAE 1.8263
[P1] Ep 35: Loss 0.7862 | Val MAE 1.7161
[P1] Ep 36: Loss 0.7883 | Val MAE 1.6634
[P1] Ep 37: Loss 0.7872 | Val MAE 1.7787
[P1] Ep 38: Loss 0.7948 | Val MAE 1.7810
[P1] Ep 39: Loss 0.7844 | Val MAE 1.7851
[P1] Ep 40: Loss 0.7680 | Val MAE 1.6775
[P1] Ep 41: Loss 0.7728 | Val MAE 1.6141
[P1] Ep 42: Loss 0.7660 | Val MAE 1.7831
[P1] Ep 43: Loss 0.7690 | Val MAE 1.7712
[P1] Ep 44: Loss 0.7713 | Val MAE 1.7856
[P1] Ep 45: Loss 0.7646 | Val MAE 1.6496
[P1] Ep 46: Loss 0.7689 | Val MAE 1.8080
[P1] Ep 47: Loss 0.7583 | Val MAE 1.6614
[P1] Ep 48: Loss 0.7621 | Val MAE 1.7111
[P1] Ep 49: Loss 0.7472 | Val MAE 1.7444
[P1] Ep 50: Loss 0.7559 | Val MAE 1.6606
[P1] Ep 51: Loss 0.7461 | Val MAE 1.7909
[P1] Ep 52: Loss 0.7489 | Val MAE 1.7831
[P1] Ep 53: Loss 0.7509 | Val MAE 1.6143
[P1] Ep 54: Loss 0.7401 | Val MAE 1.7063
[P1] Ep 55: Loss 0.7343 | Val MAE 1.7785
[P1] Ep 56: Loss 0.7436 | Val MAE 1.7724
[P1] Ep 57: Loss 0.7392 | Val MAE 1.6967
[P1] Ep 58: Loss 0.7282 | Val MAE 1.8310
[P1] Ep 59: Loss 0.7324 | Val MAE 1.9478
[P1] Ep 60: Loss 0.7401 | Val MAE 1.8520
[P1] Ep 61: Loss 0.7227 | Val MAE 1.8816
[P1] Ep 62: Loss 0.7193 | Val MAE 1.8714
[P1] Ep 63: Loss 0.7171 | Val MAE 1.7849
[P1] Ep 64: Loss 0.7214 | Val MAE 1.7844
[P1] Ep 65: Loss 0.7089 | Val MAE 1.7474
[P1] Ep 66: Loss 0.7093 | Val MAE 1.7724
[P1] Ep 67: Loss 0.7068 | Val MAE 1.8210
[P1] Ep 68: Loss 0.7105 | Val MAE 1.8046
[P1] Ep 69: Loss 0.6922 | Val MAE 1.8046
[P1] Ep 70: Loss 0.6955 | Val MAE 1.8763
[P1] Ep 71: Loss 0.7005 | Val MAE 1.7351
[P1] Ep 72: Loss 0.6891 | Val MAE 1.7472
[P1] Ep 73: Loss 0.6977 | Val MAE 1.6729
[P1] Ep 74: Loss 0.6816 | Val MAE 1.7865
[P1] Ep 75: Loss 0.6688 | Val MAE 1.8376
[P1] Ep 76: Loss 0.6795 | Val MAE 1.6205
[P1] Ep 77: Loss 0.6712 | Val MAE 1.9073
[P1] Ep 78: Loss 0.6701 | Val MAE 1.9065
[P1] Ep 79: Loss 0.6578 | Val MAE 1.7702
[P1] Ep 80: Loss 0.6611 | Val MAE 1.7803
[P1] Ep 81: Loss 0.6558 | Val MAE 1.7323
[P1] Ep 82: Loss 0.6457 | Val MAE 1.8090
[P1] Ep 83: Loss 0.6421 | Val MAE 1.7649
[P1] Ep 84: Loss 0.6399 | Val MAE 1.7621
[P1] Ep 85: Loss 0.6220 | Val MAE 1.7524
[P1] Ep 86: Loss 0.6337 | Val MAE 1.7775
[P1] Ep 87: Loss 0.6372 | Val MAE 1.7760
[P1] Ep 88: Loss 0.6273 | Val MAE 1.8248
[P1] Ep 89: Loss 0.6246 | Val MAE 1.7616
[P1] Ep 90: Loss 0.6154 | Val MAE 1.7097
[P1] Ep 91: Loss 0.6084 | Val MAE 1.6695
[P1] Ep 92: Loss 0.5977 | Val MAE 1.7385
[P1] Ep 93: Loss 0.6219 | Val MAE 1.7632
[P1] Ep 94: Loss 0.5837 | Val MAE 1.8474
[P1] Ep 95: Loss 0.6002 | Val MAE 1.7922
[P1] Ep 96: Loss 0.5868 | Val MAE 1.8812
[P1] Ep 97: Loss 0.5789 | Val MAE 1.8334
[P1] Ep 98: Loss 0.5829 | Val MAE 1.6911
[P1] Ep 99: Loss 0.5772 | Val MAE 1.7838
[P1] Ep 100: Loss 0.5768 | Val MAE 1.7314
[P1] Ep 101: Loss 0.5719 | Val MAE 1.7226
[P1] Ep 102: Loss 0.5624 | Val MAE 1.8330
[P1] Ep 103: Loss 0.5730 | Val MAE 1.7756
[P1] Ep 104: Loss 0.5618 | Val MAE 1.7208
[P1] Ep 105: Loss 0.5488 | Val MAE 1.7780
[P1] Ep 106: Loss 0.5427 | Val MAE 1.7906
[P1] Ep 107: Loss 0.5463 | Val MAE 1.7389
[P1] Ep 108: Loss 0.5516 | Val MAE 1.7348
[P1] Ep 109: Loss 0.5559 | Val MAE 1.7006
[P1] Ep 110: Loss 0.5128 | Val MAE 1.6707
[P1] Ep 111: Loss 0.5328 | Val MAE 1.8134
[P1] Ep 112: Loss 0.5288 | Val MAE 1.8448
[P1] Ep 113: Loss 0.5191 | Val MAE 1.8061
[P1] Ep 114: Loss 0.5089 | Val MAE 1.6162
[P1] Ep 115: Loss 0.5213 | Val MAE 1.7533
[P1] Ep 116: Loss 0.5177 | Val MAE 1.6797
[P1] Ep 117: Loss 0.5183 | Val MAE 1.7449
[P1] Ep 118: Loss 0.5205 | Val MAE 1.7813
[P1] Ep 119: Loss 0.5080 | Val MAE 1.7327
[P1] Ep 120: Loss 0.5048 | Val MAE 1.7442
[P1] Ep 121: Loss 0.5009 | Val MAE 1.8247
[P1] Ep 122: Loss 0.4820 | Val MAE 1.7611
[P1] Ep 123: Loss 0.4897 | Val MAE 1.6845
[P1] Ep 124: Loss 0.4898 | Val MAE 1.7826
[P1] Ep 125: Loss 0.4829 | Val MAE 1.6751
[P1] Ep 126: Loss 0.4858 | Val MAE 1.7650
[P1] Ep 127: Loss 0.4763 | Val MAE 1.7286
[P1] Ep 128: Loss 0.4829 | Val MAE 1.7375
[P1] Ep 129: Loss 0.4661 | Val MAE 1.7387
[P1] Ep 130: Loss 0.4675 | Val MAE 1.8817
[P1] Ep 131: Loss 0.4784 | Val MAE 1.7395
[P1] Ep 132: Loss 0.4679 | Val MAE 1.7060
[P1] Ep 133: Loss 0.4674 | Val MAE 1.7610
[P1] Ep 134: Loss 0.4581 | Val MAE 1.7338
[P1] Ep 135: Loss 0.4642 | Val MAE 1.7617
[P1] Ep 136: Loss 0.4657 | Val MAE 1.6790
[P1] Ep 137: Loss 0.4602 | Val MAE 1.7646
[P1] Ep 138: Loss 0.4566 | Val MAE 1.6816
[P1] Ep 139: Loss 0.4510 | Val MAE 1.7769
[P1] Ep 140: Loss 0.4421 | Val MAE 1.7242
[P1] Ep 141: Loss 0.4391 | Val MAE 1.6974
[P1] Ep 142: Loss 0.4455 | Val MAE 1.6826
[P1] Ep 143: Loss 0.4309 | Val MAE 1.7720
[P1] Ep 144: Loss 0.4389 | Val MAE 1.6728
[P1] Ep 145: Loss 0.4430 | Val MAE 1.6337
[P1] Ep 146: Loss 0.4434 | Val MAE 1.6697
[P1] Ep 147: Loss 0.4308 | Val MAE 1.6852
[P1] Ep 148: Loss 0.4222 | Val MAE 1.7410
[P1] Ep 149: Loss 0.4221 | Val MAE 1.7520
[P1] Ep 150: Loss 0.4194 | Val MAE 1.7142
[P1] Ep 151: Loss 0.4151 | Val MAE 1.8134
[P1] Ep 152: Loss 0.4198 | Val MAE 1.7857
[P1] Ep 153: Loss 0.4249 | Val MAE 1.7171
[P1] Ep 154: Loss 0.4127 | Val MAE 1.8005
[P1] Ep 155: Loss 0.4092 | Val MAE 1.6769
[P1] Ep 156: Loss 0.4086 | Val MAE 1.7926
[P1] Ep 157: Loss 0.3980 | Val MAE 1.7892
[P1] Ep 158: Loss 0.4065 | Val MAE 1.7251
[P1] Ep 159: Loss 0.3999 | Val MAE 1.7869
[P1] Ep 160: Loss 0.3951 | Val MAE 1.7409
[P1] Ep 161: Loss 0.3994 | Val MAE 1.7779
[P1] Ep 162: Loss 0.3925 | Val MAE 1.7805
[P1] Ep 163: Loss 0.3844 | Val MAE 1.8105
[P1] Ep 164: Loss 0.3899 | Val MAE 1.8605
[P1] Ep 165: Loss 0.3860 | Val MAE 1.7494
[P1] Ep 166: Loss 0.3871 | Val MAE 1.7321
[P1] Ep 167: Loss 0.3910 | Val MAE 1.6874
[P1] Ep 168: Loss 0.3760 | Val MAE 1.7216
[P1] Ep 169: Loss 0.3782 | Val MAE 1.7418
[P1] Ep 170: Loss 0.3811 | Val MAE 1.7128
[P1] Ep 171: Loss 0.3723 | Val MAE 1.7687
[P1] Ep 172: Loss 0.3682 | Val MAE 1.7267
[P1] Ep 173: Loss 0.3675 | Val MAE 1.7449
[P1] Ep 174: Loss 0.3590 | Val MAE 1.7078
[P1] Ep 175: Loss 0.3720 | Val MAE 1.7200
[P1] Ep 176: Loss 0.3612 | Val MAE 1.7849
[P1] Ep 177: Loss 0.3576 | Val MAE 1.6472
[P1] Ep 178: Loss 0.3606 | Val MAE 1.7991
[P1] Ep 179: Loss 0.3577 | Val MAE 1.8401
[P1] Ep 180: Loss 0.3625 | Val MAE 1.7942
[P1] Ep 181: Loss 0.3649 | Val MAE 1.8534
[P1] Ep 182: Loss 0.3605 | Val MAE 1.7382
[P1] Ep 183: Loss 0.3557 | Val MAE 1.7026
[P1] Ep 184: Loss 0.3505 | Val MAE 1.6805
[P1] Ep 185: Loss 0.3422 | Val MAE 1.6843
[P1] Ep 186: Loss 0.3476 | Val MAE 1.8312
[P1] Ep 187: Loss 0.3496 | Val MAE 1.9408
[P1] Ep 188: Loss 0.3411 | Val MAE 1.7114
[P1] Ep 189: Loss 0.3421 | Val MAE 1.7912
[P1] Ep 190: Loss 0.3398 | Val MAE 2.0204
[P1] Ep 191: Loss 0.3368 | Val MAE 1.9852
[P1] Ep 192: Loss 0.3408 | Val MAE 1.8347
[P1] Ep 193: Loss 0.3281 | Val MAE 1.7925
[P1] Ep 194: Loss 0.3191 | Val MAE 1.8076
[P1] Ep 195: Loss 0.3194 | Val MAE 1.7503
[P1] Ep 196: Loss 0.3236 | Val MAE 1.9191
[P1] Ep 197: Loss 0.3237 | Val MAE 1.8742
[P1] Ep 198: Loss 0.3141 | Val MAE 1.7418
[P1] Ep 199: Loss 0.3225 | Val MAE 1.6761
[P1] Ep 200: Loss 0.3138 | Val MAE 1.8117

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 5.8250 | Val MAE 1.5239 CI 0.5497
[FT] Ep 2: Loss 6.0093 | Val MAE 1.5206 CI 0.5439
[FT] Ep 3: Loss 5.7136 | Val MAE 1.5290 CI 0.5146
[FT] Ep 4: Loss 6.0176 | Val MAE 1.5563 CI 0.5322
[FT] Ep 5: Loss 5.4761 | Val MAE 1.5589 CI 0.5263
[FT] Ep 6: Loss 5.9783 | Val MAE 1.5554 CI 0.5380
[FT] Ep 7: Loss 5.6968 | Val MAE 1.5542 CI 0.5205
[FT] Ep 8: Loss 5.1554 | Val MAE 1.5678 CI 0.5322
[FT] Ep 9: Loss 5.3921 | Val MAE 1.5783 CI 0.5088
[FT] Ep 10: Loss 5.6583 | Val MAE 1.5922 CI 0.4971
[FT] Ep 11: Loss 5.4138 | Val MAE 1.6047 CI 0.4971
[FT] Ep 12: Loss 5.4442 | Val MAE 1.6111 CI 0.4971
[FT] Ep 13: Loss 5.4746 | Val MAE 1.6156 CI 0.5029
[FT] Ep 14: Loss 5.3369 | Val MAE 1.6176 CI 0.5205
[FT] Ep 15: Loss 5.1941 | Val MAE 1.6159 CI 0.5263
[FT] Ep 16: Loss 5.4433 | Val MAE 1.6223 CI 0.5263
[FT] Ep 17: Loss 5.3375 | Val MAE 1.6244 CI 0.5205
[FT] Ep 18: Loss 4.8615 | Val MAE 1.6292 CI 0.5146
[FT] Ep 19: Loss 5.3820 | Val MAE 1.6295 CI 0.5088
[FT] Ep 20: Loss 5.2206 | Val MAE 1.6365 CI 0.4971
[FT] Ep 21: Loss 5.3681 | Val MAE 1.6387 CI 0.4971
[FT] Ep 22: Loss 5.0483 | Val MAE 1.6389 CI 0.5088
[FT] Ep 23: Loss 5.2770 | Val MAE 1.6424 CI 0.5088
[FT] Ep 24: Loss 5.3028 | Val MAE 1.6459 CI 0.4971
[FT] Ep 25: Loss 5.2460 | Val MAE 1.6496 CI 0.4971
[FT] Ep 26: Loss 5.3452 | Val MAE 1.6533 CI 0.4971
[FT] Ep 27: Loss 5.3397 | Val MAE 1.6554 CI 0.4912
[FT] Ep 28: Loss 5.1992 | Val MAE 1.6587 CI 0.4912
[FT] Ep 29: Loss 4.8356 | Val MAE 1.6562 CI 0.4912
[FT] Ep 30: Loss 5.5064 | Val MAE 1.6606 CI 0.4854
[FT] Ep 31: Loss 5.0330 | Val MAE 1.6666 CI 0.4795
[FT] Ep 32: Loss 5.3570 | Val MAE 1.6727 CI 0.4795
[FT] Ep 33: Loss 5.3225 | Val MAE 1.6759 CI 0.4795
[FT] Ep 34: Loss 5.0244 | Val MAE 1.6777 CI 0.4678
[FT] Ep 35: Loss 5.1154 | Val MAE 1.6727 CI 0.4678
[FT] Ep 36: Loss 5.2191 | Val MAE 1.6681 CI 0.4678
[FT] Ep 37: Loss 5.1720 | Val MAE 1.6642 CI 0.4620
[FT] Ep 38: Loss 5.2073 | Val MAE 1.6683 CI 0.4620
[FT] Ep 39: Loss 5.2563 | Val MAE 1.6694 CI 0.4620
[FT] Ep 40: Loss 4.8848 | Val MAE 1.6709 CI 0.4678
[FT] Ep 41: Loss 5.1555 | Val MAE 1.6683 CI 0.4737
[FT] Ep 42: Loss 5.2808 | Val MAE 1.6647 CI 0.4854
[FT] Ep 43: Loss 4.8668 | Val MAE 1.6637 CI 0.4912
[FT] Ep 44: Loss 5.0414 | Val MAE 1.6661 CI 0.4971
[FT] Ep 45: Loss 5.1505 | Val MAE 1.6680 CI 0.4912
[FT] Ep 46: Loss 4.7930 | Val MAE 1.6686 CI 0.4971
[FT] Ep 47: Loss 5.4637 | Val MAE 1.6743 CI 0.5029
[FT] Ep 48: Loss 5.3137 | Val MAE 1.6804 CI 0.4971
[FT] Ep 49: Loss 5.0910 | Val MAE 1.6843 CI 0.5029
[FT] Ep 50: Loss 5.2654 | Val MAE 1.6906 CI 0.5029
[FT] Ep 51: Loss 5.0261 | Val MAE 1.6888 CI 0.5029
[FT] Ep 52: Loss 5.3002 | Val MAE 1.6811 CI 0.5029
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: epsilon-greedy
   MAE:  1.6491
   RMSE: 2.0290
   CI:   0.4263
   RM2:  0.0195
   MAPE: 27.07 %
   Acc:  20.00 %
------------------------------------------------------------
