--- DTA Baseline: UCB (Ratio: 0.4) ---

>>> [Stage 0] Sampling...

[Sampler] Running UCB | Target: 9982/24956 (40.0%)
Scanning Source (UCB):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (UCB):   4%|▍         | 1/25 [00:03<01:13,  3.08s/it]Scanning Source (UCB):   8%|▊         | 2/25 [00:03<00:32,  1.39s/it]Scanning Source (UCB):  12%|█▏        | 3/25 [00:03<00:19,  1.15it/s]Scanning Source (UCB):  16%|█▌        | 4/25 [00:03<00:12,  1.64it/s]Scanning Source (UCB):  20%|██        | 5/25 [00:04<00:14,  1.34it/s]Scanning Source (UCB):  24%|██▍       | 6/25 [00:04<00:10,  1.77it/s]Scanning Source (UCB):  28%|██▊       | 7/25 [00:05<00:08,  2.22it/s]Scanning Source (UCB):  32%|███▏      | 8/25 [00:05<00:06,  2.68it/s]Scanning Source (UCB):  36%|███▌      | 9/25 [00:06<00:10,  1.59it/s]Scanning Source (UCB):  40%|████      | 10/25 [00:06<00:07,  2.00it/s]Scanning Source (UCB):  44%|████▍     | 11/25 [00:06<00:05,  2.43it/s]Scanning Source (UCB):  48%|████▊     | 12/25 [00:07<00:04,  2.84it/s]Scanning Source (UCB):  52%|█████▏    | 13/25 [00:08<00:08,  1.41it/s]Scanning Source (UCB):  56%|█████▌    | 14/25 [00:08<00:06,  1.78it/s]Scanning Source (UCB):  60%|██████    | 15/25 [00:09<00:04,  2.19it/s]Scanning Source (UCB):  64%|██████▍   | 16/25 [00:09<00:03,  2.60it/s]Scanning Source (UCB):  68%|██████▊   | 17/25 [00:10<00:05,  1.59it/s]Scanning Source (UCB):  72%|███████▏  | 18/25 [00:10<00:03,  1.99it/s]Scanning Source (UCB):  76%|███████▌  | 19/25 [00:10<00:02,  2.40it/s]Scanning Source (UCB):  80%|████████  | 20/25 [00:11<00:01,  2.77it/s]Scanning Source (UCB):  84%|████████▍ | 21/25 [00:12<00:02,  1.52it/s]Scanning Source (UCB):  88%|████████▊ | 22/25 [00:12<00:01,  1.91it/s]Scanning Source (UCB):  92%|█████████▏| 23/25 [00:13<00:00,  2.33it/s]Scanning Source (UCB):  96%|█████████▌| 24/25 [00:13<00:00,  2.74it/s]                                                                      -> Source reduced: 24956 -> 9982

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.4851 | Val MAE 1.6944
[P1] Ep 2: Loss 1.1722 | Val MAE 1.6126
[P1] Ep 3: Loss 1.0353 | Val MAE 1.6919
[P1] Ep 4: Loss 0.9681 | Val MAE 1.6630
[P1] Ep 5: Loss 0.9465 | Val MAE 1.6638
[P1] Ep 6: Loss 0.8771 | Val MAE 1.7399
[P1] Ep 7: Loss 0.8548 | Val MAE 1.7632
[P1] Ep 8: Loss 0.8670 | Val MAE 1.6546
[P1] Ep 9: Loss 0.8455 | Val MAE 1.6882
[P1] Ep 10: Loss 0.8327 | Val MAE 1.6373
[P1] Ep 11: Loss 0.8189 | Val MAE 1.6892
[P1] Ep 12: Loss 0.7927 | Val MAE 1.7133
[P1] Ep 13: Loss 0.7809 | Val MAE 1.6364
[P1] Ep 14: Loss 0.7642 | Val MAE 1.6711
[P1] Ep 15: Loss 0.7591 | Val MAE 1.6949
[P1] Ep 16: Loss 0.7556 | Val MAE 1.6085
[P1] Ep 17: Loss 0.7542 | Val MAE 1.6317
[P1] Ep 18: Loss 0.7378 | Val MAE 1.7327
[P1] Ep 19: Loss 0.7220 | Val MAE 1.6508
[P1] Ep 20: Loss 0.7280 | Val MAE 1.6813
[P1] Ep 21: Loss 0.7281 | Val MAE 1.6094
[P1] Ep 22: Loss 0.7209 | Val MAE 1.6588
[P1] Ep 23: Loss 0.7242 | Val MAE 1.6232
[P1] Ep 24: Loss 0.7284 | Val MAE 1.6572
[P1] Ep 25: Loss 0.7080 | Val MAE 1.6631
[P1] Ep 26: Loss 0.7208 | Val MAE 1.6623
[P1] Ep 27: Loss 0.6971 | Val MAE 1.6296
[P1] Ep 28: Loss 0.7138 | Val MAE 1.7044
[P1] Ep 29: Loss 0.7082 | Val MAE 1.6329
[P1] Ep 30: Loss 0.7081 | Val MAE 1.6623
[P1] Ep 31: Loss 0.6982 | Val MAE 1.6600
[P1] Ep 32: Loss 0.7045 | Val MAE 1.6403
[P1] Ep 33: Loss 0.6867 | Val MAE 1.5960
[P1] Ep 34: Loss 0.6948 | Val MAE 1.7272
[P1] Ep 35: Loss 0.6925 | Val MAE 1.6156
[P1] Ep 36: Loss 0.6835 | Val MAE 1.6605
[P1] Ep 37: Loss 0.6988 | Val MAE 1.6383
[P1] Ep 38: Loss 0.6722 | Val MAE 1.6591
[P1] Ep 39: Loss 0.6779 | Val MAE 1.7228
[P1] Ep 40: Loss 0.6735 | Val MAE 1.6377
[P1] Ep 41: Loss 0.6667 | Val MAE 1.6147
[P1] Ep 42: Loss 0.6699 | Val MAE 1.6740
[P1] Ep 43: Loss 0.6527 | Val MAE 1.7119
[P1] Ep 44: Loss 0.6550 | Val MAE 1.6813
[P1] Ep 45: Loss 0.6519 | Val MAE 1.6191
[P1] Ep 46: Loss 0.6615 | Val MAE 1.7230
[P1] Ep 47: Loss 0.6560 | Val MAE 1.6207
[P1] Ep 48: Loss 0.6502 | Val MAE 1.6459
[P1] Ep 49: Loss 0.6343 | Val MAE 1.7446
[P1] Ep 50: Loss 0.6591 | Val MAE 1.6755
[P1] Ep 51: Loss 0.6349 | Val MAE 1.7118
[P1] Ep 52: Loss 0.6355 | Val MAE 1.6203
[P1] Ep 53: Loss 0.6237 | Val MAE 1.6221
[P1] Ep 54: Loss 0.6261 | Val MAE 1.6838
[P1] Ep 55: Loss 0.6206 | Val MAE 1.7991
[P1] Ep 56: Loss 0.6328 | Val MAE 1.7092
[P1] Ep 57: Loss 0.6121 | Val MAE 1.6808
[P1] Ep 58: Loss 0.6126 | Val MAE 1.7326
[P1] Ep 59: Loss 0.5973 | Val MAE 1.7209
[P1] Ep 60: Loss 0.6238 | Val MAE 1.7174
[P1] Ep 61: Loss 0.6033 | Val MAE 1.7388
[P1] Ep 62: Loss 0.5987 | Val MAE 1.7552
[P1] Ep 63: Loss 0.5970 | Val MAE 1.7097
[P1] Ep 64: Loss 0.5934 | Val MAE 1.6626
[P1] Ep 65: Loss 0.5865 | Val MAE 1.6846
[P1] Ep 66: Loss 0.5912 | Val MAE 1.6640
[P1] Ep 67: Loss 0.5851 | Val MAE 1.6582
[P1] Ep 68: Loss 0.5624 | Val MAE 1.6192
[P1] Ep 69: Loss 0.5745 | Val MAE 1.6321
[P1] Ep 70: Loss 0.5854 | Val MAE 1.6906
[P1] Ep 71: Loss 0.5756 | Val MAE 1.6925
[P1] Ep 72: Loss 0.5652 | Val MAE 1.6199
[P1] Ep 73: Loss 0.5709 | Val MAE 1.6329
[P1] Ep 74: Loss 0.5530 | Val MAE 1.6987
[P1] Ep 75: Loss 0.5568 | Val MAE 1.6283
[P1] Ep 76: Loss 0.5497 | Val MAE 1.5435
[P1] Ep 77: Loss 0.5460 | Val MAE 1.6148
[P1] Ep 78: Loss 0.5531 | Val MAE 1.6589
[P1] Ep 79: Loss 0.5517 | Val MAE 1.6347
[P1] Ep 80: Loss 0.5410 | Val MAE 1.5893
[P1] Ep 81: Loss 0.5452 | Val MAE 1.5939
[P1] Ep 82: Loss 0.5403 | Val MAE 1.6005
[P1] Ep 83: Loss 0.5281 | Val MAE 1.5509
[P1] Ep 84: Loss 0.5359 | Val MAE 1.5538
[P1] Ep 85: Loss 0.5294 | Val MAE 1.5749
[P1] Ep 86: Loss 0.5263 | Val MAE 1.6341
[P1] Ep 87: Loss 0.5155 | Val MAE 1.5076
[P1] Ep 88: Loss 0.5284 | Val MAE 1.5936
[P1] Ep 89: Loss 0.5347 | Val MAE 1.5418
[P1] Ep 90: Loss 0.5186 | Val MAE 1.4742
[P1] Ep 91: Loss 0.5206 | Val MAE 1.4581
[P1] Ep 92: Loss 0.5162 | Val MAE 1.5597
[P1] Ep 93: Loss 0.5260 | Val MAE 1.6219
[P1] Ep 94: Loss 0.5119 | Val MAE 1.6092
[P1] Ep 95: Loss 0.5087 | Val MAE 1.5562
[P1] Ep 96: Loss 0.5064 | Val MAE 1.5687
[P1] Ep 97: Loss 0.4960 | Val MAE 1.5216
[P1] Ep 98: Loss 0.5077 | Val MAE 1.5509
[P1] Ep 99: Loss 0.5056 | Val MAE 1.5868
[P1] Ep 100: Loss 0.5018 | Val MAE 1.5762
[P1] Ep 101: Loss 0.4880 | Val MAE 1.5531
[P1] Ep 102: Loss 0.4913 | Val MAE 1.6370
[P1] Ep 103: Loss 0.4858 | Val MAE 1.5505
[P1] Ep 104: Loss 0.4969 | Val MAE 1.5505
[P1] Ep 105: Loss 0.4898 | Val MAE 1.5131
[P1] Ep 106: Loss 0.4883 | Val MAE 1.5105
[P1] Ep 107: Loss 0.4838 | Val MAE 1.5304
[P1] Ep 108: Loss 0.4807 | Val MAE 1.5578
[P1] Ep 109: Loss 0.4854 | Val MAE 1.5953
[P1] Ep 110: Loss 0.4714 | Val MAE 1.5733
[P1] Ep 111: Loss 0.4752 | Val MAE 1.6789
[P1] Ep 112: Loss 0.4722 | Val MAE 1.5894
[P1] Ep 113: Loss 0.4707 | Val MAE 1.5561
[P1] Ep 114: Loss 0.4801 | Val MAE 1.5074
[P1] Ep 115: Loss 0.4720 | Val MAE 1.5490
[P1] Ep 116: Loss 0.4776 | Val MAE 1.5794
[P1] Ep 117: Loss 0.4737 | Val MAE 1.5123
[P1] Ep 118: Loss 0.4716 | Val MAE 1.4210
[P1] Ep 119: Loss 0.4561 | Val MAE 1.5544
[P1] Ep 120: Loss 0.4627 | Val MAE 1.5602
[P1] Ep 121: Loss 0.4689 | Val MAE 1.4857
[P1] Ep 122: Loss 0.4517 | Val MAE 1.6457
[P1] Ep 123: Loss 0.4541 | Val MAE 1.6965
[P1] Ep 124: Loss 0.4539 | Val MAE 1.5543
[P1] Ep 125: Loss 0.4525 | Val MAE 1.5428
[P1] Ep 126: Loss 0.4347 | Val MAE 1.5568
[P1] Ep 127: Loss 0.4434 | Val MAE 1.5452
[P1] Ep 128: Loss 0.4338 | Val MAE 1.5964
[P1] Ep 129: Loss 0.4379 | Val MAE 1.5329
[P1] Ep 130: Loss 0.4381 | Val MAE 1.6307
[P1] Ep 131: Loss 0.4348 | Val MAE 1.5185
[P1] Ep 132: Loss 0.4356 | Val MAE 1.6415
[P1] Ep 133: Loss 0.4250 | Val MAE 1.5734
[P1] Ep 134: Loss 0.4276 | Val MAE 1.5741
[P1] Ep 135: Loss 0.4204 | Val MAE 1.5854
[P1] Ep 136: Loss 0.4304 | Val MAE 1.5983
[P1] Ep 137: Loss 0.4212 | Val MAE 1.5972
[P1] Ep 138: Loss 0.4110 | Val MAE 1.6266
[P1] Ep 139: Loss 0.4227 | Val MAE 1.6060
[P1] Ep 140: Loss 0.4131 | Val MAE 1.6546
[P1] Ep 141: Loss 0.4199 | Val MAE 1.7088
[P1] Ep 142: Loss 0.4041 | Val MAE 1.6122
[P1] Ep 143: Loss 0.4071 | Val MAE 1.6297
[P1] Ep 144: Loss 0.4021 | Val MAE 1.6393
[P1] Ep 145: Loss 0.3970 | Val MAE 1.6786
[P1] Ep 146: Loss 0.4002 | Val MAE 1.6700
[P1] Ep 147: Loss 0.4019 | Val MAE 1.7531
[P1] Ep 148: Loss 0.3987 | Val MAE 1.7107
[P1] Ep 149: Loss 0.3989 | Val MAE 1.7058
[P1] Ep 150: Loss 0.4004 | Val MAE 1.7093
[P1] Ep 151: Loss 0.3883 | Val MAE 1.6775
[P1] Ep 152: Loss 0.3904 | Val MAE 1.6135
[P1] Ep 153: Loss 0.3888 | Val MAE 1.6520
[P1] Ep 154: Loss 0.3892 | Val MAE 1.6393
[P1] Ep 155: Loss 0.3825 | Val MAE 1.7066
[P1] Ep 156: Loss 0.3832 | Val MAE 1.6858
[P1] Ep 157: Loss 0.3714 | Val MAE 1.7244
[P1] Ep 158: Loss 0.3736 | Val MAE 1.6435
[P1] Ep 159: Loss 0.3789 | Val MAE 1.6985
[P1] Ep 160: Loss 0.3685 | Val MAE 1.6259
[P1] Ep 161: Loss 0.3673 | Val MAE 1.6066
[P1] Ep 162: Loss 0.3670 | Val MAE 1.6101
[P1] Ep 163: Loss 0.3621 | Val MAE 1.6389
[P1] Ep 164: Loss 0.3707 | Val MAE 1.7058
[P1] Ep 165: Loss 0.3702 | Val MAE 1.7037
[P1] Ep 166: Loss 0.3629 | Val MAE 1.6290
[P1] Ep 167: Loss 0.3629 | Val MAE 1.7335
[P1] Ep 168: Loss 0.3601 | Val MAE 1.6076
[P1] Ep 169: Loss 0.3545 | Val MAE 1.6731
[P1] Ep 170: Loss 0.3540 | Val MAE 1.7718
[P1] Ep 171: Loss 0.3500 | Val MAE 1.6837
[P1] Ep 172: Loss 0.3414 | Val MAE 1.6717
[P1] Ep 173: Loss 0.3361 | Val MAE 1.6829
[P1] Ep 174: Loss 0.3450 | Val MAE 1.6393
[P1] Ep 175: Loss 0.3465 | Val MAE 1.6935
[P1] Ep 176: Loss 0.3488 | Val MAE 1.6645
[P1] Ep 177: Loss 0.3332 | Val MAE 1.6087
[P1] Ep 178: Loss 0.3360 | Val MAE 1.6587
[P1] Ep 179: Loss 0.3449 | Val MAE 1.6357
[P1] Ep 180: Loss 0.3476 | Val MAE 1.6836
[P1] Ep 181: Loss 0.3271 | Val MAE 1.7277
[P1] Ep 182: Loss 0.3303 | Val MAE 1.6803
[P1] Ep 183: Loss 0.3237 | Val MAE 1.7513
[P1] Ep 184: Loss 0.3397 | Val MAE 1.6779
[P1] Ep 185: Loss 0.3208 | Val MAE 1.6870
[P1] Ep 186: Loss 0.3202 | Val MAE 1.7047
[P1] Ep 187: Loss 0.3179 | Val MAE 1.6939
[P1] Ep 188: Loss 0.3226 | Val MAE 1.6520
[P1] Ep 189: Loss 0.3173 | Val MAE 1.6786
[P1] Ep 190: Loss 0.3146 | Val MAE 1.7155
[P1] Ep 191: Loss 0.3095 | Val MAE 1.6949
[P1] Ep 192: Loss 0.3105 | Val MAE 1.6727
[P1] Ep 193: Loss 0.3124 | Val MAE 1.6382
[P1] Ep 194: Loss 0.3069 | Val MAE 1.7155
[P1] Ep 195: Loss 0.2969 | Val MAE 1.7069
[P1] Ep 196: Loss 0.3107 | Val MAE 1.7211
[P1] Ep 197: Loss 0.3046 | Val MAE 1.6840
[P1] Ep 198: Loss 0.3006 | Val MAE 1.7079
[P1] Ep 199: Loss 0.3046 | Val MAE 1.7507
[P1] Ep 200: Loss 0.2996 | Val MAE 1.6521

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 6.9262 | Val MAE 1.4085 CI 0.6082
[FT] Ep 2: Loss 6.7652 | Val MAE 1.4168 CI 0.6023
[FT] Ep 3: Loss 6.5853 | Val MAE 1.4406 CI 0.6023
[FT] Ep 4: Loss 6.5031 | Val MAE 1.4909 CI 0.6023
[FT] Ep 5: Loss 6.3477 | Val MAE 1.5084 CI 0.6082
[FT] Ep 6: Loss 6.0102 | Val MAE 1.5233 CI 0.5965
[FT] Ep 7: Loss 5.9411 | Val MAE 1.5261 CI 0.5848
[FT] Ep 8: Loss 5.7580 | Val MAE 1.5456 CI 0.5614
[FT] Ep 9: Loss 5.5873 | Val MAE 1.5558 CI 0.5439
[FT] Ep 10: Loss 5.6040 | Val MAE 1.5707 CI 0.5146
[FT] Ep 11: Loss 5.5774 | Val MAE 1.5793 CI 0.5088
[FT] Ep 12: Loss 5.2443 | Val MAE 1.5829 CI 0.5088
[FT] Ep 13: Loss 5.2838 | Val MAE 1.5934 CI 0.5088
[FT] Ep 14: Loss 5.3291 | Val MAE 1.6041 CI 0.5029
[FT] Ep 15: Loss 5.2178 | Val MAE 1.6137 CI 0.5088
[FT] Ep 16: Loss 4.8722 | Val MAE 1.6261 CI 0.5205
[FT] Ep 17: Loss 4.9474 | Val MAE 1.6313 CI 0.5205
[FT] Ep 18: Loss 4.8747 | Val MAE 1.6399 CI 0.5205
[FT] Ep 19: Loss 4.9018 | Val MAE 1.6465 CI 0.5380
[FT] Ep 20: Loss 5.1172 | Val MAE 1.6488 CI 0.5205
[FT] Ep 21: Loss 5.1583 | Val MAE 1.6519 CI 0.5322
[FT] Ep 22: Loss 4.7270 | Val MAE 1.6563 CI 0.5497
[FT] Ep 23: Loss 4.7115 | Val MAE 1.6592 CI 0.5556
[FT] Ep 24: Loss 4.6381 | Val MAE 1.6647 CI 0.5556
[FT] Ep 25: Loss 4.7530 | Val MAE 1.6597 CI 0.5614
[FT] Ep 26: Loss 4.6353 | Val MAE 1.6559 CI 0.5731
[FT] Ep 27: Loss 4.8143 | Val MAE 1.6532 CI 0.5906
[FT] Ep 28: Loss 4.2709 | Val MAE 1.6493 CI 0.5848
[FT] Ep 29: Loss 4.5940 | Val MAE 1.6477 CI 0.5848
[FT] Ep 30: Loss 4.3132 | Val MAE 1.6463 CI 0.5848
[FT] Ep 31: Loss 4.5547 | Val MAE 1.6558 CI 0.5965
[FT] Ep 32: Loss 4.2288 | Val MAE 1.6686 CI 0.5965
[FT] Ep 33: Loss 4.1425 | Val MAE 1.6757 CI 0.5848
[FT] Ep 34: Loss 4.1780 | Val MAE 1.6849 CI 0.5848
[FT] Ep 35: Loss 4.3659 | Val MAE 1.6802 CI 0.5848
[FT] Ep 36: Loss 4.3537 | Val MAE 1.6732 CI 0.5906
[FT] Ep 37: Loss 4.0741 | Val MAE 1.6729 CI 0.5965
[FT] Ep 38: Loss 4.3007 | Val MAE 1.6753 CI 0.5965
[FT] Ep 39: Loss 4.0808 | Val MAE 1.6811 CI 0.5906
[FT] Ep 40: Loss 4.1286 | Val MAE 1.6897 CI 0.5906
[FT] Ep 41: Loss 3.8118 | Val MAE 1.6928 CI 0.5848
[FT] Ep 42: Loss 4.3357 | Val MAE 1.6945 CI 0.5848
[FT] Ep 43: Loss 4.2532 | Val MAE 1.7059 CI 0.5906
[FT] Ep 44: Loss 3.6351 | Val MAE 1.7058 CI 0.6023
[FT] Ep 45: Loss 4.1312 | Val MAE 1.6884 CI 0.6023
[FT] Ep 46: Loss 3.8818 | Val MAE 1.6730 CI 0.6023
[FT] Ep 47: Loss 3.8899 | Val MAE 1.6707 CI 0.6082
[FT] Ep 48: Loss 3.7399 | Val MAE 1.6774 CI 0.6140
[FT] Ep 49: Loss 3.8593 | Val MAE 1.6947 CI 0.6082
[FT] Ep 50: Loss 3.7802 | Val MAE 1.7104 CI 0.6082
[FT] Ep 51: Loss 3.7473 | Val MAE 1.7139 CI 0.6023
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: UCB
   MAE:  1.8162
   RMSE: 2.1918
   CI:   0.3895
   RM2:  0.0216
   MAPE: 30.08 %
   Acc:  20.00 %
------------------------------------------------------------
