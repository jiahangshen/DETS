--- DTA Baseline: GraNd-20 (Ratio: 0.4) ---

>>> [Stage 0] Sampling...

[Sampler] Running GraNd-20 | Target: 9982/24956 (40.0%)
Scanning Source (GraNd-20):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (GraNd-20):   4%|▍         | 1/25 [00:03<01:22,  3.45s/it]Scanning Source (GraNd-20):   8%|▊         | 2/25 [00:03<00:35,  1.55s/it]Scanning Source (GraNd-20):  12%|█▏        | 3/25 [00:03<00:20,  1.05it/s]Scanning Source (GraNd-20):  16%|█▌        | 4/25 [00:04<00:13,  1.52it/s]Scanning Source (GraNd-20):  20%|██        | 5/25 [00:05<00:15,  1.32it/s]Scanning Source (GraNd-20):  24%|██▍       | 6/25 [00:05<00:11,  1.71it/s]Scanning Source (GraNd-20):  28%|██▊       | 7/25 [00:05<00:08,  2.16it/s]Scanning Source (GraNd-20):  32%|███▏      | 8/25 [00:05<00:06,  2.61it/s]Scanning Source (GraNd-20):  36%|███▌      | 9/25 [00:07<00:12,  1.32it/s]Scanning Source (GraNd-20):  40%|████      | 10/25 [00:07<00:08,  1.70it/s]Scanning Source (GraNd-20):  44%|████▍     | 11/25 [00:07<00:06,  2.11it/s]Scanning Source (GraNd-20):  48%|████▊     | 12/25 [00:07<00:05,  2.53it/s]Scanning Source (GraNd-20):  52%|█████▏    | 13/25 [00:09<00:08,  1.36it/s]Scanning Source (GraNd-20):  56%|█████▌    | 14/25 [00:09<00:06,  1.70it/s]Scanning Source (GraNd-20):  60%|██████    | 15/25 [00:09<00:04,  2.10it/s]Scanning Source (GraNd-20):  64%|██████▍   | 16/25 [00:10<00:03,  2.51it/s]Scanning Source (GraNd-20):  68%|██████▊   | 17/25 [00:11<00:06,  1.33it/s]Scanning Source (GraNd-20):  72%|███████▏  | 18/25 [00:11<00:04,  1.70it/s]Scanning Source (GraNd-20):  76%|███████▌  | 19/25 [00:12<00:02,  2.10it/s]Scanning Source (GraNd-20):  80%|████████  | 20/25 [00:12<00:01,  2.52it/s]Scanning Source (GraNd-20):  84%|████████▍ | 21/25 [00:13<00:02,  1.51it/s]Scanning Source (GraNd-20):  88%|████████▊ | 22/25 [00:13<00:01,  1.90it/s]Scanning Source (GraNd-20):  92%|█████████▏| 23/25 [00:14<00:00,  2.32it/s]Scanning Source (GraNd-20):  96%|█████████▌| 24/25 [00:14<00:00,  2.73it/s]                                                                           -> Source reduced: 24956 -> 9982

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.4824 | Val MAE 1.8469
[P1] Ep 2: Loss 1.2379 | Val MAE 1.6911
[P1] Ep 3: Loss 1.0654 | Val MAE 1.6893
[P1] Ep 4: Loss 0.9700 | Val MAE 1.7073
[P1] Ep 5: Loss 0.9309 | Val MAE 1.6396
[P1] Ep 6: Loss 0.9139 | Val MAE 1.7587
[P1] Ep 7: Loss 0.8794 | Val MAE 1.6975
[P1] Ep 8: Loss 0.8811 | Val MAE 1.6939
[P1] Ep 9: Loss 0.8545 | Val MAE 1.7256
[P1] Ep 10: Loss 0.8364 | Val MAE 1.6716
[P1] Ep 11: Loss 0.8198 | Val MAE 1.6428
[P1] Ep 12: Loss 0.8069 | Val MAE 1.6992
[P1] Ep 13: Loss 0.8094 | Val MAE 1.6591
[P1] Ep 14: Loss 0.7898 | Val MAE 1.6981
[P1] Ep 15: Loss 0.7736 | Val MAE 1.6989
[P1] Ep 16: Loss 0.7574 | Val MAE 1.6948
[P1] Ep 17: Loss 0.7732 | Val MAE 1.7351
[P1] Ep 18: Loss 0.7417 | Val MAE 1.6878
[P1] Ep 19: Loss 0.7397 | Val MAE 1.7068
[P1] Ep 20: Loss 0.7439 | Val MAE 1.6883
[P1] Ep 21: Loss 0.7385 | Val MAE 1.6570
[P1] Ep 22: Loss 0.7408 | Val MAE 1.6387
[P1] Ep 23: Loss 0.7228 | Val MAE 1.6425
[P1] Ep 24: Loss 0.7330 | Val MAE 1.6706
[P1] Ep 25: Loss 0.7197 | Val MAE 1.7420
[P1] Ep 26: Loss 0.7149 | Val MAE 1.6657
[P1] Ep 27: Loss 0.7302 | Val MAE 1.6827
[P1] Ep 28: Loss 0.6991 | Val MAE 1.7246
[P1] Ep 29: Loss 0.6889 | Val MAE 1.6595
[P1] Ep 30: Loss 0.7023 | Val MAE 1.6957
[P1] Ep 31: Loss 0.6858 | Val MAE 1.7132
[P1] Ep 32: Loss 0.6900 | Val MAE 1.6261
[P1] Ep 33: Loss 0.6783 | Val MAE 1.6741
[P1] Ep 34: Loss 0.6841 | Val MAE 1.6937
[P1] Ep 35: Loss 0.6818 | Val MAE 1.6455
[P1] Ep 36: Loss 0.6772 | Val MAE 1.6626
[P1] Ep 37: Loss 0.6765 | Val MAE 1.7398
[P1] Ep 38: Loss 0.6585 | Val MAE 1.6984
[P1] Ep 39: Loss 0.6589 | Val MAE 1.7736
[P1] Ep 40: Loss 0.6565 | Val MAE 1.7366
[P1] Ep 41: Loss 0.6517 | Val MAE 1.7269
[P1] Ep 42: Loss 0.6483 | Val MAE 1.7332
[P1] Ep 43: Loss 0.6499 | Val MAE 1.7145
[P1] Ep 44: Loss 0.6612 | Val MAE 1.7666
[P1] Ep 45: Loss 0.6454 | Val MAE 1.7218
[P1] Ep 46: Loss 0.6344 | Val MAE 1.7749
[P1] Ep 47: Loss 0.6318 | Val MAE 1.7304
[P1] Ep 48: Loss 0.6332 | Val MAE 1.8239
[P1] Ep 49: Loss 0.6267 | Val MAE 1.8118
[P1] Ep 50: Loss 0.6319 | Val MAE 1.7886
[P1] Ep 51: Loss 0.6211 | Val MAE 1.7892
[P1] Ep 52: Loss 0.6059 | Val MAE 1.8720
[P1] Ep 53: Loss 0.6099 | Val MAE 1.7149
[P1] Ep 54: Loss 0.6142 | Val MAE 1.8052
[P1] Ep 55: Loss 0.6068 | Val MAE 1.7553
[P1] Ep 56: Loss 0.6154 | Val MAE 1.7801
[P1] Ep 57: Loss 0.6082 | Val MAE 1.7963
[P1] Ep 58: Loss 0.5929 | Val MAE 1.7868
[P1] Ep 59: Loss 0.5983 | Val MAE 1.7579
[P1] Ep 60: Loss 0.5954 | Val MAE 1.8531
[P1] Ep 61: Loss 0.5753 | Val MAE 1.7342
[P1] Ep 62: Loss 0.5867 | Val MAE 1.8370
[P1] Ep 63: Loss 0.5892 | Val MAE 1.7940
[P1] Ep 64: Loss 0.5687 | Val MAE 1.7171
[P1] Ep 65: Loss 0.5794 | Val MAE 1.7505
[P1] Ep 66: Loss 0.5558 | Val MAE 1.7286
[P1] Ep 67: Loss 0.5691 | Val MAE 1.6860
[P1] Ep 68: Loss 0.5440 | Val MAE 1.7122
[P1] Ep 69: Loss 0.5614 | Val MAE 1.6611
[P1] Ep 70: Loss 0.5506 | Val MAE 1.6507
[P1] Ep 71: Loss 0.5446 | Val MAE 1.7879
[P1] Ep 72: Loss 0.5341 | Val MAE 1.7004
[P1] Ep 73: Loss 0.5425 | Val MAE 1.5881
[P1] Ep 74: Loss 0.5338 | Val MAE 1.6850
[P1] Ep 75: Loss 0.5297 | Val MAE 1.6703
[P1] Ep 76: Loss 0.5339 | Val MAE 1.6482
[P1] Ep 77: Loss 0.5302 | Val MAE 1.7139
[P1] Ep 78: Loss 0.5177 | Val MAE 1.7306
[P1] Ep 79: Loss 0.5226 | Val MAE 1.7140
[P1] Ep 80: Loss 0.5097 | Val MAE 1.6433
[P1] Ep 81: Loss 0.5131 | Val MAE 1.6494
[P1] Ep 82: Loss 0.5097 | Val MAE 1.7273
[P1] Ep 83: Loss 0.4967 | Val MAE 1.7222
[P1] Ep 84: Loss 0.5064 | Val MAE 1.6851
[P1] Ep 85: Loss 0.4998 | Val MAE 1.6561
[P1] Ep 86: Loss 0.5018 | Val MAE 1.7815
[P1] Ep 87: Loss 0.4775 | Val MAE 1.7112
[P1] Ep 88: Loss 0.4994 | Val MAE 1.5894
[P1] Ep 89: Loss 0.4969 | Val MAE 1.6680
[P1] Ep 90: Loss 0.4885 | Val MAE 1.7387
[P1] Ep 91: Loss 0.4769 | Val MAE 1.7219
[P1] Ep 92: Loss 0.4786 | Val MAE 1.7297
[P1] Ep 93: Loss 0.4804 | Val MAE 1.7506
[P1] Ep 94: Loss 0.4667 | Val MAE 1.8257
[P1] Ep 95: Loss 0.4674 | Val MAE 1.7653
[P1] Ep 96: Loss 0.4799 | Val MAE 1.6607
[P1] Ep 97: Loss 0.4658 | Val MAE 1.6286
[P1] Ep 98: Loss 0.4525 | Val MAE 1.6171
[P1] Ep 99: Loss 0.4589 | Val MAE 1.7139
[P1] Ep 100: Loss 0.4520 | Val MAE 1.7362
[P1] Ep 101: Loss 0.4539 | Val MAE 1.6574
[P1] Ep 102: Loss 0.4558 | Val MAE 1.6971
[P1] Ep 103: Loss 0.4488 | Val MAE 1.6823
[P1] Ep 104: Loss 0.4449 | Val MAE 1.7271
[P1] Ep 105: Loss 0.4416 | Val MAE 1.6345
[P1] Ep 106: Loss 0.4409 | Val MAE 1.7346
[P1] Ep 107: Loss 0.4330 | Val MAE 1.6416
[P1] Ep 108: Loss 0.4302 | Val MAE 1.7175
[P1] Ep 109: Loss 0.4371 | Val MAE 1.5875
[P1] Ep 110: Loss 0.4359 | Val MAE 1.7410
[P1] Ep 111: Loss 0.4353 | Val MAE 1.7008
[P1] Ep 112: Loss 0.4262 | Val MAE 1.6704
[P1] Ep 113: Loss 0.4254 | Val MAE 1.7130
[P1] Ep 114: Loss 0.4163 | Val MAE 1.6922
[P1] Ep 115: Loss 0.4213 | Val MAE 1.7806
[P1] Ep 116: Loss 0.4192 | Val MAE 1.7131
[P1] Ep 117: Loss 0.4105 | Val MAE 1.7803
[P1] Ep 118: Loss 0.4084 | Val MAE 1.6350
[P1] Ep 119: Loss 0.3960 | Val MAE 1.6693
[P1] Ep 120: Loss 0.4014 | Val MAE 1.7800
[P1] Ep 121: Loss 0.3974 | Val MAE 1.6808
[P1] Ep 122: Loss 0.4002 | Val MAE 1.5894
[P1] Ep 123: Loss 0.3974 | Val MAE 1.6753
[P1] Ep 124: Loss 0.3926 | Val MAE 1.6820
[P1] Ep 125: Loss 0.3904 | Val MAE 1.6912
[P1] Ep 126: Loss 0.3910 | Val MAE 1.7848
[P1] Ep 127: Loss 0.3960 | Val MAE 1.7167
[P1] Ep 128: Loss 0.3880 | Val MAE 1.6958
[P1] Ep 129: Loss 0.3930 | Val MAE 1.7135
[P1] Ep 130: Loss 0.3911 | Val MAE 1.7170
[P1] Ep 131: Loss 0.3909 | Val MAE 1.6666
[P1] Ep 132: Loss 0.3728 | Val MAE 1.7667
[P1] Ep 133: Loss 0.3739 | Val MAE 1.6980
[P1] Ep 134: Loss 0.3767 | Val MAE 1.6754
[P1] Ep 135: Loss 0.3735 | Val MAE 1.7283
[P1] Ep 136: Loss 0.3778 | Val MAE 1.6762
[P1] Ep 137: Loss 0.3653 | Val MAE 1.5331
[P1] Ep 138: Loss 0.3711 | Val MAE 1.6595
[P1] Ep 139: Loss 0.3680 | Val MAE 1.6295
[P1] Ep 140: Loss 0.3678 | Val MAE 1.7418
[P1] Ep 141: Loss 0.3665 | Val MAE 1.7533
[P1] Ep 142: Loss 0.3618 | Val MAE 1.6742
[P1] Ep 143: Loss 0.3603 | Val MAE 1.7300
[P1] Ep 144: Loss 0.3625 | Val MAE 1.6351
[P1] Ep 145: Loss 0.3522 | Val MAE 1.8030
[P1] Ep 146: Loss 0.3494 | Val MAE 1.6407
[P1] Ep 147: Loss 0.3523 | Val MAE 1.7228
[P1] Ep 148: Loss 0.3489 | Val MAE 1.6488
[P1] Ep 149: Loss 0.3419 | Val MAE 1.7285
[P1] Ep 150: Loss 0.3422 | Val MAE 1.6509
[P1] Ep 151: Loss 0.3454 | Val MAE 1.7750
[P1] Ep 152: Loss 0.3363 | Val MAE 1.6282
[P1] Ep 153: Loss 0.3367 | Val MAE 1.7973
[P1] Ep 154: Loss 0.3417 | Val MAE 1.6968
[P1] Ep 155: Loss 0.3370 | Val MAE 1.6495
[P1] Ep 156: Loss 0.3380 | Val MAE 1.6028
[P1] Ep 157: Loss 0.3290 | Val MAE 1.6937
[P1] Ep 158: Loss 0.3237 | Val MAE 1.6341
[P1] Ep 159: Loss 0.3306 | Val MAE 1.6922
[P1] Ep 160: Loss 0.3290 | Val MAE 1.6277
[P1] Ep 161: Loss 0.3255 | Val MAE 1.7017
[P1] Ep 162: Loss 0.3257 | Val MAE 1.6804
[P1] Ep 163: Loss 0.3293 | Val MAE 1.7238
[P1] Ep 164: Loss 0.3105 | Val MAE 1.7123
[P1] Ep 165: Loss 0.3139 | Val MAE 1.7966
[P1] Ep 166: Loss 0.3086 | Val MAE 1.6460
[P1] Ep 167: Loss 0.3092 | Val MAE 1.6364
[P1] Ep 168: Loss 0.3066 | Val MAE 1.6969
[P1] Ep 169: Loss 0.3193 | Val MAE 1.8120
[P1] Ep 170: Loss 0.3077 | Val MAE 1.8330
[P1] Ep 171: Loss 0.2994 | Val MAE 1.7182
[P1] Ep 172: Loss 0.3016 | Val MAE 1.7137
[P1] Ep 173: Loss 0.3005 | Val MAE 1.7100
[P1] Ep 174: Loss 0.2946 | Val MAE 1.7243
[P1] Ep 175: Loss 0.3025 | Val MAE 1.7071
[P1] Ep 176: Loss 0.2991 | Val MAE 1.6757
[P1] Ep 177: Loss 0.2876 | Val MAE 1.7172
[P1] Ep 178: Loss 0.2957 | Val MAE 1.6557
[P1] Ep 179: Loss 0.2849 | Val MAE 1.7360
[P1] Ep 180: Loss 0.2862 | Val MAE 1.7734
[P1] Ep 181: Loss 0.2875 | Val MAE 1.8313
[P1] Ep 182: Loss 0.2783 | Val MAE 1.7974
[P1] Ep 183: Loss 0.2842 | Val MAE 1.7863
[P1] Ep 184: Loss 0.2754 | Val MAE 1.7908
[P1] Ep 185: Loss 0.2811 | Val MAE 1.8943
[P1] Ep 186: Loss 0.2743 | Val MAE 1.8204
[P1] Ep 187: Loss 0.2790 | Val MAE 1.7159
[P1] Ep 188: Loss 0.2619 | Val MAE 1.7588
[P1] Ep 189: Loss 0.2771 | Val MAE 1.8510
[P1] Ep 190: Loss 0.2753 | Val MAE 1.7010
[P1] Ep 191: Loss 0.2687 | Val MAE 1.7946
[P1] Ep 192: Loss 0.2692 | Val MAE 1.6999
[P1] Ep 193: Loss 0.2622 | Val MAE 1.7395
[P1] Ep 194: Loss 0.2706 | Val MAE 1.9126
[P1] Ep 195: Loss 0.2586 | Val MAE 1.5954
[P1] Ep 196: Loss 0.2580 | Val MAE 1.7744
[P1] Ep 197: Loss 0.2595 | Val MAE 1.8399
[P1] Ep 198: Loss 0.2593 | Val MAE 1.7382
[P1] Ep 199: Loss 0.2468 | Val MAE 1.8034
[P1] Ep 200: Loss 0.2600 | Val MAE 1.8741

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 8.6880 | Val MAE 1.5414 CI 0.5439
[FT] Ep 2: Loss 7.4018 | Val MAE 1.5743 CI 0.5673
[FT] Ep 3: Loss 7.1590 | Val MAE 1.5892 CI 0.5439
[FT] Ep 4: Loss 7.2820 | Val MAE 1.5782 CI 0.5322
[FT] Ep 5: Loss 6.4715 | Val MAE 1.5513 CI 0.5439
[FT] Ep 6: Loss 6.5206 | Val MAE 1.5273 CI 0.5497
[FT] Ep 7: Loss 6.5283 | Val MAE 1.5115 CI 0.5497
[FT] Ep 8: Loss 6.5355 | Val MAE 1.5025 CI 0.5556
[FT] Ep 9: Loss 5.9286 | Val MAE 1.4917 CI 0.5556
[FT] Ep 10: Loss 5.9211 | Val MAE 1.4917 CI 0.5614
[FT] Ep 11: Loss 5.7157 | Val MAE 1.4946 CI 0.5673
[FT] Ep 12: Loss 5.8679 | Val MAE 1.4960 CI 0.5673
[FT] Ep 13: Loss 5.7302 | Val MAE 1.4998 CI 0.5614
[FT] Ep 14: Loss 5.5235 | Val MAE 1.5085 CI 0.5673
[FT] Ep 15: Loss 5.3335 | Val MAE 1.5204 CI 0.5556
[FT] Ep 16: Loss 5.3056 | Val MAE 1.5319 CI 0.5673
[FT] Ep 17: Loss 5.1957 | Val MAE 1.5354 CI 0.5731
[FT] Ep 18: Loss 5.1521 | Val MAE 1.5438 CI 0.5673
[FT] Ep 19: Loss 4.8232 | Val MAE 1.5519 CI 0.5789
[FT] Ep 20: Loss 5.0009 | Val MAE 1.5536 CI 0.5906
[FT] Ep 21: Loss 5.0723 | Val MAE 1.5523 CI 0.5965
[FT] Ep 22: Loss 5.0109 | Val MAE 1.5533 CI 0.5965
[FT] Ep 23: Loss 5.2390 | Val MAE 1.5524 CI 0.6023
[FT] Ep 24: Loss 4.9826 | Val MAE 1.5566 CI 0.6023
[FT] Ep 25: Loss 4.5600 | Val MAE 1.5550 CI 0.6199
[FT] Ep 26: Loss 4.4966 | Val MAE 1.5570 CI 0.6199
[FT] Ep 27: Loss 4.8999 | Val MAE 1.5599 CI 0.6140
[FT] Ep 28: Loss 4.6059 | Val MAE 1.5628 CI 0.6199
[FT] Ep 29: Loss 4.7085 | Val MAE 1.5654 CI 0.6199
[FT] Ep 30: Loss 4.6411 | Val MAE 1.5685 CI 0.6199
[FT] Ep 31: Loss 4.3993 | Val MAE 1.5698 CI 0.6316
[FT] Ep 32: Loss 4.7664 | Val MAE 1.5737 CI 0.6140
[FT] Ep 33: Loss 4.1227 | Val MAE 1.5731 CI 0.6199
[FT] Ep 34: Loss 4.5285 | Val MAE 1.5703 CI 0.6257
[FT] Ep 35: Loss 4.3734 | Val MAE 1.5697 CI 0.6257
[FT] Ep 36: Loss 4.2058 | Val MAE 1.5656 CI 0.6199
[FT] Ep 37: Loss 4.0807 | Val MAE 1.5667 CI 0.6257
[FT] Ep 38: Loss 4.3896 | Val MAE 1.5659 CI 0.6257
[FT] Ep 39: Loss 4.4378 | Val MAE 1.5668 CI 0.6316
[FT] Ep 40: Loss 4.0121 | Val MAE 1.5678 CI 0.6316
[FT] Ep 41: Loss 3.9806 | Val MAE 1.5678 CI 0.6316
[FT] Ep 42: Loss 4.0885 | Val MAE 1.5679 CI 0.6316
[FT] Ep 43: Loss 3.8245 | Val MAE 1.5684 CI 0.6316
[FT] Ep 44: Loss 4.1874 | Val MAE 1.5691 CI 0.6257
[FT] Ep 45: Loss 3.9594 | Val MAE 1.5639 CI 0.6257
[FT] Ep 46: Loss 3.9915 | Val MAE 1.5602 CI 0.6316
[FT] Ep 47: Loss 3.7680 | Val MAE 1.5587 CI 0.6316
[FT] Ep 48: Loss 3.7776 | Val MAE 1.5582 CI 0.6374
[FT] Ep 49: Loss 3.8361 | Val MAE 1.5574 CI 0.6374
[FT] Ep 50: Loss 3.6000 | Val MAE 1.5712 CI 0.6491
[FT] Ep 51: Loss 3.6274 | Val MAE 1.5744 CI 0.6374
[FT] Ep 52: Loss 3.6967 | Val MAE 1.5719 CI 0.6374
[FT] Ep 53: Loss 3.3619 | Val MAE 1.5812 CI 0.6316
[FT] Ep 54: Loss 3.5468 | Val MAE 1.5875 CI 0.6316
[FT] Ep 55: Loss 3.1309 | Val MAE 1.5873 CI 0.6257
[FT] Ep 56: Loss 3.4776 | Val MAE 1.5894 CI 0.6257
[FT] Ep 57: Loss 3.1689 | Val MAE 1.5876 CI 0.6257
[FT] Ep 58: Loss 3.3906 | Val MAE 1.5851 CI 0.6199
[FT] Ep 59: Loss 3.3019 | Val MAE 1.6014 CI 0.6140
[FT] Ep 60: Loss 3.2616 | Val MAE 1.6016 CI 0.6140
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: GraNd-20
   MAE:  1.3832
   RMSE: 1.7613
   CI:   0.5737
   RM2:  0.0657
   MAPE: 22.95 %
   Acc:  25.00 %
------------------------------------------------------------
