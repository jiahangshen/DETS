/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
--- DTA Baseline: Hard Random (Ratio: 0.4) ---

>>> [Stage 0] Sampling...

[Sampler] Running Hard Random | Target: 9982/24956 (40.0%)
-> Source reduced: 24956 -> 9982

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.0222 | Val MAE 1.7220
[P1] Ep 2: Loss 0.9777 | Val MAE 2.0670
[P1] Ep 3: Loss 0.9249 | Val MAE 2.2867
[P1] Ep 4: Loss 0.8829 | Val MAE 2.0092
[P1] Ep 5: Loss 0.8324 | Val MAE 2.0369
[P1] Ep 6: Loss 0.8085 | Val MAE 2.0791
[P1] Ep 7: Loss 0.8043 | Val MAE 2.1674
[P1] Ep 8: Loss 0.7957 | Val MAE 1.9724
[P1] Ep 9: Loss 0.7671 | Val MAE 2.0742
[P1] Ep 10: Loss 0.7783 | Val MAE 2.0365
[P1] Ep 11: Loss 0.7572 | Val MAE 2.1656
[P1] Ep 12: Loss 0.7461 | Val MAE 2.0411
[P1] Ep 13: Loss 0.7378 | Val MAE 2.0070
[P1] Ep 14: Loss 0.7375 | Val MAE 2.0053
[P1] Ep 15: Loss 0.6945 | Val MAE 2.0030
[P1] Ep 16: Loss 0.7105 | Val MAE 2.0808
[P1] Ep 17: Loss 0.6870 | Val MAE 2.0580
[P1] Ep 18: Loss 0.6821 | Val MAE 2.0818
[P1] Ep 19: Loss 0.6779 | Val MAE 2.1041
[P1] Ep 20: Loss 0.6796 | Val MAE 2.0240
[P1] Ep 21: Loss 0.6691 | Val MAE 2.0880
[P1] Ep 22: Loss 0.6533 | Val MAE 2.1174
[P1] Ep 23: Loss 0.6702 | Val MAE 2.1236
[P1] Ep 24: Loss 0.6630 | Val MAE 2.1072
[P1] Ep 25: Loss 0.6522 | Val MAE 2.1253
[P1] Ep 26: Loss 0.6567 | Val MAE 2.0614
[P1] Ep 27: Loss 0.6554 | Val MAE 2.0250
[P1] Ep 28: Loss 0.6322 | Val MAE 2.0727
[P1] Ep 29: Loss 0.6355 | Val MAE 2.1213
[P1] Ep 30: Loss 0.6542 | Val MAE 2.2279
[P1] Ep 31: Loss 0.6493 | Val MAE 2.0306
[P1] Ep 32: Loss 0.6322 | Val MAE 1.9690
[P1] Ep 33: Loss 0.6306 | Val MAE 2.0707
[P1] Ep 34: Loss 0.6328 | Val MAE 2.0188
[P1] Ep 35: Loss 0.6291 | Val MAE 2.1124
[P1] Ep 36: Loss 0.6298 | Val MAE 2.0916
[P1] Ep 37: Loss 0.6224 | Val MAE 2.0780
[P1] Ep 38: Loss 0.6213 | Val MAE 2.0353
[P1] Ep 39: Loss 0.6286 | Val MAE 2.0708
[P1] Ep 40: Loss 0.6126 | Val MAE 2.0175
[P1] Ep 41: Loss 0.6056 | Val MAE 2.0536
[P1] Ep 42: Loss 0.6068 | Val MAE 2.1517
[P1] Ep 43: Loss 0.6134 | Val MAE 2.0860
[P1] Ep 44: Loss 0.5875 | Val MAE 2.0662
[P1] Ep 45: Loss 0.5961 | Val MAE 2.0887
[P1] Ep 46: Loss 0.5985 | Val MAE 1.9498
[P1] Ep 47: Loss 0.5945 | Val MAE 2.0815
[P1] Ep 48: Loss 0.5782 | Val MAE 2.0414
[P1] Ep 49: Loss 0.5834 | Val MAE 2.1903
[P1] Ep 50: Loss 0.5594 | Val MAE 2.1204
[P1] Ep 51: Loss 0.5662 | Val MAE 2.1723
[P1] Ep 52: Loss 0.5825 | Val MAE 2.1144
[P1] Ep 53: Loss 0.5737 | Val MAE 2.1189
[P1] Ep 54: Loss 0.5741 | Val MAE 2.0504
[P1] Ep 55: Loss 0.5569 | Val MAE 2.0890
[P1] Ep 56: Loss 0.5527 | Val MAE 2.1632
[P1] Ep 57: Loss 0.5602 | Val MAE 2.1075
[P1] Ep 58: Loss 0.5572 | Val MAE 2.1533
[P1] Ep 59: Loss 0.5534 | Val MAE 2.1727
[P1] Ep 60: Loss 0.5531 | Val MAE 2.1160
[P1] Ep 61: Loss 0.5416 | Val MAE 2.1520
[P1] Ep 62: Loss 0.5340 | Val MAE 2.0214
[P1] Ep 63: Loss 0.5293 | Val MAE 2.0591
[P1] Ep 64: Loss 0.5216 | Val MAE 2.1219
[P1] Ep 65: Loss 0.5328 | Val MAE 2.0185
[P1] Ep 66: Loss 0.5184 | Val MAE 2.0293
[P1] Ep 67: Loss 0.5183 | Val MAE 2.0869
[P1] Ep 68: Loss 0.5258 | Val MAE 2.0241
[P1] Ep 69: Loss 0.5105 | Val MAE 2.1144
[P1] Ep 70: Loss 0.5028 | Val MAE 2.0556
[P1] Ep 71: Loss 0.5046 | Val MAE 2.0511
[P1] Ep 72: Loss 0.5081 | Val MAE 2.1136
[P1] Ep 73: Loss 0.5089 | Val MAE 2.0823
[P1] Ep 74: Loss 0.4916 | Val MAE 1.9418
[P1] Ep 75: Loss 0.5009 | Val MAE 2.0187
[P1] Ep 76: Loss 0.4945 | Val MAE 2.0744
[P1] Ep 77: Loss 0.4839 | Val MAE 1.9799
[P1] Ep 78: Loss 0.4858 | Val MAE 1.9054
[P1] Ep 79: Loss 0.4858 | Val MAE 2.0480
[P1] Ep 80: Loss 0.4707 | Val MAE 1.9904
[P1] Ep 81: Loss 0.4629 | Val MAE 1.9124
[P1] Ep 82: Loss 0.4762 | Val MAE 1.9406
[P1] Ep 83: Loss 0.4785 | Val MAE 2.0158
[P1] Ep 84: Loss 0.4660 | Val MAE 1.8945
[P1] Ep 85: Loss 0.4701 | Val MAE 1.9343
[P1] Ep 86: Loss 0.4636 | Val MAE 1.8851
[P1] Ep 87: Loss 0.4626 | Val MAE 1.8963
[P1] Ep 88: Loss 0.4602 | Val MAE 1.9897
[P1] Ep 89: Loss 0.4604 | Val MAE 1.8598
[P1] Ep 90: Loss 0.4614 | Val MAE 1.9616
[P1] Ep 91: Loss 0.4535 | Val MAE 1.9281
[P1] Ep 92: Loss 0.4471 | Val MAE 1.9178
[P1] Ep 93: Loss 0.4521 | Val MAE 1.9126
[P1] Ep 94: Loss 0.4416 | Val MAE 1.8362
[P1] Ep 95: Loss 0.4432 | Val MAE 1.9147
[P1] Ep 96: Loss 0.4394 | Val MAE 1.7713
[P1] Ep 97: Loss 0.4454 | Val MAE 1.8188
[P1] Ep 98: Loss 0.4348 | Val MAE 1.8490
[P1] Ep 99: Loss 0.4338 | Val MAE 1.9090
[P1] Ep 100: Loss 0.4425 | Val MAE 1.8229
[P1] Ep 101: Loss 0.4334 | Val MAE 1.7345
[P1] Ep 102: Loss 0.4223 | Val MAE 1.8699
[P1] Ep 103: Loss 0.4341 | Val MAE 1.7143
[P1] Ep 104: Loss 0.4275 | Val MAE 1.7794
[P1] Ep 105: Loss 0.4117 | Val MAE 1.7814
[P1] Ep 106: Loss 0.4223 | Val MAE 1.8007
[P1] Ep 107: Loss 0.4243 | Val MAE 1.8113
[P1] Ep 108: Loss 0.4108 | Val MAE 1.9094
[P1] Ep 109: Loss 0.4216 | Val MAE 1.9686
[P1] Ep 110: Loss 0.4165 | Val MAE 1.7553
[P1] Ep 111: Loss 0.4088 | Val MAE 1.8077
[P1] Ep 112: Loss 0.4116 | Val MAE 1.8333
[P1] Ep 113: Loss 0.4138 | Val MAE 1.8199
[P1] Ep 114: Loss 0.4053 | Val MAE 2.0138
[P1] Ep 115: Loss 0.4025 | Val MAE 1.9475
[P1] Ep 116: Loss 0.3970 | Val MAE 2.0371
[P1] Ep 117: Loss 0.4153 | Val MAE 2.1320
[P1] Ep 118: Loss 0.3941 | Val MAE 1.8880
[P1] Ep 119: Loss 0.3915 | Val MAE 1.8594
[P1] Ep 120: Loss 0.3873 | Val MAE 1.9073
[P1] Ep 121: Loss 0.3874 | Val MAE 1.8855
[P1] Ep 122: Loss 0.3836 | Val MAE 1.8389
[P1] Ep 123: Loss 0.3866 | Val MAE 1.8436
[P1] Ep 124: Loss 0.3762 | Val MAE 1.8820
[P1] Ep 125: Loss 0.3883 | Val MAE 1.8245
[P1] Ep 126: Loss 0.3818 | Val MAE 1.8714
[P1] Ep 127: Loss 0.3756 | Val MAE 1.8189
[P1] Ep 128: Loss 0.3781 | Val MAE 1.7917
[P1] Ep 129: Loss 0.3718 | Val MAE 1.9465
[P1] Ep 130: Loss 0.3745 | Val MAE 1.8491
[P1] Ep 131: Loss 0.3860 | Val MAE 1.9296
[P1] Ep 132: Loss 0.3702 | Val MAE 1.8991
[P1] Ep 133: Loss 0.3705 | Val MAE 1.9030
[P1] Ep 134: Loss 0.3741 | Val MAE 1.9194
[P1] Ep 135: Loss 0.3633 | Val MAE 1.7979
[P1] Ep 136: Loss 0.3626 | Val MAE 1.7530
[P1] Ep 137: Loss 0.3505 | Val MAE 1.9379
[P1] Ep 138: Loss 0.3619 | Val MAE 1.8763
[P1] Ep 139: Loss 0.3495 | Val MAE 1.8654
[P1] Ep 140: Loss 0.3571 | Val MAE 1.8525
[P1] Ep 141: Loss 0.3496 | Val MAE 1.9826
[P1] Ep 142: Loss 0.3472 | Val MAE 1.8998
[P1] Ep 143: Loss 0.3562 | Val MAE 1.9232
[P1] Ep 144: Loss 0.3402 | Val MAE 1.8254
[P1] Ep 145: Loss 0.3398 | Val MAE 1.8185
[P1] Ep 146: Loss 0.3317 | Val MAE 1.8621
[P1] Ep 147: Loss 0.3406 | Val MAE 1.9075
[P1] Ep 148: Loss 0.3416 | Val MAE 1.9096
[P1] Ep 149: Loss 0.3431 | Val MAE 1.8123
[P1] Ep 150: Loss 0.3305 | Val MAE 1.8621
[P1] Ep 151: Loss 0.3357 | Val MAE 1.8165
[P1] Ep 152: Loss 0.3263 | Val MAE 1.9229
[P1] Ep 153: Loss 0.3255 | Val MAE 1.9415
[P1] Ep 154: Loss 0.3244 | Val MAE 1.8772
[P1] Ep 155: Loss 0.3299 | Val MAE 1.9484
[P1] Ep 156: Loss 0.3249 | Val MAE 1.9478
[P1] Ep 157: Loss 0.3165 | Val MAE 1.9082
[P1] Ep 158: Loss 0.3133 | Val MAE 1.9430
[P1] Ep 159: Loss 0.3140 | Val MAE 2.0561
[P1] Ep 160: Loss 0.3167 | Val MAE 1.7927
[P1] Ep 161: Loss 0.3068 | Val MAE 1.8950
[P1] Ep 162: Loss 0.3111 | Val MAE 1.8654
[P1] Ep 163: Loss 0.3089 | Val MAE 1.9475
[P1] Ep 164: Loss 0.3031 | Val MAE 1.9396
[P1] Ep 165: Loss 0.3034 | Val MAE 1.8500
[P1] Ep 166: Loss 0.3008 | Val MAE 1.9350
[P1] Ep 167: Loss 0.2870 | Val MAE 1.8856
[P1] Ep 168: Loss 0.2973 | Val MAE 1.9620
[P1] Ep 169: Loss 0.2979 | Val MAE 1.8728
[P1] Ep 170: Loss 0.2892 | Val MAE 1.8726
[P1] Ep 171: Loss 0.2931 | Val MAE 1.9664
[P1] Ep 172: Loss 0.2924 | Val MAE 1.8181
[P1] Ep 173: Loss 0.2843 | Val MAE 1.9149
[P1] Ep 174: Loss 0.2923 | Val MAE 1.8168
[P1] Ep 175: Loss 0.2802 | Val MAE 1.9021
[P1] Ep 176: Loss 0.2777 | Val MAE 1.8673
[P1] Ep 177: Loss 0.2814 | Val MAE 1.8978
[P1] Ep 178: Loss 0.2750 | Val MAE 1.9683
[P1] Ep 179: Loss 0.2748 | Val MAE 2.0543
[P1] Ep 180: Loss 0.2679 | Val MAE 1.9935
[P1] Ep 181: Loss 0.2721 | Val MAE 2.0259
[P1] Ep 182: Loss 0.2640 | Val MAE 1.9197
[P1] Ep 183: Loss 0.2690 | Val MAE 1.9966
[P1] Ep 184: Loss 0.2622 | Val MAE 1.9022
[P1] Ep 185: Loss 0.2637 | Val MAE 1.9028
[P1] Ep 186: Loss 0.2628 | Val MAE 1.9308
[P1] Ep 187: Loss 0.2580 | Val MAE 1.9864
[P1] Ep 188: Loss 0.2615 | Val MAE 1.9370
[P1] Ep 189: Loss 0.2614 | Val MAE 1.9117
[P1] Ep 190: Loss 0.2546 | Val MAE 1.8935
[P1] Ep 191: Loss 0.2571 | Val MAE 1.8244
[P1] Ep 192: Loss 0.2519 | Val MAE 1.9074
[P1] Ep 193: Loss 0.2428 | Val MAE 1.7964
[P1] Ep 194: Loss 0.2454 | Val MAE 1.8738
[P1] Ep 195: Loss 0.2462 | Val MAE 1.8101
[P1] Ep 196: Loss 0.2495 | Val MAE 1.8533
[P1] Ep 197: Loss 0.2429 | Val MAE 1.8231
[P1] Ep 198: Loss 0.2480 | Val MAE 1.9916
[P1] Ep 199: Loss 0.2389 | Val MAE 1.8916
[P1] Ep 200: Loss 0.2318 | Val MAE 1.9533

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 6.4371 | Val MAE 1.5505 CI 0.5146
[FT] Ep 2: Loss 6.2110 | Val MAE 1.5240 CI 0.5029
[FT] Ep 3: Loss 6.2512 | Val MAE 1.5055 CI 0.4971
[FT] Ep 4: Loss 6.0786 | Val MAE 1.4827 CI 0.4971
[FT] Ep 5: Loss 5.9964 | Val MAE 1.4981 CI 0.4912
[FT] Ep 6: Loss 5.9372 | Val MAE 1.5050 CI 0.4971
[FT] Ep 7: Loss 5.7685 | Val MAE 1.5098 CI 0.4737
[FT] Ep 8: Loss 5.8200 | Val MAE 1.5007 CI 0.4737
[FT] Ep 9: Loss 5.7149 | Val MAE 1.5011 CI 0.4678
[FT] Ep 10: Loss 5.4334 | Val MAE 1.5089 CI 0.4795
[FT] Ep 11: Loss 5.3354 | Val MAE 1.5261 CI 0.4971
[FT] Ep 12: Loss 5.8614 | Val MAE 1.5474 CI 0.5088
[FT] Ep 13: Loss 5.7734 | Val MAE 1.5628 CI 0.5146
[FT] Ep 14: Loss 5.5632 | Val MAE 1.5760 CI 0.5146
[FT] Ep 15: Loss 5.3883 | Val MAE 1.5912 CI 0.4620
[FT] Ep 16: Loss 5.3673 | Val MAE 1.6003 CI 0.4269
[FT] Ep 17: Loss 5.4481 | Val MAE 1.6178 CI 0.3977
[FT] Ep 18: Loss 5.4388 | Val MAE 1.6328 CI 0.3801
[FT] Ep 19: Loss 5.1133 | Val MAE 1.6493 CI 0.3860
[FT] Ep 20: Loss 5.2714 | Val MAE 1.6596 CI 0.3977
[FT] Ep 21: Loss 5.3191 | Val MAE 1.6748 CI 0.4035
[FT] Ep 22: Loss 5.3236 | Val MAE 1.6929 CI 0.4035
[FT] Ep 23: Loss 5.4067 | Val MAE 1.7018 CI 0.3977
[FT] Ep 24: Loss 5.3356 | Val MAE 1.7089 CI 0.3918
[FT] Ep 25: Loss 5.1081 | Val MAE 1.7207 CI 0.3977
[FT] Ep 26: Loss 5.6422 | Val MAE 1.7319 CI 0.4094
[FT] Ep 27: Loss 5.3101 | Val MAE 1.7322 CI 0.4094
[FT] Ep 28: Loss 5.3445 | Val MAE 1.7373 CI 0.4035
[FT] Ep 29: Loss 5.2727 | Val MAE 1.7437 CI 0.4035
[FT] Ep 30: Loss 5.2043 | Val MAE 1.7443 CI 0.4035
[FT] Ep 31: Loss 5.1814 | Val MAE 1.7462 CI 0.4035
[FT] Ep 32: Loss 5.1800 | Val MAE 1.7503 CI 0.4211
[FT] Ep 33: Loss 5.3657 | Val MAE 1.7593 CI 0.4327
[FT] Ep 34: Loss 5.1233 | Val MAE 1.7635 CI 0.4386
[FT] Ep 35: Loss 5.1723 | Val MAE 1.7718 CI 0.4444
[FT] Ep 36: Loss 5.1755 | Val MAE 1.7763 CI 0.4386
[FT] Ep 37: Loss 5.5347 | Val MAE 1.7832 CI 0.4386
[FT] Ep 38: Loss 4.8271 | Val MAE 1.7843 CI 0.4503
[FT] Ep 39: Loss 4.9749 | Val MAE 1.7878 CI 0.4678
[FT] Ep 40: Loss 5.3668 | Val MAE 1.7939 CI 0.4678
[FT] Ep 41: Loss 4.9757 | Val MAE 1.8042 CI 0.4503
[FT] Ep 42: Loss 5.5838 | Val MAE 1.8016 CI 0.4386
[FT] Ep 43: Loss 5.4893 | Val MAE 1.8057 CI 0.4444
[FT] Ep 44: Loss 5.0233 | Val MAE 1.8145 CI 0.4503
[FT] Ep 45: Loss 4.7198 | Val MAE 1.8179 CI 0.4620
[FT] Ep 46: Loss 5.0685 | Val MAE 1.8102 CI 0.4620
[FT] Ep 47: Loss 5.2640 | Val MAE 1.8026 CI 0.4620
[FT] Ep 48: Loss 5.3009 | Val MAE 1.8089 CI 0.4620
[FT] Ep 49: Loss 5.2957 | Val MAE 1.8160 CI 0.4444
[FT] Ep 50: Loss 4.9102 | Val MAE 1.8146 CI 0.4444
[FT] Ep 51: Loss 4.9731 | Val MAE 1.8183 CI 0.4444
[FT] Ep 52: Loss 5.5088 | Val MAE 1.8209 CI 0.4444
[FT] Ep 53: Loss 5.1294 | Val MAE 1.8307 CI 0.4503
[FT] Ep 54: Loss 5.2049 | Val MAE 1.8342 CI 0.4678
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: Hard Random
   MAE:  1.6078
   RMSE: 2.0086
   CI:   0.3000
   RM2:  0.0617
   MAPE: 27.98 %
   Acc:  30.00 %
------------------------------------------------------------
