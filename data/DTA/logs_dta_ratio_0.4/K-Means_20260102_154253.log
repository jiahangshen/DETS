--- DTA Baseline: K-Means (Ratio: 0.4) ---

>>> [Stage 0] Sampling...

[Sampler] Running K-Means | Target: 9982/24956 (40.0%)
Scanning Source (K-Means):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (K-Means):   4%|▍         | 1/25 [00:03<01:24,  3.54s/it]Scanning Source (K-Means):   8%|▊         | 2/25 [00:03<00:36,  1.58s/it]Scanning Source (K-Means):  12%|█▏        | 3/25 [00:03<00:21,  1.04it/s]Scanning Source (K-Means):  16%|█▌        | 4/25 [00:04<00:14,  1.48it/s]Scanning Source (K-Means):  20%|██        | 5/25 [00:05<00:20,  1.02s/it]Scanning Source (K-Means):  24%|██▍       | 6/25 [00:06<00:14,  1.34it/s]Scanning Source (K-Means):  28%|██▊       | 7/25 [00:06<00:10,  1.75it/s]Scanning Source (K-Means):  32%|███▏      | 8/25 [00:06<00:07,  2.14it/s]Scanning Source (K-Means):  36%|███▌      | 9/25 [00:08<00:13,  1.17it/s]Scanning Source (K-Means):  40%|████      | 10/25 [00:08<00:09,  1.53it/s]Scanning Source (K-Means):  44%|████▍     | 11/25 [00:08<00:07,  1.92it/s]Scanning Source (K-Means):  48%|████▊     | 12/25 [00:08<00:05,  2.34it/s]Scanning Source (K-Means):  52%|█████▏    | 13/25 [00:10<00:10,  1.19it/s]Scanning Source (K-Means):  56%|█████▌    | 14/25 [00:10<00:07,  1.54it/s]Scanning Source (K-Means):  60%|██████    | 15/25 [00:11<00:05,  1.93it/s]Scanning Source (K-Means):  64%|██████▍   | 16/25 [00:11<00:03,  2.29it/s]Scanning Source (K-Means):  68%|██████▊   | 17/25 [00:13<00:06,  1.20it/s]Scanning Source (K-Means):  72%|███████▏  | 18/25 [00:13<00:04,  1.52it/s]Scanning Source (K-Means):  76%|███████▌  | 19/25 [00:13<00:03,  1.91it/s]Scanning Source (K-Means):  80%|████████  | 20/25 [00:13<00:02,  2.32it/s]Scanning Source (K-Means):  84%|████████▍ | 21/25 [00:15<00:02,  1.36it/s]Scanning Source (K-Means):  88%|████████▊ | 22/25 [00:15<00:01,  1.73it/s]Scanning Source (K-Means):  92%|█████████▏| 23/25 [00:15<00:00,  2.13it/s]Scanning Source (K-Means):  96%|█████████▌| 24/25 [00:15<00:00,  2.54it/s]                                                                             Running MiniBatchKMeans...
Clusters:   0%|          | 0/5000 [00:00<?, ?it/s]Clusters:  46%|████▌     | 2296/5000 [00:00<00:00, 22953.62it/s]Clusters:  95%|█████████▌| 4755/5000 [00:00<00:00, 23912.58it/s]                                                                -> Source reduced: 24956 -> 8788

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.1175 | Val MAE 1.9998
[P1] Ep 2: Loss 0.9954 | Val MAE 1.9929
[P1] Ep 3: Loss 0.9220 | Val MAE 2.0820
[P1] Ep 4: Loss 0.8745 | Val MAE 2.3761
[P1] Ep 5: Loss 0.8477 | Val MAE 2.1534
[P1] Ep 6: Loss 0.8258 | Val MAE 2.2609
[P1] Ep 7: Loss 0.8135 | Val MAE 2.0031
[P1] Ep 8: Loss 0.7966 | Val MAE 2.0673
[P1] Ep 9: Loss 0.7918 | Val MAE 1.9630
[P1] Ep 10: Loss 0.7826 | Val MAE 2.1279
[P1] Ep 11: Loss 0.7725 | Val MAE 2.0596
[P1] Ep 12: Loss 0.7638 | Val MAE 2.1938
[P1] Ep 13: Loss 0.7426 | Val MAE 2.0493
[P1] Ep 14: Loss 0.7397 | Val MAE 2.0186
[P1] Ep 15: Loss 0.7094 | Val MAE 2.0996
[P1] Ep 16: Loss 0.7041 | Val MAE 2.0177
[P1] Ep 17: Loss 0.7251 | Val MAE 2.1068
[P1] Ep 18: Loss 0.7112 | Val MAE 2.0806
[P1] Ep 19: Loss 0.7184 | Val MAE 2.1414
[P1] Ep 20: Loss 0.6914 | Val MAE 2.0046
[P1] Ep 21: Loss 0.6970 | Val MAE 1.9144
[P1] Ep 22: Loss 0.6829 | Val MAE 1.9401
[P1] Ep 23: Loss 0.6915 | Val MAE 2.0931
[P1] Ep 24: Loss 0.6729 | Val MAE 2.1076
[P1] Ep 25: Loss 0.6812 | Val MAE 2.1366
[P1] Ep 26: Loss 0.6585 | Val MAE 1.9057
[P1] Ep 27: Loss 0.6753 | Val MAE 2.1054
[P1] Ep 28: Loss 0.6705 | Val MAE 2.0478
[P1] Ep 29: Loss 0.6637 | Val MAE 2.0396
[P1] Ep 30: Loss 0.6691 | Val MAE 1.9732
[P1] Ep 31: Loss 0.6414 | Val MAE 1.9918
[P1] Ep 32: Loss 0.6527 | Val MAE 1.9411
[P1] Ep 33: Loss 0.6561 | Val MAE 1.9663
[P1] Ep 34: Loss 0.6607 | Val MAE 1.9938
[P1] Ep 35: Loss 0.6422 | Val MAE 1.9065
[P1] Ep 36: Loss 0.6311 | Val MAE 2.0480
[P1] Ep 37: Loss 0.6459 | Val MAE 2.0981
[P1] Ep 38: Loss 0.6370 | Val MAE 1.9978
[P1] Ep 39: Loss 0.6250 | Val MAE 2.1286
[P1] Ep 40: Loss 0.6274 | Val MAE 2.0959
[P1] Ep 41: Loss 0.6336 | Val MAE 1.9717
[P1] Ep 42: Loss 0.6282 | Val MAE 1.9994
[P1] Ep 43: Loss 0.6234 | Val MAE 2.0261
[P1] Ep 44: Loss 0.6130 | Val MAE 2.1105
[P1] Ep 45: Loss 0.6135 | Val MAE 2.1120
[P1] Ep 46: Loss 0.6136 | Val MAE 2.1421
[P1] Ep 47: Loss 0.6179 | Val MAE 2.1066
[P1] Ep 48: Loss 0.6059 | Val MAE 2.0700
[P1] Ep 49: Loss 0.5927 | Val MAE 2.0274
[P1] Ep 50: Loss 0.5791 | Val MAE 2.0142
[P1] Ep 51: Loss 0.6105 | Val MAE 2.1501
[P1] Ep 52: Loss 0.5830 | Val MAE 2.1346
[P1] Ep 53: Loss 0.5738 | Val MAE 2.0180
[P1] Ep 54: Loss 0.5939 | Val MAE 2.1325
[P1] Ep 55: Loss 0.5740 | Val MAE 1.9582
[P1] Ep 56: Loss 0.5829 | Val MAE 2.1094
[P1] Ep 57: Loss 0.5869 | Val MAE 2.1580
[P1] Ep 58: Loss 0.5696 | Val MAE 2.1158
[P1] Ep 59: Loss 0.5616 | Val MAE 2.1072
[P1] Ep 60: Loss 0.5731 | Val MAE 2.1224
[P1] Ep 61: Loss 0.5612 | Val MAE 2.1152
[P1] Ep 62: Loss 0.5529 | Val MAE 1.9646
[P1] Ep 63: Loss 0.5565 | Val MAE 2.0032
[P1] Ep 64: Loss 0.5546 | Val MAE 2.0405
[P1] Ep 65: Loss 0.5524 | Val MAE 2.1835
[P1] Ep 66: Loss 0.5383 | Val MAE 2.0909
[P1] Ep 67: Loss 0.5286 | Val MAE 2.1156
[P1] Ep 68: Loss 0.5369 | Val MAE 2.1466
[P1] Ep 69: Loss 0.5186 | Val MAE 2.1590
[P1] Ep 70: Loss 0.5391 | Val MAE 2.0368
[P1] Ep 71: Loss 0.5203 | Val MAE 2.0401
[P1] Ep 72: Loss 0.5290 | Val MAE 2.1248
[P1] Ep 73: Loss 0.5284 | Val MAE 2.0371
[P1] Ep 74: Loss 0.5162 | Val MAE 2.1469
[P1] Ep 75: Loss 0.5171 | Val MAE 2.1975
[P1] Ep 76: Loss 0.5142 | Val MAE 2.0513
[P1] Ep 77: Loss 0.5040 | Val MAE 2.0669
[P1] Ep 78: Loss 0.5066 | Val MAE 2.1591
[P1] Ep 79: Loss 0.4922 | Val MAE 2.0555
[P1] Ep 80: Loss 0.5010 | Val MAE 2.0911
[P1] Ep 81: Loss 0.5126 | Val MAE 2.0684
[P1] Ep 82: Loss 0.4982 | Val MAE 2.0354
[P1] Ep 83: Loss 0.4976 | Val MAE 2.0804
[P1] Ep 84: Loss 0.5080 | Val MAE 2.0409
[P1] Ep 85: Loss 0.4904 | Val MAE 2.1099
[P1] Ep 86: Loss 0.4849 | Val MAE 2.0640
[P1] Ep 87: Loss 0.4919 | Val MAE 2.0423
[P1] Ep 88: Loss 0.4866 | Val MAE 2.0123
[P1] Ep 89: Loss 0.4853 | Val MAE 1.9747
[P1] Ep 90: Loss 0.4877 | Val MAE 2.0325
[P1] Ep 91: Loss 0.4625 | Val MAE 1.9839
[P1] Ep 92: Loss 0.4782 | Val MAE 1.9120
[P1] Ep 93: Loss 0.4782 | Val MAE 1.8990
[P1] Ep 94: Loss 0.4729 | Val MAE 1.9512
[P1] Ep 95: Loss 0.4780 | Val MAE 1.9806
[P1] Ep 96: Loss 0.4706 | Val MAE 2.1189
[P1] Ep 97: Loss 0.4675 | Val MAE 1.9673
[P1] Ep 98: Loss 0.4655 | Val MAE 1.8661
[P1] Ep 99: Loss 0.4586 | Val MAE 1.9795
[P1] Ep 100: Loss 0.4634 | Val MAE 2.2130
[P1] Ep 101: Loss 0.4589 | Val MAE 1.9392
[P1] Ep 102: Loss 0.4558 | Val MAE 2.0726
[P1] Ep 103: Loss 0.4448 | Val MAE 2.0232
[P1] Ep 104: Loss 0.4471 | Val MAE 1.8750
[P1] Ep 105: Loss 0.4485 | Val MAE 1.9822
[P1] Ep 106: Loss 0.4500 | Val MAE 1.9875
[P1] Ep 107: Loss 0.4519 | Val MAE 1.9368
[P1] Ep 108: Loss 0.4488 | Val MAE 1.8814
[P1] Ep 109: Loss 0.4395 | Val MAE 1.8291
[P1] Ep 110: Loss 0.4480 | Val MAE 1.8665
[P1] Ep 111: Loss 0.4363 | Val MAE 1.9526
[P1] Ep 112: Loss 0.4300 | Val MAE 2.0141
[P1] Ep 113: Loss 0.4310 | Val MAE 1.8610
[P1] Ep 114: Loss 0.4260 | Val MAE 1.7756
[P1] Ep 115: Loss 0.4314 | Val MAE 1.7634
[P1] Ep 116: Loss 0.4251 | Val MAE 1.9307
[P1] Ep 117: Loss 0.4309 | Val MAE 1.7880
[P1] Ep 118: Loss 0.4224 | Val MAE 2.0064
[P1] Ep 119: Loss 0.4281 | Val MAE 1.8333
[P1] Ep 120: Loss 0.4234 | Val MAE 1.8533
[P1] Ep 121: Loss 0.4125 | Val MAE 1.8956
[P1] Ep 122: Loss 0.4199 | Val MAE 1.7835
[P1] Ep 123: Loss 0.4001 | Val MAE 1.8679
[P1] Ep 124: Loss 0.4106 | Val MAE 2.0760
[P1] Ep 125: Loss 0.4095 | Val MAE 1.7475
[P1] Ep 126: Loss 0.4021 | Val MAE 1.9519
[P1] Ep 127: Loss 0.4087 | Val MAE 1.9496
[P1] Ep 128: Loss 0.4012 | Val MAE 1.9475
[P1] Ep 129: Loss 0.4008 | Val MAE 1.8154
[P1] Ep 130: Loss 0.4062 | Val MAE 2.0045
[P1] Ep 131: Loss 0.3901 | Val MAE 1.9736
[P1] Ep 132: Loss 0.3930 | Val MAE 1.8092
[P1] Ep 133: Loss 0.3969 | Val MAE 1.9357
[P1] Ep 134: Loss 0.3927 | Val MAE 1.9228
[P1] Ep 135: Loss 0.4008 | Val MAE 1.8565
[P1] Ep 136: Loss 0.3767 | Val MAE 1.9656
[P1] Ep 137: Loss 0.3834 | Val MAE 1.9497
[P1] Ep 138: Loss 0.3822 | Val MAE 2.0223
[P1] Ep 139: Loss 0.3836 | Val MAE 2.0654
[P1] Ep 140: Loss 0.3744 | Val MAE 1.9969
[P1] Ep 141: Loss 0.3705 | Val MAE 1.8320
[P1] Ep 142: Loss 0.3736 | Val MAE 1.9307
[P1] Ep 143: Loss 0.3649 | Val MAE 1.8442
[P1] Ep 144: Loss 0.3613 | Val MAE 1.7326
[P1] Ep 145: Loss 0.3754 | Val MAE 1.8936
[P1] Ep 146: Loss 0.3667 | Val MAE 1.9157
[P1] Ep 147: Loss 0.3466 | Val MAE 1.9076
[P1] Ep 148: Loss 0.3580 | Val MAE 1.9891
[P1] Ep 149: Loss 0.3523 | Val MAE 1.9940
[P1] Ep 150: Loss 0.3626 | Val MAE 1.8942
[P1] Ep 151: Loss 0.3505 | Val MAE 2.0322
[P1] Ep 152: Loss 0.3496 | Val MAE 1.8018
[P1] Ep 153: Loss 0.3517 | Val MAE 1.8965
[P1] Ep 154: Loss 0.3517 | Val MAE 1.9670
[P1] Ep 155: Loss 0.3574 | Val MAE 1.8431
[P1] Ep 156: Loss 0.3450 | Val MAE 1.8029
[P1] Ep 157: Loss 0.3398 | Val MAE 1.8000
[P1] Ep 158: Loss 0.3306 | Val MAE 1.9761
[P1] Ep 159: Loss 0.3313 | Val MAE 2.0500
[P1] Ep 160: Loss 0.3354 | Val MAE 1.8999
[P1] Ep 161: Loss 0.3310 | Val MAE 1.8989
[P1] Ep 162: Loss 0.3193 | Val MAE 1.8280
[P1] Ep 163: Loss 0.3310 | Val MAE 1.9697
[P1] Ep 164: Loss 0.3247 | Val MAE 1.9607
[P1] Ep 165: Loss 0.3174 | Val MAE 2.0236
[P1] Ep 166: Loss 0.3242 | Val MAE 2.0516
[P1] Ep 167: Loss 0.3159 | Val MAE 2.0030
[P1] Ep 168: Loss 0.3198 | Val MAE 1.9204
[P1] Ep 169: Loss 0.3246 | Val MAE 1.9452
[P1] Ep 170: Loss 0.3145 | Val MAE 1.8622
[P1] Ep 171: Loss 0.3122 | Val MAE 1.9097
[P1] Ep 172: Loss 0.3169 | Val MAE 1.9790
[P1] Ep 173: Loss 0.3129 | Val MAE 2.1019
[P1] Ep 174: Loss 0.3061 | Val MAE 2.0433
[P1] Ep 175: Loss 0.3034 | Val MAE 2.0991
[P1] Ep 176: Loss 0.3047 | Val MAE 1.7734
[P1] Ep 177: Loss 0.3099 | Val MAE 1.9568
[P1] Ep 178: Loss 0.3045 | Val MAE 2.0358
[P1] Ep 179: Loss 0.3001 | Val MAE 2.0203
[P1] Ep 180: Loss 0.3020 | Val MAE 1.9176
[P1] Ep 181: Loss 0.2969 | Val MAE 1.9292
[P1] Ep 182: Loss 0.2968 | Val MAE 2.0120
[P1] Ep 183: Loss 0.3005 | Val MAE 1.9839
[P1] Ep 184: Loss 0.2949 | Val MAE 1.9473
[P1] Ep 185: Loss 0.2953 | Val MAE 2.0307
[P1] Ep 186: Loss 0.2906 | Val MAE 2.1157
[P1] Ep 187: Loss 0.2929 | Val MAE 1.9496
[P1] Ep 188: Loss 0.2896 | Val MAE 1.9825
[P1] Ep 189: Loss 0.2854 | Val MAE 2.0353
[P1] Ep 190: Loss 0.2836 | Val MAE 2.0759
[P1] Ep 191: Loss 0.2876 | Val MAE 2.0458
[P1] Ep 192: Loss 0.2758 | Val MAE 2.1502
[P1] Ep 193: Loss 0.2678 | Val MAE 2.1160
[P1] Ep 194: Loss 0.2703 | Val MAE 2.0654
[P1] Ep 195: Loss 0.2711 | Val MAE 2.0926
[P1] Ep 196: Loss 0.2721 | Val MAE 1.9862
[P1] Ep 197: Loss 0.2718 | Val MAE 1.8073
[P1] Ep 198: Loss 0.2763 | Val MAE 2.0625
[P1] Ep 199: Loss 0.2696 | Val MAE 1.9264
[P1] Ep 200: Loss 0.2723 | Val MAE 1.9092

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 6.5368 | Val MAE 1.5418 CI 0.5088
[FT] Ep 2: Loss 6.8921 | Val MAE 1.4911 CI 0.5029
[FT] Ep 3: Loss 6.5837 | Val MAE 1.4468 CI 0.5789
[FT] Ep 4: Loss 6.1754 | Val MAE 1.4393 CI 0.5789
[FT] Ep 5: Loss 6.2260 | Val MAE 1.4458 CI 0.5906
[FT] Ep 6: Loss 6.5751 | Val MAE 1.4561 CI 0.6140
[FT] Ep 7: Loss 6.1010 | Val MAE 1.4636 CI 0.5965
[FT] Ep 8: Loss 5.8452 | Val MAE 1.4698 CI 0.6082
[FT] Ep 9: Loss 6.0715 | Val MAE 1.4711 CI 0.6023
[FT] Ep 10: Loss 6.2694 | Val MAE 1.4839 CI 0.5906
[FT] Ep 11: Loss 5.8263 | Val MAE 1.4910 CI 0.5848
[FT] Ep 12: Loss 5.6408 | Val MAE 1.5019 CI 0.5789
[FT] Ep 13: Loss 5.6334 | Val MAE 1.5118 CI 0.5556
[FT] Ep 14: Loss 5.6933 | Val MAE 1.5228 CI 0.5439
[FT] Ep 15: Loss 5.4595 | Val MAE 1.5378 CI 0.5380
[FT] Ep 16: Loss 5.4792 | Val MAE 1.5441 CI 0.5322
[FT] Ep 17: Loss 5.6881 | Val MAE 1.5537 CI 0.5380
[FT] Ep 18: Loss 5.4033 | Val MAE 1.5620 CI 0.5322
[FT] Ep 19: Loss 5.4451 | Val MAE 1.5722 CI 0.5263
[FT] Ep 20: Loss 5.3028 | Val MAE 1.5827 CI 0.5263
[FT] Ep 21: Loss 5.5526 | Val MAE 1.5965 CI 0.5322
[FT] Ep 22: Loss 5.3533 | Val MAE 1.6039 CI 0.5263
[FT] Ep 23: Loss 5.3659 | Val MAE 1.6132 CI 0.5322
[FT] Ep 24: Loss 5.2875 | Val MAE 1.6197 CI 0.5380
[FT] Ep 25: Loss 5.0041 | Val MAE 1.6252 CI 0.5439
[FT] Ep 26: Loss 5.3077 | Val MAE 1.6316 CI 0.5146
[FT] Ep 27: Loss 5.1349 | Val MAE 1.6341 CI 0.5146
[FT] Ep 28: Loss 5.0052 | Val MAE 1.6399 CI 0.5205
[FT] Ep 29: Loss 5.0554 | Val MAE 1.6408 CI 0.5205
[FT] Ep 30: Loss 5.1347 | Val MAE 1.6465 CI 0.5263
[FT] Ep 31: Loss 5.1169 | Val MAE 1.6536 CI 0.5322
[FT] Ep 32: Loss 5.1782 | Val MAE 1.6618 CI 0.5263
[FT] Ep 33: Loss 4.9830 | Val MAE 1.6688 CI 0.5380
[FT] Ep 34: Loss 5.4193 | Val MAE 1.6743 CI 0.5380
[FT] Ep 35: Loss 4.9313 | Val MAE 1.6764 CI 0.5322
[FT] Ep 36: Loss 4.9986 | Val MAE 1.6806 CI 0.5322
[FT] Ep 37: Loss 4.9719 | Val MAE 1.6839 CI 0.5263
[FT] Ep 38: Loss 4.9655 | Val MAE 1.6900 CI 0.5263
[FT] Ep 39: Loss 5.0161 | Val MAE 1.6936 CI 0.5263
[FT] Ep 40: Loss 4.9335 | Val MAE 1.6977 CI 0.5322
[FT] Ep 41: Loss 4.8810 | Val MAE 1.7015 CI 0.5322
[FT] Ep 42: Loss 5.1238 | Val MAE 1.7072 CI 0.5322
[FT] Ep 43: Loss 4.6839 | Val MAE 1.7098 CI 0.5322
[FT] Ep 44: Loss 5.0192 | Val MAE 1.7124 CI 0.5322
[FT] Ep 45: Loss 5.0710 | Val MAE 1.7160 CI 0.5263
[FT] Ep 46: Loss 4.8985 | Val MAE 1.7187 CI 0.5263
[FT] Ep 47: Loss 4.9116 | Val MAE 1.7203 CI 0.5263
[FT] Ep 48: Loss 4.7345 | Val MAE 1.7248 CI 0.5205
[FT] Ep 49: Loss 4.7398 | Val MAE 1.7253 CI 0.5205
[FT] Ep 50: Loss 4.4214 | Val MAE 1.7299 CI 0.5205
[FT] Ep 51: Loss 4.7652 | Val MAE 1.7308 CI 0.5205
[FT] Ep 52: Loss 4.7996 | Val MAE 1.7323 CI 0.5205
[FT] Ep 53: Loss 4.7323 | Val MAE 1.7378 CI 0.5263
[FT] Ep 54: Loss 4.7086 | Val MAE 1.7428 CI 0.5263
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: K-Means
   MAE:  1.4940
   RMSE: 1.8891
   CI:   0.4842
   RM2:  0.0022
   MAPE: 25.49 %
   Acc:  30.00 %
------------------------------------------------------------
