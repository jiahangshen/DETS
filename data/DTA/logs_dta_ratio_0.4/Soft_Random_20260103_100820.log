--- DTA Baseline: Soft Random (Ratio: 0.4) ---

>>> [Stage 0] Sampling...

[Sampler] Running Soft Random | Target: 9982/24956 (40.0%)
Scanning Source (Soft Random):   0%|          | 0/25 [00:00<?, ?it/s]/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
Scanning Source (Soft Random):   4%|▍         | 1/25 [00:03<01:15,  3.14s/it]Scanning Source (Soft Random):   8%|▊         | 2/25 [00:03<00:32,  1.42s/it]Scanning Source (Soft Random):  12%|█▏        | 3/25 [00:03<00:19,  1.15it/s]Scanning Source (Soft Random):  16%|█▌        | 4/25 [00:03<00:12,  1.64it/s]Scanning Source (Soft Random):  20%|██        | 5/25 [00:05<00:17,  1.13it/s]Scanning Source (Soft Random):  24%|██▍       | 6/25 [00:05<00:12,  1.53it/s]Scanning Source (Soft Random):  28%|██▊       | 7/25 [00:05<00:09,  1.95it/s]Scanning Source (Soft Random):  32%|███▏      | 8/25 [00:05<00:07,  2.33it/s]Scanning Source (Soft Random):  36%|███▌      | 9/25 [00:07<00:10,  1.46it/s]Scanning Source (Soft Random):  40%|████      | 10/25 [00:07<00:08,  1.81it/s]Scanning Source (Soft Random):  44%|████▍     | 11/25 [00:07<00:06,  2.23it/s]Scanning Source (Soft Random):  48%|████▊     | 12/25 [00:07<00:04,  2.65it/s]Scanning Source (Soft Random):  52%|█████▏    | 13/25 [00:08<00:07,  1.69it/s]Scanning Source (Soft Random):  56%|█████▌    | 14/25 [00:09<00:05,  2.09it/s]Scanning Source (Soft Random):  60%|██████    | 15/25 [00:09<00:03,  2.51it/s]Scanning Source (Soft Random):  64%|██████▍   | 16/25 [00:09<00:03,  2.92it/s]Scanning Source (Soft Random):  68%|██████▊   | 17/25 [00:10<00:05,  1.55it/s]Scanning Source (Soft Random):  72%|███████▏  | 18/25 [00:11<00:03,  1.94it/s]Scanning Source (Soft Random):  76%|███████▌  | 19/25 [00:11<00:02,  2.35it/s]Scanning Source (Soft Random):  80%|████████  | 20/25 [00:11<00:01,  2.77it/s]Scanning Source (Soft Random):  84%|████████▍ | 21/25 [00:12<00:02,  1.81it/s]Scanning Source (Soft Random):  88%|████████▊ | 22/25 [00:12<00:01,  2.23it/s]Scanning Source (Soft Random):  92%|█████████▏| 23/25 [00:12<00:00,  2.65it/s]Scanning Source (Soft Random):  96%|█████████▌| 24/25 [00:13<00:00,  3.04it/s]                                                                              -> Source reduced: 24956 -> 9982

=== Phase 1: Source Pre-training ===
[P1] Ep 1: Loss 2.1959 | Val MAE 1.8331
[P1] Ep 2: Loss 1.1318 | Val MAE 2.0515
[P1] Ep 3: Loss 1.0592 | Val MAE 1.9647
[P1] Ep 4: Loss 1.0155 | Val MAE 1.9700
[P1] Ep 5: Loss 0.9706 | Val MAE 1.9645
[P1] Ep 6: Loss 0.9535 | Val MAE 2.0560
[P1] Ep 7: Loss 0.9468 | Val MAE 1.8865
[P1] Ep 8: Loss 0.9372 | Val MAE 2.0530
[P1] Ep 9: Loss 0.9014 | Val MAE 1.9211
[P1] Ep 10: Loss 0.9042 | Val MAE 1.9783
[P1] Ep 11: Loss 0.8810 | Val MAE 1.8318
[P1] Ep 12: Loss 0.8516 | Val MAE 1.9832
[P1] Ep 13: Loss 0.8311 | Val MAE 1.9040
[P1] Ep 14: Loss 0.8196 | Val MAE 1.8754
[P1] Ep 15: Loss 0.8062 | Val MAE 1.9176
[P1] Ep 16: Loss 0.8104 | Val MAE 2.1371
[P1] Ep 17: Loss 0.8084 | Val MAE 1.9692
[P1] Ep 18: Loss 0.8001 | Val MAE 1.9941
[P1] Ep 19: Loss 0.7819 | Val MAE 1.9791
[P1] Ep 20: Loss 0.7714 | Val MAE 2.0110
[P1] Ep 21: Loss 0.7868 | Val MAE 1.9892
[P1] Ep 22: Loss 0.7711 | Val MAE 1.9694
[P1] Ep 23: Loss 0.7622 | Val MAE 1.9701
[P1] Ep 24: Loss 0.7703 | Val MAE 1.9288
[P1] Ep 25: Loss 0.7631 | Val MAE 2.0491
[P1] Ep 26: Loss 0.7568 | Val MAE 1.8526
[P1] Ep 27: Loss 0.7487 | Val MAE 1.9785
[P1] Ep 28: Loss 0.7421 | Val MAE 1.9219
[P1] Ep 29: Loss 0.7458 | Val MAE 1.9446
[P1] Ep 30: Loss 0.7481 | Val MAE 2.0273
[P1] Ep 31: Loss 0.7518 | Val MAE 1.9160
[P1] Ep 32: Loss 0.7313 | Val MAE 1.9334
[P1] Ep 33: Loss 0.7482 | Val MAE 2.0534
[P1] Ep 34: Loss 0.7464 | Val MAE 1.9777
[P1] Ep 35: Loss 0.7359 | Val MAE 1.9563
[P1] Ep 36: Loss 0.7324 | Val MAE 2.0617
[P1] Ep 37: Loss 0.7164 | Val MAE 1.9618
[P1] Ep 38: Loss 0.7079 | Val MAE 1.9184
[P1] Ep 39: Loss 0.7220 | Val MAE 1.9994
[P1] Ep 40: Loss 0.7056 | Val MAE 1.9491
[P1] Ep 41: Loss 0.7020 | Val MAE 1.9702
[P1] Ep 42: Loss 0.7079 | Val MAE 2.0046
[P1] Ep 43: Loss 0.7092 | Val MAE 1.9808
[P1] Ep 44: Loss 0.6880 | Val MAE 2.0425
[P1] Ep 45: Loss 0.7034 | Val MAE 1.9999
[P1] Ep 46: Loss 0.7024 | Val MAE 1.9763
[P1] Ep 47: Loss 0.7080 | Val MAE 1.9592
[P1] Ep 48: Loss 0.6808 | Val MAE 1.9053
[P1] Ep 49: Loss 0.6726 | Val MAE 2.0227
[P1] Ep 50: Loss 0.6807 | Val MAE 2.0043
[P1] Ep 51: Loss 0.6926 | Val MAE 2.0723
[P1] Ep 52: Loss 0.6709 | Val MAE 1.9969
[P1] Ep 53: Loss 0.6690 | Val MAE 2.1482
[P1] Ep 54: Loss 0.6586 | Val MAE 1.9968
[P1] Ep 55: Loss 0.6592 | Val MAE 2.0251
[P1] Ep 56: Loss 0.6592 | Val MAE 1.9777
[P1] Ep 57: Loss 0.6549 | Val MAE 2.0958
[P1] Ep 58: Loss 0.6605 | Val MAE 2.0927
[P1] Ep 59: Loss 0.6525 | Val MAE 1.9678
[P1] Ep 60: Loss 0.6466 | Val MAE 2.0612
[P1] Ep 61: Loss 0.6405 | Val MAE 2.0736
[P1] Ep 62: Loss 0.6341 | Val MAE 2.0506
[P1] Ep 63: Loss 0.6395 | Val MAE 2.0486
[P1] Ep 64: Loss 0.6338 | Val MAE 2.0314
[P1] Ep 65: Loss 0.6308 | Val MAE 1.8844
[P1] Ep 66: Loss 0.6206 | Val MAE 1.9933
[P1] Ep 67: Loss 0.6227 | Val MAE 2.0328
[P1] Ep 68: Loss 0.6089 | Val MAE 1.9696
[P1] Ep 69: Loss 0.5956 | Val MAE 2.0124
[P1] Ep 70: Loss 0.6009 | Val MAE 1.7642
[P1] Ep 71: Loss 0.6056 | Val MAE 1.8916
[P1] Ep 72: Loss 0.5954 | Val MAE 2.0136
[P1] Ep 73: Loss 0.5897 | Val MAE 1.9174
[P1] Ep 74: Loss 0.5662 | Val MAE 1.9434
[P1] Ep 75: Loss 0.5889 | Val MAE 2.0042
[P1] Ep 76: Loss 0.5735 | Val MAE 2.0401
[P1] Ep 77: Loss 0.5824 | Val MAE 2.0137
[P1] Ep 78: Loss 0.5644 | Val MAE 2.0249
[P1] Ep 79: Loss 0.5594 | Val MAE 1.9927
[P1] Ep 80: Loss 0.5509 | Val MAE 1.9495
[P1] Ep 81: Loss 0.5545 | Val MAE 1.8572
[P1] Ep 82: Loss 0.5556 | Val MAE 1.8889
[P1] Ep 83: Loss 0.5496 | Val MAE 1.8620
[P1] Ep 84: Loss 0.5491 | Val MAE 1.9647
[P1] Ep 85: Loss 0.5305 | Val MAE 1.9225
[P1] Ep 86: Loss 0.5280 | Val MAE 1.8616
[P1] Ep 87: Loss 0.5271 | Val MAE 1.9313
[P1] Ep 88: Loss 0.5234 | Val MAE 1.8871
[P1] Ep 89: Loss 0.5271 | Val MAE 1.8828
[P1] Ep 90: Loss 0.5275 | Val MAE 1.8895
[P1] Ep 91: Loss 0.5310 | Val MAE 1.9881
[P1] Ep 92: Loss 0.5231 | Val MAE 1.8891
[P1] Ep 93: Loss 0.5045 | Val MAE 1.8435
[P1] Ep 94: Loss 0.5206 | Val MAE 2.0069
[P1] Ep 95: Loss 0.5009 | Val MAE 1.8654
[P1] Ep 96: Loss 0.5035 | Val MAE 1.9150
[P1] Ep 97: Loss 0.5046 | Val MAE 2.0188
[P1] Ep 98: Loss 0.4903 | Val MAE 1.9265
[P1] Ep 99: Loss 0.4976 | Val MAE 1.9985
[P1] Ep 100: Loss 0.4950 | Val MAE 1.8785
[P1] Ep 101: Loss 0.4919 | Val MAE 1.9160
[P1] Ep 102: Loss 0.4911 | Val MAE 1.9429
[P1] Ep 103: Loss 0.4859 | Val MAE 1.9604
[P1] Ep 104: Loss 0.4817 | Val MAE 1.9393
[P1] Ep 105: Loss 0.4770 | Val MAE 1.8855
[P1] Ep 106: Loss 0.4825 | Val MAE 1.9436
[P1] Ep 107: Loss 0.4756 | Val MAE 1.8727
[P1] Ep 108: Loss 0.4742 | Val MAE 2.0168
[P1] Ep 109: Loss 0.4686 | Val MAE 1.9712
[P1] Ep 110: Loss 0.4655 | Val MAE 1.8617
[P1] Ep 111: Loss 0.4568 | Val MAE 1.8239
[P1] Ep 112: Loss 0.4678 | Val MAE 1.8598
[P1] Ep 113: Loss 0.4623 | Val MAE 1.9068
[P1] Ep 114: Loss 0.4636 | Val MAE 1.7622
[P1] Ep 115: Loss 0.4470 | Val MAE 1.9041
[P1] Ep 116: Loss 0.4532 | Val MAE 1.9912
[P1] Ep 117: Loss 0.4485 | Val MAE 1.8480
[P1] Ep 118: Loss 0.4426 | Val MAE 1.8911
[P1] Ep 119: Loss 0.4458 | Val MAE 2.0017
[P1] Ep 120: Loss 0.4443 | Val MAE 1.8758
[P1] Ep 121: Loss 0.4378 | Val MAE 1.8776
[P1] Ep 122: Loss 0.4350 | Val MAE 1.8571
[P1] Ep 123: Loss 0.4342 | Val MAE 1.8915
[P1] Ep 124: Loss 0.4165 | Val MAE 1.8073
[P1] Ep 125: Loss 0.4356 | Val MAE 1.8593
[P1] Ep 126: Loss 0.4254 | Val MAE 1.8226
[P1] Ep 127: Loss 0.4213 | Val MAE 1.8930
[P1] Ep 128: Loss 0.4235 | Val MAE 1.9412
[P1] Ep 129: Loss 0.4179 | Val MAE 1.9327
[P1] Ep 130: Loss 0.4243 | Val MAE 1.8081
[P1] Ep 131: Loss 0.4148 | Val MAE 1.8286
[P1] Ep 132: Loss 0.4071 | Val MAE 1.7760
[P1] Ep 133: Loss 0.4027 | Val MAE 1.8142
[P1] Ep 134: Loss 0.4177 | Val MAE 2.0267
[P1] Ep 135: Loss 0.4015 | Val MAE 1.9023
[P1] Ep 136: Loss 0.4039 | Val MAE 1.8832
[P1] Ep 137: Loss 0.3977 | Val MAE 1.9113
[P1] Ep 138: Loss 0.3921 | Val MAE 1.9069
[P1] Ep 139: Loss 0.3947 | Val MAE 1.9156
[P1] Ep 140: Loss 0.3830 | Val MAE 1.8377
[P1] Ep 141: Loss 0.3977 | Val MAE 1.9900
[P1] Ep 142: Loss 0.3833 | Val MAE 1.9476
[P1] Ep 143: Loss 0.3784 | Val MAE 1.8882
[P1] Ep 144: Loss 0.3747 | Val MAE 1.9549
[P1] Ep 145: Loss 0.3665 | Val MAE 1.9424
[P1] Ep 146: Loss 0.3662 | Val MAE 1.8320
[P1] Ep 147: Loss 0.3693 | Val MAE 1.8069
[P1] Ep 148: Loss 0.3679 | Val MAE 1.9189
[P1] Ep 149: Loss 0.3605 | Val MAE 1.8559
[P1] Ep 150: Loss 0.3653 | Val MAE 1.9069
[P1] Ep 151: Loss 0.3562 | Val MAE 2.0031
[P1] Ep 152: Loss 0.3568 | Val MAE 1.9536
[P1] Ep 153: Loss 0.3519 | Val MAE 1.9521
[P1] Ep 154: Loss 0.3551 | Val MAE 1.9192
[P1] Ep 155: Loss 0.3557 | Val MAE 1.9794
[P1] Ep 156: Loss 0.3461 | Val MAE 1.8241
[P1] Ep 157: Loss 0.3452 | Val MAE 1.9496
[P1] Ep 158: Loss 0.3436 | Val MAE 1.9156
[P1] Ep 159: Loss 0.3335 | Val MAE 1.9663
[P1] Ep 160: Loss 0.3347 | Val MAE 1.9439
[P1] Ep 161: Loss 0.3353 | Val MAE 1.8158
[P1] Ep 162: Loss 0.3344 | Val MAE 1.8689
[P1] Ep 163: Loss 0.3263 | Val MAE 1.9402
[P1] Ep 164: Loss 0.3255 | Val MAE 1.8448
[P1] Ep 165: Loss 0.3201 | Val MAE 1.8950
[P1] Ep 166: Loss 0.3311 | Val MAE 1.8734
[P1] Ep 167: Loss 0.3150 | Val MAE 1.7982
[P1] Ep 168: Loss 0.3108 | Val MAE 1.9015
[P1] Ep 169: Loss 0.3103 | Val MAE 1.8720
[P1] Ep 170: Loss 0.3056 | Val MAE 1.9068
[P1] Ep 171: Loss 0.3087 | Val MAE 1.8271
[P1] Ep 172: Loss 0.3078 | Val MAE 1.8282
[P1] Ep 173: Loss 0.3100 | Val MAE 1.8689
[P1] Ep 174: Loss 0.3029 | Val MAE 2.0192
[P1] Ep 175: Loss 0.3055 | Val MAE 1.8902
[P1] Ep 176: Loss 0.3006 | Val MAE 1.8684
[P1] Ep 177: Loss 0.2975 | Val MAE 1.9001
[P1] Ep 178: Loss 0.2945 | Val MAE 1.8426
[P1] Ep 179: Loss 0.2881 | Val MAE 1.8158
[P1] Ep 180: Loss 0.2894 | Val MAE 1.9152
[P1] Ep 181: Loss 0.2831 | Val MAE 1.8136
[P1] Ep 182: Loss 0.2817 | Val MAE 1.7755
[P1] Ep 183: Loss 0.2856 | Val MAE 1.9014
[P1] Ep 184: Loss 0.2789 | Val MAE 1.9838
[P1] Ep 185: Loss 0.2816 | Val MAE 1.7470
[P1] Ep 186: Loss 0.2825 | Val MAE 1.9409
[P1] Ep 187: Loss 0.2759 | Val MAE 1.8998
[P1] Ep 188: Loss 0.2720 | Val MAE 2.0020
[P1] Ep 189: Loss 0.2733 | Val MAE 1.8870
[P1] Ep 190: Loss 0.2688 | Val MAE 1.9231
[P1] Ep 191: Loss 0.2581 | Val MAE 1.8394
[P1] Ep 192: Loss 0.2721 | Val MAE 1.8793
[P1] Ep 193: Loss 0.2633 | Val MAE 1.9323
[P1] Ep 194: Loss 0.2614 | Val MAE 1.9104
[P1] Ep 195: Loss 0.2638 | Val MAE 1.9004
[P1] Ep 196: Loss 0.2649 | Val MAE 1.8784
[P1] Ep 197: Loss 0.2566 | Val MAE 1.8465
[P1] Ep 198: Loss 0.2518 | Val MAE 1.8473
[P1] Ep 199: Loss 0.2543 | Val MAE 1.9223
[P1] Ep 200: Loss 0.2529 | Val MAE 1.8341

=== Phase 2: Target Fine-tuning ===
Freezing backbone layers...
[FT] Ep 1: Loss 8.0745 | Val MAE 1.6622 CI 0.5263
[FT] Ep 2: Loss 8.2839 | Val MAE 1.6124 CI 0.5322
[FT] Ep 3: Loss 7.1074 | Val MAE 1.5721 CI 0.5497
[FT] Ep 4: Loss 6.5170 | Val MAE 1.5503 CI 0.5380
[FT] Ep 5: Loss 6.4818 | Val MAE 1.5367 CI 0.5439
[FT] Ep 6: Loss 6.0703 | Val MAE 1.5372 CI 0.5439
[FT] Ep 7: Loss 6.0836 | Val MAE 1.5459 CI 0.5439
[FT] Ep 8: Loss 5.6675 | Val MAE 1.5558 CI 0.5439
[FT] Ep 9: Loss 5.4971 | Val MAE 1.5642 CI 0.5205
[FT] Ep 10: Loss 5.6101 | Val MAE 1.5757 CI 0.5322
[FT] Ep 11: Loss 4.8800 | Val MAE 1.5879 CI 0.5380
[FT] Ep 12: Loss 5.0965 | Val MAE 1.6015 CI 0.5205
[FT] Ep 13: Loss 5.0545 | Val MAE 1.6133 CI 0.5205
[FT] Ep 14: Loss 4.7771 | Val MAE 1.6243 CI 0.5263
[FT] Ep 15: Loss 4.7906 | Val MAE 1.6392 CI 0.5205
[FT] Ep 16: Loss 4.9247 | Val MAE 1.6512 CI 0.5205
[FT] Ep 17: Loss 4.5921 | Val MAE 1.6600 CI 0.5263
[FT] Ep 18: Loss 4.3046 | Val MAE 1.6730 CI 0.5146
[FT] Ep 19: Loss 4.4565 | Val MAE 1.6896 CI 0.5088
[FT] Ep 20: Loss 4.4582 | Val MAE 1.7018 CI 0.5088
[FT] Ep 21: Loss 4.5260 | Val MAE 1.7184 CI 0.5205
[FT] Ep 22: Loss 4.3056 | Val MAE 1.7321 CI 0.5205
[FT] Ep 23: Loss 4.0839 | Val MAE 1.7465 CI 0.5205
[FT] Ep 24: Loss 4.2088 | Val MAE 1.7460 CI 0.5322
[FT] Ep 25: Loss 4.3143 | Val MAE 1.7462 CI 0.5263
[FT] Ep 26: Loss 3.8858 | Val MAE 1.7493 CI 0.5205
[FT] Ep 27: Loss 3.8539 | Val MAE 1.7519 CI 0.5205
[FT] Ep 28: Loss 4.1966 | Val MAE 1.7583 CI 0.5146
[FT] Ep 29: Loss 3.9261 | Val MAE 1.7647 CI 0.5146
[FT] Ep 30: Loss 3.8152 | Val MAE 1.7752 CI 0.5146
[FT] Ep 31: Loss 3.6578 | Val MAE 1.7809 CI 0.5205
[FT] Ep 32: Loss 3.6433 | Val MAE 1.7874 CI 0.5146
[FT] Ep 33: Loss 3.4888 | Val MAE 1.7927 CI 0.5205
[FT] Ep 34: Loss 3.4672 | Val MAE 1.7908 CI 0.5205
[FT] Ep 35: Loss 3.4831 | Val MAE 1.7912 CI 0.5146
[FT] Ep 36: Loss 3.5534 | Val MAE 1.7950 CI 0.5205
[FT] Ep 37: Loss 3.6074 | Val MAE 1.8020 CI 0.5205
[FT] Ep 38: Loss 3.5871 | Val MAE 1.8193 CI 0.5088
[FT] Ep 39: Loss 3.5352 | Val MAE 1.8264 CI 0.5088
[FT] Ep 40: Loss 3.7131 | Val MAE 1.8291 CI 0.5146
[FT] Ep 41: Loss 3.9689 | Val MAE 1.8301 CI 0.5263
[FT] Ep 42: Loss 3.4244 | Val MAE 1.8310 CI 0.5263
[FT] Ep 43: Loss 3.3971 | Val MAE 1.8301 CI 0.5263
[FT] Ep 44: Loss 3.3080 | Val MAE 1.8246 CI 0.5263
[FT] Ep 45: Loss 3.1982 | Val MAE 1.8233 CI 0.5205
[FT] Ep 46: Loss 3.1736 | Val MAE 1.8237 CI 0.5205
[FT] Ep 47: Loss 3.1895 | Val MAE 1.8274 CI 0.5205
[FT] Ep 48: Loss 3.1456 | Val MAE 1.8298 CI 0.5146
[FT] Ep 49: Loss 3.0410 | Val MAE 1.8282 CI 0.5205
[FT] Ep 50: Loss 3.1778 | Val MAE 1.8323 CI 0.5205
[FT] Ep 51: Loss 2.9960 | Val MAE 1.8494 CI 0.5205
[FT] Ep 52: Loss 3.1929 | Val MAE 1.8570 CI 0.5263
[FT] Ep 53: Loss 2.8878 | Val MAE 1.8577 CI 0.5263
[FT] Ep 54: Loss 3.0605 | Val MAE 1.8598 CI 0.5263
[FT] Ep 55: Loss 3.1559 | Val MAE 1.8664 CI 0.5322
Early stopping triggered.

>>> Final Test Evaluation
------------------------------------------------------------
[BASELINE RESULT] Method: Soft Random
   MAE:  1.5032
   RMSE: 1.8945
   CI:   0.5158
   RM2:  0.0003
   MAPE: 24.67 %
   Acc:  25.00 %
------------------------------------------------------------
