Namespace(source_csv='./drug-target/Davis.csv', target_csv='./drug-target/CASF2016_graph_valid.csv', pretrained='/Davis80_best_model.pt', max_seq_len=1024, batch_size=128, epochs=200, ft_epochs=150, lr=5e-05, weight_decay=0.0001, dropout=0.1, device='cuda:0', save_dir='DETS_DTA', num_prototypes=30, tau_high=0.85, sigma_0=0.15, gamma=10, alpha=0.9, w_min=0.0001, edl_lambda=0.01, mlp_hidden='256,128')
Loading datasets...
Initializing DETS Projection Head (High Variance)...

=== PHASE 1: DETS Source Training ===
-> Extracting Anchors from Target (CASF)...
/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
   Running K-Means (K=30)...
-> Anchors Established: 30 prototypes.
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 1] Active Samples: 7486/24956
[P1] Ep 1 | Loss 3.0095 | Val MAE 1.6038 CI 0.5673 Acc 31.6%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 2] Active Samples: 7486/24956
[P1] Ep 2 | Loss 1.2608 | Val MAE 1.9072 CI 0.5789 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 3] Active Samples: 7486/24956
[P1] Ep 3 | Loss 1.1234 | Val MAE 1.9974 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 4] Active Samples: 7486/24956
[P1] Ep 4 | Loss 1.0946 | Val MAE 1.9333 CI 0.5965 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 5] Active Samples: 7486/24956
[P1] Ep 5 | Loss 1.0622 | Val MAE 1.9954 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 6] Active Samples: 7486/24956
[P1] Ep 6 | Loss 1.0326 | Val MAE 1.9809 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 7] Active Samples: 7486/24956
[P1] Ep 7 | Loss 1.0284 | Val MAE 1.9318 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 8] Active Samples: 7486/24956
[P1] Ep 8 | Loss 1.0079 | Val MAE 2.0674 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 9] Active Samples: 7486/24956
[P1] Ep 9 | Loss 1.0105 | Val MAE 2.0106 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 10] Active Samples: 7486/24956
[P1] Ep 10 | Loss 0.9822 | Val MAE 1.9747 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 11] Active Samples: 7486/24956
[P1] Ep 11 | Loss 0.9557 | Val MAE 1.9942 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 12] Active Samples: 7486/24956
[P1] Ep 12 | Loss 0.9734 | Val MAE 2.0582 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 13] Active Samples: 7486/24956
[P1] Ep 13 | Loss 0.9622 | Val MAE 1.9994 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 14] Active Samples: 7486/24956
[P1] Ep 14 | Loss 0.9426 | Val MAE 2.0070 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 15] Active Samples: 7486/24956
[P1] Ep 15 | Loss 0.9492 | Val MAE 2.0335 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 16] Active Samples: 7486/24956
[P1] Ep 16 | Loss 0.9392 | Val MAE 2.0047 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 17] Active Samples: 7486/24956
[P1] Ep 17 | Loss 0.9114 | Val MAE 2.0336 CI 0.6725 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 18] Active Samples: 7486/24956
[P1] Ep 18 | Loss 0.9191 | Val MAE 2.0144 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 19] Active Samples: 7486/24956
[P1] Ep 19 | Loss 0.8979 | Val MAE 1.9182 CI 0.6491 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 20] Active Samples: 7486/24956
[P1] Ep 20 | Loss 0.9099 | Val MAE 1.9830 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 21] Active Samples: 7486/24956
[P1] Ep 21 | Loss 0.8873 | Val MAE 2.0021 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 22] Active Samples: 7486/24956
[P1] Ep 22 | Loss 0.8641 | Val MAE 1.9632 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 23] Active Samples: 7486/24956
[P1] Ep 23 | Loss 0.8963 | Val MAE 1.9508 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 24] Active Samples: 7486/24956
[P1] Ep 24 | Loss 0.8944 | Val MAE 2.0847 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 25] Active Samples: 7486/24956
[P1] Ep 25 | Loss 0.8720 | Val MAE 1.9786 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 26] Active Samples: 7486/24956
[P1] Ep 26 | Loss 0.8761 | Val MAE 2.0300 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 27] Active Samples: 7486/24956
[P1] Ep 27 | Loss 0.8702 | Val MAE 1.9533 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 28] Active Samples: 7486/24956
[P1] Ep 28 | Loss 0.8689 | Val MAE 2.0119 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 29] Active Samples: 7486/24956
[P1] Ep 29 | Loss 0.8713 | Val MAE 1.9651 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 30] Active Samples: 7486/24956
[P1] Ep 30 | Loss 0.8675 | Val MAE 2.0019 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 31] Active Samples: 7486/24956
[P1] Ep 31 | Loss 0.8581 | Val MAE 1.9965 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 32] Active Samples: 7486/24956
[P1] Ep 32 | Loss 0.8695 | Val MAE 2.0077 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 33] Active Samples: 7486/24956
[P1] Ep 33 | Loss 0.8424 | Val MAE 2.0272 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 34] Active Samples: 7486/24956
[P1] Ep 34 | Loss 0.8206 | Val MAE 2.0338 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 35] Active Samples: 7486/24956
[P1] Ep 35 | Loss 0.8218 | Val MAE 2.0113 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 36] Active Samples: 7486/24956
[P1] Ep 36 | Loss 0.8342 | Val MAE 2.0054 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 37] Active Samples: 7486/24956
[P1] Ep 37 | Loss 0.8432 | Val MAE 2.0050 CI 0.6725 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 38] Active Samples: 7486/24956
[P1] Ep 38 | Loss 0.8196 | Val MAE 2.0637 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 39] Active Samples: 7486/24956
[P1] Ep 39 | Loss 0.8418 | Val MAE 2.0298 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 40] Active Samples: 7486/24956
[P1] Ep 40 | Loss 0.8605 | Val MAE 1.9931 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 41] Active Samples: 7486/24956
[P1] Ep 41 | Loss 0.8976 | Val MAE 1.9654 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 42] Active Samples: 7486/24956
[P1] Ep 42 | Loss 0.9761 | Val MAE 1.9140 CI 0.6257 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 43] Active Samples: 7486/24956
[P1] Ep 43 | Loss 0.9683 | Val MAE 1.9755 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 44] Active Samples: 7486/24956
[P1] Ep 44 | Loss 0.9823 | Val MAE 1.9697 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 45] Active Samples: 7486/24956
[P1] Ep 45 | Loss 0.9780 | Val MAE 2.0086 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 46] Active Samples: 7486/24956
[P1] Ep 46 | Loss 0.9478 | Val MAE 1.9575 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 47] Active Samples: 7486/24956
[P1] Ep 47 | Loss 0.9610 | Val MAE 1.9798 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 48] Active Samples: 7486/24956
[P1] Ep 48 | Loss 0.9478 | Val MAE 1.9744 CI 0.5614 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 49] Active Samples: 7486/24956
[P1] Ep 49 | Loss 0.8290 | Val MAE 2.0008 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 50] Active Samples: 7486/24956
[P1] Ep 50 | Loss 0.8918 | Val MAE 2.0361 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 51] Active Samples: 7486/24956
[P1] Ep 51 | Loss 0.9722 | Val MAE 1.9449 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 52] Active Samples: 7486/24956
[P1] Ep 52 | Loss 0.9748 | Val MAE 2.0213 CI 0.5673 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 53] Active Samples: 7486/24956
[P1] Ep 53 | Loss 1.0215 | Val MAE 1.9681 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 54] Active Samples: 7486/24956
[P1] Ep 54 | Loss 0.9479 | Val MAE 1.9683 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 55] Active Samples: 7486/24956
[P1] Ep 55 | Loss 1.0861 | Val MAE 1.9799 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 56] Active Samples: 7486/24956
[P1] Ep 56 | Loss 1.0642 | Val MAE 1.9501 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 57] Active Samples: 7486/24956
[P1] Ep 57 | Loss 0.9724 | Val MAE 1.9573 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 58] Active Samples: 7486/24956
[P1] Ep 58 | Loss 0.9900 | Val MAE 1.9981 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 59] Active Samples: 7486/24956
[P1] Ep 59 | Loss 1.0543 | Val MAE 1.8271 CI 0.5848 Acc 21.1%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 60] Active Samples: 7486/24956
[P1] Ep 60 | Loss 1.0167 | Val MAE 1.9366 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 61] Active Samples: 7486/24956
[P1] Ep 61 | Loss 1.0300 | Val MAE 1.8716 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 62] Active Samples: 7486/24956
[P1] Ep 62 | Loss 1.0127 | Val MAE 1.8893 CI 0.5439 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 63] Active Samples: 7486/24956
[P1] Ep 63 | Loss 0.9830 | Val MAE 1.8883 CI 0.5497 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 64] Active Samples: 7486/24956
[P1] Ep 64 | Loss 1.0467 | Val MAE 1.8682 CI 0.5497 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 65] Active Samples: 7486/24956
[P1] Ep 65 | Loss 1.0027 | Val MAE 1.9075 CI 0.5614 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 66] Active Samples: 7486/24956
[P1] Ep 66 | Loss 0.8602 | Val MAE 1.9427 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 67] Active Samples: 7486/24956
[P1] Ep 67 | Loss 0.8812 | Val MAE 1.8959 CI 0.5673 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 68] Active Samples: 7486/24956
[P1] Ep 68 | Loss 0.9637 | Val MAE 1.9137 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 69] Active Samples: 7486/24956
[P1] Ep 69 | Loss 0.9347 | Val MAE 1.8891 CI 0.5439 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 70] Active Samples: 7486/24956
[P1] Ep 70 | Loss 0.9777 | Val MAE 1.9121 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 71] Active Samples: 7486/24956
[P1] Ep 71 | Loss 0.9358 | Val MAE 1.8682 CI 0.5497 Acc 21.1%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 72] Active Samples: 7486/24956
[P1] Ep 72 | Loss 0.9761 | Val MAE 1.9117 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 73] Active Samples: 7486/24956
[P1] Ep 73 | Loss 0.9647 | Val MAE 1.8788 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 74] Active Samples: 7486/24956
[P1] Ep 74 | Loss 0.9237 | Val MAE 1.8774 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 75] Active Samples: 7486/24956
[P1] Ep 75 | Loss 0.8783 | Val MAE 1.9558 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 76] Active Samples: 7486/24956
[P1] Ep 76 | Loss 0.9675 | Val MAE 1.8731 CI 0.5497 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 77] Active Samples: 7486/24956
[P1] Ep 77 | Loss 0.9509 | Val MAE 1.8194 CI 0.5556 Acc 21.1%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 78] Active Samples: 7486/24956
[P1] Ep 78 | Loss 0.9656 | Val MAE 1.9008 CI 0.5673 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 79] Active Samples: 7486/24956
[P1] Ep 79 | Loss 1.0279 | Val MAE 1.8891 CI 0.5497 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 80] Active Samples: 7486/24956
[P1] Ep 80 | Loss 1.0140 | Val MAE 1.8518 CI 0.5497 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 81] Active Samples: 7486/24956
[P1] Ep 81 | Loss 1.0229 | Val MAE 1.8750 CI 0.5439 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 82] Active Samples: 7486/24956
[P1] Ep 82 | Loss 1.0194 | Val MAE 1.8504 CI 0.5380 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 83] Active Samples: 7486/24956
[P1] Ep 83 | Loss 0.9779 | Val MAE 1.9182 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.2954 | Std: 0.4517
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 84] Active Samples: 7486/24956
[P1] Ep 84 | Loss 0.9796 | Val MAE 1.9020 CI 0.5439 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.2939 | Std: 0.4496
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 85] Active Samples: 7486/24956
[P1] Ep 85 | Loss 0.9360 | Val MAE 1.8848 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.2861 | Std: 0.4379
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 86] Active Samples: 7486/24956
[P1] Ep 86 | Loss 0.8908 | Val MAE 1.8929 CI 0.5439 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.2893 | Std: 0.4427
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 87] Active Samples: 7486/24956
[P1] Ep 87 | Loss 0.9131 | Val MAE 1.8906 CI 0.5439 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.2853 | Std: 0.4367
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 88] Active Samples: 7486/24956
[P1] Ep 88 | Loss 0.8932 | Val MAE 1.9577 CI 0.5439 Acc 10.5%

=== PHASE 2: Target Fine-tuning ===
>>> Stage 2.1: Head Alignment...
[Head] Ep 10 MAE 1.5137 CI 0.5965 Acc 26.3%
[Head] Ep 20 MAE 1.5074 CI 0.5965 Acc 26.3%
[Head] Ep 30 MAE 1.5051 CI 0.6199 Acc 26.3%
[Head] Ep 40 MAE 1.5161 CI 0.6257 Acc 26.3%
[Head] Ep 50 MAE 1.5300 CI 0.6082 Acc 26.3%
[Head] Ep 60 MAE 1.5346 CI 0.6082 Acc 26.3%
[Head] Ep 70 MAE 1.5321 CI 0.6082 Acc 26.3%
[Head] Ep 80 MAE 1.5297 CI 0.5965 Acc 26.3%
[Head] Ep 90 MAE 1.5378 CI 0.5906 Acc 26.3%
[Head] Ep 100 MAE 1.5430 CI 0.5965 Acc 26.3%
[Head] Ep 110 MAE 1.5514 CI 0.5965 Acc 21.1%
[Head] Ep 120 MAE 1.5446 CI 0.5848 Acc 26.3%
[Head] Ep 130 MAE 1.5556 CI 0.5906 Acc 21.1%
[Head] Ep 140 MAE 1.5573 CI 0.5906 Acc 21.1%
[Head] Ep 150 MAE 1.5600 CI 0.5789 Acc 21.1%
>>> Stage 2.2: Full Fine-tuning...
[Full] Ep 10 MAE 1.5069 CI 0.6374 RM2 0.0529 Acc 26.3%
[Full] Ep 20 MAE 1.5014 CI 0.6491 RM2 0.0494 Acc 26.3%
[Full] Ep 30 MAE 1.5043 CI 0.6491 RM2 0.0445 Acc 26.3%
[Full] Ep 40 MAE 1.5086 CI 0.6374 RM2 0.0407 Acc 26.3%
[Full] Ep 50 MAE 1.5080 CI 0.6199 RM2 0.0380 Acc 26.3%

>>> Testing Final Model...
------------------------------------------------------------
[FINAL RESULT] Test Set:
   MAE:  1.3852
   RMSE: 1.7375
   CI:   0.5895
   RM2:  0.0501
   MAPE: 24.79 %
   Acc:  30.00 %
------------------------------------------------------------
