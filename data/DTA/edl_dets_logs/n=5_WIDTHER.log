Namespace(source_csv='./drug-target/Davis.csv', target_csv='./drug-target/CASF2016_graph_valid.csv', pretrained='/Davis80_best_model.pt', max_seq_len=1024, batch_size=128, epochs=200, ft_epochs=150, lr=5e-05, weight_decay=0.0001, dropout=0.1, device='cuda:0', save_dir='DETS_DTA', num_prototypes=5, tau_high=0.8, sigma_0=0.2, gamma=10, alpha=0.9, w_min=0.0001, edl_lambda=0.01, mlp_hidden='256,128')
Loading datasets...
Initializing DETS Projection Head (High Variance)...

=== PHASE 1: DETS Source Training ===
-> Extracting Anchors from Target (CASF)...
/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
   Running K-Means (K=5)...
-> Anchors Established: 5 prototypes.
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 1] Active Samples: 7486/24956
[P1] Ep 1 | Loss 2.9612 | Val MAE 1.6038 CI 0.5673 Acc 31.6%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 2] Active Samples: 7486/24956
[P1] Ep 2 | Loss 1.2411 | Val MAE 1.9084 CI 0.5848 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 3] Active Samples: 7486/24956
[P1] Ep 3 | Loss 1.1085 | Val MAE 1.9942 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 4] Active Samples: 7486/24956
[P1] Ep 4 | Loss 1.0804 | Val MAE 1.9408 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 5] Active Samples: 7486/24956
[P1] Ep 5 | Loss 1.0494 | Val MAE 1.9915 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 6] Active Samples: 7486/24956
[P1] Ep 6 | Loss 1.0205 | Val MAE 1.9845 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 7] Active Samples: 7486/24956
[P1] Ep 7 | Loss 1.0178 | Val MAE 1.9517 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 8] Active Samples: 7486/24956
[P1] Ep 8 | Loss 0.9936 | Val MAE 2.0540 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 9] Active Samples: 7486/24956
[P1] Ep 9 | Loss 0.9960 | Val MAE 2.0134 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 10] Active Samples: 7486/24956
[P1] Ep 10 | Loss 0.9698 | Val MAE 1.9684 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 11] Active Samples: 7486/24956
[P1] Ep 11 | Loss 0.9440 | Val MAE 1.9820 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 12] Active Samples: 7486/24956
[P1] Ep 12 | Loss 0.9602 | Val MAE 2.0367 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 13] Active Samples: 7486/24956
[P1] Ep 13 | Loss 0.9481 | Val MAE 1.9992 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 14] Active Samples: 7486/24956
[P1] Ep 14 | Loss 0.9275 | Val MAE 1.9979 CI 0.6842 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 15] Active Samples: 7486/24956
[P1] Ep 15 | Loss 0.9371 | Val MAE 2.0217 CI 0.6725 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 16] Active Samples: 7486/24956
[P1] Ep 16 | Loss 0.9264 | Val MAE 2.0092 CI 0.6725 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 17] Active Samples: 7486/24956
[P1] Ep 17 | Loss 0.8999 | Val MAE 2.0242 CI 0.6784 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 18] Active Samples: 7486/24956
[P1] Ep 18 | Loss 0.9069 | Val MAE 1.9824 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 19] Active Samples: 7486/24956
[P1] Ep 19 | Loss 0.8842 | Val MAE 1.9410 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 20] Active Samples: 7486/24956
[P1] Ep 20 | Loss 0.8982 | Val MAE 1.9779 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 21] Active Samples: 7486/24956
[P1] Ep 21 | Loss 0.8741 | Val MAE 2.0070 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 22] Active Samples: 7486/24956
[P1] Ep 22 | Loss 0.8581 | Val MAE 1.9596 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 23] Active Samples: 7486/24956
[P1] Ep 23 | Loss 0.8864 | Val MAE 1.9672 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 24] Active Samples: 7486/24956
[P1] Ep 24 | Loss 0.8839 | Val MAE 2.0498 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 25] Active Samples: 7486/24956
[P1] Ep 25 | Loss 0.8640 | Val MAE 1.9720 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 26] Active Samples: 7486/24956
[P1] Ep 26 | Loss 0.8647 | Val MAE 2.0137 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 27] Active Samples: 7486/24956
[P1] Ep 27 | Loss 0.8602 | Val MAE 1.9489 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 28] Active Samples: 7486/24956
[P1] Ep 28 | Loss 0.8651 | Val MAE 1.9531 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 29] Active Samples: 7486/24956
[P1] Ep 29 | Loss 0.8779 | Val MAE 1.9547 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 30] Active Samples: 7486/24956
[P1] Ep 30 | Loss 0.8525 | Val MAE 1.9745 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 31] Active Samples: 7486/24956
[P1] Ep 31 | Loss 0.8606 | Val MAE 1.9602 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 32] Active Samples: 7486/24956
[P1] Ep 32 | Loss 0.8645 | Val MAE 2.0479 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 33] Active Samples: 7486/24956
[P1] Ep 33 | Loss 0.8421 | Val MAE 1.9674 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 34] Active Samples: 7486/24956
[P1] Ep 34 | Loss 0.8480 | Val MAE 2.0256 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 35] Active Samples: 7486/24956
[P1] Ep 35 | Loss 0.8417 | Val MAE 2.0295 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 36] Active Samples: 7486/24956
[P1] Ep 36 | Loss 0.8314 | Val MAE 2.0629 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 37] Active Samples: 7486/24956
[P1] Ep 37 | Loss 0.8505 | Val MAE 1.9821 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 38] Active Samples: 7486/24956
[P1] Ep 38 | Loss 0.8052 | Val MAE 2.0586 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 39] Active Samples: 7486/24956
[P1] Ep 39 | Loss 0.8614 | Val MAE 2.0041 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 40] Active Samples: 7486/24956
[P1] Ep 40 | Loss 0.8123 | Val MAE 1.9543 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 41] Active Samples: 7486/24956
[P1] Ep 41 | Loss 0.8330 | Val MAE 2.0021 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 42] Active Samples: 7486/24956
[P1] Ep 42 | Loss 0.7890 | Val MAE 2.0033 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 43] Active Samples: 7486/24956
[P1] Ep 43 | Loss 0.8131 | Val MAE 2.0015 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 44] Active Samples: 7486/24956
[P1] Ep 44 | Loss 0.8061 | Val MAE 1.9771 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 45] Active Samples: 7486/24956
[P1] Ep 45 | Loss 0.8130 | Val MAE 1.9866 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 46] Active Samples: 7486/24956
[P1] Ep 46 | Loss 0.8084 | Val MAE 1.9818 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 47] Active Samples: 7486/24956
[P1] Ep 47 | Loss 0.8081 | Val MAE 1.9740 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 48] Active Samples: 7486/24956
[P1] Ep 48 | Loss 0.7680 | Val MAE 2.0145 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 49] Active Samples: 7486/24956
[P1] Ep 49 | Loss 0.8251 | Val MAE 2.0382 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 50] Active Samples: 7486/24956
[P1] Ep 50 | Loss 0.8149 | Val MAE 2.0685 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 51] Active Samples: 7486/24956
[P1] Ep 51 | Loss 0.8158 | Val MAE 1.9828 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 52] Active Samples: 7486/24956
[P1] Ep 52 | Loss 0.8168 | Val MAE 2.0117 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 53] Active Samples: 7486/24956
[P1] Ep 53 | Loss 0.7990 | Val MAE 2.0264 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 54] Active Samples: 7486/24956
[P1] Ep 54 | Loss 0.7928 | Val MAE 2.0488 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 55] Active Samples: 7486/24956
[P1] Ep 55 | Loss 0.7918 | Val MAE 2.0479 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 56] Active Samples: 7486/24956
[P1] Ep 56 | Loss 0.7546 | Val MAE 2.0246 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 57] Active Samples: 7486/24956
[P1] Ep 57 | Loss 0.8036 | Val MAE 1.9750 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 58] Active Samples: 7486/24956
[P1] Ep 58 | Loss 0.8060 | Val MAE 2.0099 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 59] Active Samples: 7486/24956
[P1] Ep 59 | Loss 0.7893 | Val MAE 1.9431 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 60] Active Samples: 7486/24956
[P1] Ep 60 | Loss 0.7700 | Val MAE 2.0026 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 61] Active Samples: 7486/24956
[P1] Ep 61 | Loss 0.8350 | Val MAE 1.9261 CI 0.5906 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 62] Active Samples: 7486/24956
[P1] Ep 62 | Loss 0.8137 | Val MAE 2.0124 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 63] Active Samples: 7486/24956
[P1] Ep 63 | Loss 0.8568 | Val MAE 1.9854 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 64] Active Samples: 7486/24956
[P1] Ep 64 | Loss 0.9327 | Val MAE 1.9402 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 65] Active Samples: 7486/24956
[P1] Ep 65 | Loss 0.8777 | Val MAE 1.9622 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 66] Active Samples: 7486/24956
[P1] Ep 66 | Loss 0.8894 | Val MAE 1.9834 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 67] Active Samples: 7486/24956
[P1] Ep 67 | Loss 0.9360 | Val MAE 1.9327 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 68] Active Samples: 7486/24956
[P1] Ep 68 | Loss 1.0198 | Val MAE 1.9773 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 69] Active Samples: 7486/24956
[P1] Ep 69 | Loss 0.9523 | Val MAE 1.9333 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 70] Active Samples: 7486/24956
[P1] Ep 70 | Loss 0.9776 | Val MAE 1.9159 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 71] Active Samples: 7486/24956
[P1] Ep 71 | Loss 1.0654 | Val MAE 1.9045 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 72] Active Samples: 7486/24956
[P1] Ep 72 | Loss 1.0549 | Val MAE 1.8597 CI 0.6082 Acc 21.1%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 73] Active Samples: 7486/24956
[P1] Ep 73 | Loss 0.9283 | Val MAE 1.9257 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 74] Active Samples: 7486/24956
[P1] Ep 74 | Loss 0.9289 | Val MAE 1.9396 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 75] Active Samples: 7486/24956
[P1] Ep 75 | Loss 1.0203 | Val MAE 1.9581 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 76] Active Samples: 7486/24956
[P1] Ep 76 | Loss 1.0693 | Val MAE 1.8980 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 77] Active Samples: 7486/24956
[P1] Ep 77 | Loss 0.9869 | Val MAE 1.9300 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 78] Active Samples: 7486/24956
[P1] Ep 78 | Loss 0.9118 | Val MAE 1.8953 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 79] Active Samples: 7486/24956
[P1] Ep 79 | Loss 0.9777 | Val MAE 1.9457 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 80] Active Samples: 7486/24956
[P1] Ep 80 | Loss 0.9288 | Val MAE 1.9442 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 81] Active Samples: 7486/24956
[P1] Ep 81 | Loss 0.8071 | Val MAE 1.9344 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 82] Active Samples: 7486/24956
[P1] Ep 82 | Loss 0.8046 | Val MAE 1.9919 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 83] Active Samples: 7486/24956
[P1] Ep 83 | Loss 0.8421 | Val MAE 1.9506 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 84] Active Samples: 7486/24956
[P1] Ep 84 | Loss 0.8797 | Val MAE 1.9475 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 85] Active Samples: 7486/24956
[P1] Ep 85 | Loss 0.8727 | Val MAE 2.0863 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 86] Active Samples: 7486/24956
[P1] Ep 86 | Loss 0.8774 | Val MAE 1.9747 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 87] Active Samples: 7486/24956
[P1] Ep 87 | Loss 0.8290 | Val MAE 1.9492 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 88] Active Samples: 7486/24956
[P1] Ep 88 | Loss 0.8833 | Val MAE 1.9738 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 89] Active Samples: 7486/24956
[P1] Ep 89 | Loss 0.8407 | Val MAE 2.0031 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 90] Active Samples: 7486/24956
[P1] Ep 90 | Loss 0.8796 | Val MAE 1.9803 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 91] Active Samples: 7486/24956
[P1] Ep 91 | Loss 0.8955 | Val MAE 1.9899 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 92] Active Samples: 7486/24956
[P1] Ep 92 | Loss 0.8297 | Val MAE 1.9512 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 93] Active Samples: 7486/24956
[P1] Ep 93 | Loss 0.7731 | Val MAE 2.0323 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 94] Active Samples: 7486/24956
[P1] Ep 94 | Loss 0.8421 | Val MAE 1.9814 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 95] Active Samples: 7486/24956
[P1] Ep 95 | Loss 0.8353 | Val MAE 1.9763 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 96] Active Samples: 7486/24956
[P1] Ep 96 | Loss 0.8434 | Val MAE 1.9447 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 97] Active Samples: 7486/24956
[P1] Ep 97 | Loss 0.8105 | Val MAE 1.9876 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 98] Active Samples: 7486/24956
[P1] Ep 98 | Loss 0.8129 | Val MAE 2.0255 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 99] Active Samples: 7486/24956
[P1] Ep 99 | Loss 0.8118 | Val MAE 2.0082 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 100] Active Samples: 7486/24956
[P1] Ep 100 | Loss 0.7633 | Val MAE 2.0130 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 101] Active Samples: 7486/24956
[P1] Ep 101 | Loss 0.8726 | Val MAE 1.9521 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 102] Active Samples: 7486/24956
[P1] Ep 102 | Loss 0.8684 | Val MAE 2.0067 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 103] Active Samples: 7486/24956
[P1] Ep 103 | Loss 0.8248 | Val MAE 1.9560 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 104] Active Samples: 7486/24956
[P1] Ep 104 | Loss 0.8218 | Val MAE 2.0267 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 105] Active Samples: 7486/24956
[P1] Ep 105 | Loss 0.7822 | Val MAE 1.9620 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 106] Active Samples: 7486/24956
[P1] Ep 106 | Loss 0.8324 | Val MAE 1.9662 CI 0.5731 Acc 10.5%

=== PHASE 2: Target Fine-tuning ===
>>> Stage 2.1: Head Alignment...
[Head] Ep 10 MAE 1.5129 CI 0.5848 Acc 26.3%
[Head] Ep 20 MAE 1.5179 CI 0.5848 Acc 26.3%
[Head] Ep 30 MAE 1.5167 CI 0.5965 Acc 26.3%
[Head] Ep 40 MAE 1.5212 CI 0.5965 Acc 26.3%
[Head] Ep 50 MAE 1.5180 CI 0.5965 Acc 26.3%
[Head] Ep 60 MAE 1.5311 CI 0.5965 Acc 26.3%
[Head] Ep 70 MAE 1.5203 CI 0.6082 Acc 26.3%
[Head] Ep 80 MAE 1.5319 CI 0.5906 Acc 26.3%
[Head] Ep 90 MAE 1.5425 CI 0.5848 Acc 26.3%
[Head] Ep 100 MAE 1.5410 CI 0.5789 Acc 26.3%
[Head] Ep 110 MAE 1.5434 CI 0.5614 Acc 26.3%
[Head] Ep 120 MAE 1.5575 CI 0.5497 Acc 21.1%
[Head] Ep 130 MAE 1.5608 CI 0.5497 Acc 21.1%
[Head] Ep 140 MAE 1.5582 CI 0.5439 Acc 26.3%
[Head] Ep 150 MAE 1.5681 CI 0.5439 Acc 21.1%
>>> Stage 2.2: Full Fine-tuning...
[Full] Ep 10 MAE 1.5149 CI 0.5965 RM2 0.0412 Acc 26.3%
[Full] Ep 20 MAE 1.5194 CI 0.6140 RM2 0.0399 Acc 26.3%
[Full] Ep 30 MAE 1.5076 CI 0.6199 RM2 0.0371 Acc 26.3%
[Full] Ep 40 MAE 1.5188 CI 0.6257 RM2 0.0344 Acc 26.3%
[Full] Ep 50 MAE 1.5174 CI 0.6140 RM2 0.0305 Acc 26.3%

>>> Testing Final Model...
------------------------------------------------------------
[FINAL RESULT] Test Set:
   MAE:  1.3959
   RMSE: 1.7440
   CI:   0.5842
   RM2:  0.0350
   MAPE: 24.49 %
   Acc:  30.00 %
------------------------------------------------------------
