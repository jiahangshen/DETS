Namespace(source_csv='./drug-target/Davis.csv', target_csv='./drug-target/CASF2016_graph_valid.csv', pretrained='/Davis80_best_model.pt', max_seq_len=1024, batch_size=128, epochs=200, ft_epochs=150, lr=5e-05, weight_decay=0.0001, dropout=0.1, device='cuda:0', save_dir='DETS_DTA', num_prototypes=10, tau_high=0.8, sigma_0=0.2, gamma=10, alpha=0.9, w_min=0.0001, edl_lambda=0.01, mlp_hidden='256,128')
Loading datasets...
Initializing DETS Projection Head (High Variance)...

=== PHASE 1: DETS Source Training ===
-> Extracting Anchors from Target (CASF)...
/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
   Running K-Means (K=10)...
-> Anchors Established: 10 prototypes.
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 1] Active Samples: 7486/24956
[P1] Ep 1 | Loss 2.9727 | Val MAE 1.6038 CI 0.5673 Acc 31.6%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 2] Active Samples: 7486/24956
[P1] Ep 2 | Loss 1.2458 | Val MAE 1.9079 CI 0.5789 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 3] Active Samples: 7486/24956
[P1] Ep 3 | Loss 1.1126 | Val MAE 1.9999 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 4] Active Samples: 7486/24956
[P1] Ep 4 | Loss 1.0844 | Val MAE 1.9376 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 5] Active Samples: 7486/24956
[P1] Ep 5 | Loss 1.0526 | Val MAE 1.9947 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 6] Active Samples: 7486/24956
[P1] Ep 6 | Loss 1.0241 | Val MAE 1.9861 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 7] Active Samples: 7486/24956
[P1] Ep 7 | Loss 1.0187 | Val MAE 1.9413 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 8] Active Samples: 7486/24956
[P1] Ep 8 | Loss 0.9997 | Val MAE 2.0442 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 9] Active Samples: 7486/24956
[P1] Ep 9 | Loss 0.9964 | Val MAE 1.9982 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 10] Active Samples: 7486/24956
[P1] Ep 10 | Loss 0.9718 | Val MAE 1.9180 CI 0.6608 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 11] Active Samples: 7486/24956
[P1] Ep 11 | Loss 0.9501 | Val MAE 1.9288 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 12] Active Samples: 7486/24956
[P1] Ep 12 | Loss 0.9590 | Val MAE 2.0176 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 13] Active Samples: 7486/24956
[P1] Ep 13 | Loss 0.9461 | Val MAE 2.0146 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 14] Active Samples: 7486/24956
[P1] Ep 14 | Loss 0.9249 | Val MAE 2.0179 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 15] Active Samples: 7486/24956
[P1] Ep 15 | Loss 0.9328 | Val MAE 2.0382 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 16] Active Samples: 7486/24956
[P1] Ep 16 | Loss 0.9250 | Val MAE 2.0121 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 17] Active Samples: 7486/24956
[P1] Ep 17 | Loss 0.8957 | Val MAE 2.0411 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 18] Active Samples: 7486/24956
[P1] Ep 18 | Loss 0.9050 | Val MAE 1.9604 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 19] Active Samples: 7486/24956
[P1] Ep 19 | Loss 0.8757 | Val MAE 1.9697 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 20] Active Samples: 7486/24956
[P1] Ep 20 | Loss 0.8886 | Val MAE 1.9597 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 21] Active Samples: 7486/24956
[P1] Ep 21 | Loss 0.8834 | Val MAE 1.9438 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 22] Active Samples: 7486/24956
[P1] Ep 22 | Loss 0.8541 | Val MAE 1.9634 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 23] Active Samples: 7486/24956
[P1] Ep 23 | Loss 0.8829 | Val MAE 1.9398 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 24] Active Samples: 7486/24956
[P1] Ep 24 | Loss 0.8804 | Val MAE 2.0740 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 25] Active Samples: 7486/24956
[P1] Ep 25 | Loss 0.8604 | Val MAE 1.9708 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 26] Active Samples: 7486/24956
[P1] Ep 26 | Loss 0.8602 | Val MAE 2.0304 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 27] Active Samples: 7486/24956
[P1] Ep 27 | Loss 0.8541 | Val MAE 1.9655 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 28] Active Samples: 7486/24956
[P1] Ep 28 | Loss 0.8598 | Val MAE 1.9453 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 29] Active Samples: 7486/24956
[P1] Ep 29 | Loss 0.8759 | Val MAE 1.9642 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 30] Active Samples: 7486/24956
[P1] Ep 30 | Loss 0.8538 | Val MAE 1.9989 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 31] Active Samples: 7486/24956
[P1] Ep 31 | Loss 0.8562 | Val MAE 2.0068 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 32] Active Samples: 7486/24956
[P1] Ep 32 | Loss 0.8416 | Val MAE 2.0420 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 33] Active Samples: 7486/24956
[P1] Ep 33 | Loss 0.8300 | Val MAE 2.0270 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 34] Active Samples: 7486/24956
[P1] Ep 34 | Loss 0.7999 | Val MAE 2.0676 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 35] Active Samples: 7486/24956
[P1] Ep 35 | Loss 0.8398 | Val MAE 2.0066 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 36] Active Samples: 7486/24956
[P1] Ep 36 | Loss 0.8276 | Val MAE 2.0721 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 37] Active Samples: 7486/24956
[P1] Ep 37 | Loss 0.8399 | Val MAE 2.0491 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 38] Active Samples: 7486/24956
[P1] Ep 38 | Loss 0.8274 | Val MAE 2.0360 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 39] Active Samples: 7486/24956
[P1] Ep 39 | Loss 0.8290 | Val MAE 2.0097 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 40] Active Samples: 7486/24956
[P1] Ep 40 | Loss 0.8196 | Val MAE 2.0400 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 41] Active Samples: 7486/24956
[P1] Ep 41 | Loss 0.8179 | Val MAE 1.9810 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 42] Active Samples: 7486/24956
[P1] Ep 42 | Loss 0.8138 | Val MAE 2.0352 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 43] Active Samples: 7486/24956
[P1] Ep 43 | Loss 0.8046 | Val MAE 2.0045 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 44] Active Samples: 7486/24956
[P1] Ep 44 | Loss 0.8181 | Val MAE 2.0166 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 45] Active Samples: 7486/24956
[P1] Ep 45 | Loss 0.8063 | Val MAE 2.0269 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 46] Active Samples: 7486/24956
[P1] Ep 46 | Loss 0.8130 | Val MAE 1.9631 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 47] Active Samples: 7486/24956
[P1] Ep 47 | Loss 0.8171 | Val MAE 2.0800 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 48] Active Samples: 7486/24956
[P1] Ep 48 | Loss 0.8029 | Val MAE 1.9943 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 49] Active Samples: 7486/24956
[P1] Ep 49 | Loss 0.7960 | Val MAE 2.0094 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 50] Active Samples: 7486/24956
[P1] Ep 50 | Loss 0.8115 | Val MAE 2.0442 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 51] Active Samples: 7486/24956
[P1] Ep 51 | Loss 0.8231 | Val MAE 2.0465 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 52] Active Samples: 7486/24956
[P1] Ep 52 | Loss 0.7645 | Val MAE 2.0187 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 53] Active Samples: 7486/24956
[P1] Ep 53 | Loss 0.8045 | Val MAE 1.9946 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 54] Active Samples: 7486/24956
[P1] Ep 54 | Loss 0.7899 | Val MAE 2.0070 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 55] Active Samples: 7486/24956
[P1] Ep 55 | Loss 0.8038 | Val MAE 1.9690 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 56] Active Samples: 7486/24956
[P1] Ep 56 | Loss 0.7811 | Val MAE 2.0527 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 57] Active Samples: 7486/24956
[P1] Ep 57 | Loss 0.8091 | Val MAE 2.0466 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 58] Active Samples: 7486/24956
[P1] Ep 58 | Loss 0.7926 | Val MAE 2.0482 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 59] Active Samples: 7486/24956
[P1] Ep 59 | Loss 0.7940 | Val MAE 2.0110 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 60] Active Samples: 7486/24956
[P1] Ep 60 | Loss 0.7675 | Val MAE 2.0812 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 61] Active Samples: 7486/24956
[P1] Ep 61 | Loss 0.7945 | Val MAE 2.0200 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 62] Active Samples: 7486/24956
[P1] Ep 62 | Loss 0.7922 | Val MAE 1.9436 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 63] Active Samples: 7486/24956
[P1] Ep 63 | Loss 0.7889 | Val MAE 1.9954 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 64] Active Samples: 7486/24956
[P1] Ep 64 | Loss 0.7902 | Val MAE 1.9637 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 65] Active Samples: 7486/24956
[P1] Ep 65 | Loss 0.7478 | Val MAE 2.0233 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 66] Active Samples: 7486/24956
[P1] Ep 66 | Loss 0.7695 | Val MAE 2.0136 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 67] Active Samples: 7486/24956
[P1] Ep 67 | Loss 0.8505 | Val MAE 2.0130 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 68] Active Samples: 7486/24956
[P1] Ep 68 | Loss 0.8727 | Val MAE 2.0279 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 69] Active Samples: 7486/24956
[P1] Ep 69 | Loss 0.9063 | Val MAE 1.9742 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 70] Active Samples: 7486/24956
[P1] Ep 70 | Loss 0.9062 | Val MAE 1.9500 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 71] Active Samples: 7486/24956
[P1] Ep 71 | Loss 0.8690 | Val MAE 2.0310 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 72] Active Samples: 7486/24956
[P1] Ep 72 | Loss 0.8396 | Val MAE 1.9860 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 73] Active Samples: 7486/24956
[P1] Ep 73 | Loss 0.8647 | Val MAE 1.9646 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 74] Active Samples: 7486/24956
[P1] Ep 74 | Loss 0.7919 | Val MAE 1.9537 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 75] Active Samples: 7486/24956
[P1] Ep 75 | Loss 0.7598 | Val MAE 2.0384 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 76] Active Samples: 7486/24956
[P1] Ep 76 | Loss 0.7574 | Val MAE 2.0027 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 77] Active Samples: 7486/24956
[P1] Ep 77 | Loss 0.7775 | Val MAE 2.0066 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 78] Active Samples: 7486/24956
[P1] Ep 78 | Loss 0.8691 | Val MAE 1.9829 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 79] Active Samples: 7486/24956
[P1] Ep 79 | Loss 0.8638 | Val MAE 2.0568 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 80] Active Samples: 7486/24956
[P1] Ep 80 | Loss 0.8797 | Val MAE 1.9739 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 81] Active Samples: 7486/24956
[P1] Ep 81 | Loss 0.8688 | Val MAE 1.9692 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 82] Active Samples: 7486/24956
[P1] Ep 82 | Loss 0.8861 | Val MAE 2.0232 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 83] Active Samples: 7486/24956
[P1] Ep 83 | Loss 0.8481 | Val MAE 2.0357 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 84] Active Samples: 7486/24956
[P1] Ep 84 | Loss 0.8976 | Val MAE 2.0234 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 85] Active Samples: 7486/24956
[P1] Ep 85 | Loss 0.8787 | Val MAE 2.0590 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 86] Active Samples: 7486/24956
[P1] Ep 86 | Loss 0.8749 | Val MAE 2.0186 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 87] Active Samples: 7486/24956
[P1] Ep 87 | Loss 0.8744 | Val MAE 1.9693 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 88] Active Samples: 7486/24956
[P1] Ep 88 | Loss 0.8776 | Val MAE 2.0016 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 89] Active Samples: 7486/24956
[P1] Ep 89 | Loss 0.8699 | Val MAE 2.0187 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 90] Active Samples: 7486/24956
[P1] Ep 90 | Loss 1.0104 | Val MAE 1.9443 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 91] Active Samples: 7486/24956
[P1] Ep 91 | Loss 0.8580 | Val MAE 2.0060 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 92] Active Samples: 7486/24956
[P1] Ep 92 | Loss 0.9243 | Val MAE 1.9721 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 93] Active Samples: 7486/24956
[P1] Ep 93 | Loss 0.9427 | Val MAE 1.9948 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 94] Active Samples: 7486/24956
[P1] Ep 94 | Loss 0.9813 | Val MAE 1.8999 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 95] Active Samples: 7486/24956
[P1] Ep 95 | Loss 0.8906 | Val MAE 1.9863 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 96] Active Samples: 7486/24956
[P1] Ep 96 | Loss 0.9480 | Val MAE 1.9425 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 97] Active Samples: 7486/24956
[P1] Ep 97 | Loss 0.9078 | Val MAE 1.9895 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 98] Active Samples: 7486/24956
[P1] Ep 98 | Loss 0.8505 | Val MAE 2.0212 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 99] Active Samples: 7486/24956
[P1] Ep 99 | Loss 0.9027 | Val MAE 1.9877 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 100] Active Samples: 7486/24956
[P1] Ep 100 | Loss 0.8698 | Val MAE 2.0058 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 101] Active Samples: 7486/24956
[P1] Ep 101 | Loss 0.9240 | Val MAE 1.9659 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 102] Active Samples: 7486/24956
[P1] Ep 102 | Loss 0.9340 | Val MAE 1.9536 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 103] Active Samples: 7486/24956
[P1] Ep 103 | Loss 0.9260 | Val MAE 1.9284 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 104] Active Samples: 7486/24956
[P1] Ep 104 | Loss 0.9348 | Val MAE 1.9608 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 105] Active Samples: 7486/24956
[P1] Ep 105 | Loss 0.9507 | Val MAE 1.8989 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 106] Active Samples: 7486/24956
[P1] Ep 106 | Loss 0.9943 | Val MAE 1.8861 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 107] Active Samples: 7486/24956
[P1] Ep 107 | Loss 0.9441 | Val MAE 1.9457 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 108] Active Samples: 7486/24956
[P1] Ep 108 | Loss 0.9233 | Val MAE 1.9543 CI 0.5789 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 109] Active Samples: 7486/24956
[P1] Ep 109 | Loss 0.9159 | Val MAE 1.9710 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 110] Active Samples: 7486/24956
[P1] Ep 110 | Loss 0.9000 | Val MAE 1.8998 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 111] Active Samples: 7486/24956
[P1] Ep 111 | Loss 0.9012 | Val MAE 1.9440 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 112] Active Samples: 7486/24956
[P1] Ep 112 | Loss 0.9230 | Val MAE 1.9473 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 113] Active Samples: 7486/24956
[P1] Ep 113 | Loss 0.9455 | Val MAE 1.8778 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 114] Active Samples: 7486/24956
[P1] Ep 114 | Loss 0.9306 | Val MAE 1.9066 CI 0.5614 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 115] Active Samples: 7486/24956
[P1] Ep 115 | Loss 0.9683 | Val MAE 1.8942 CI 0.5556 Acc 10.5%

=== PHASE 2: Target Fine-tuning ===
>>> Stage 2.1: Head Alignment...
[Head] Ep 10 MAE 1.5103 CI 0.6082 Acc 26.3%
[Head] Ep 20 MAE 1.5103 CI 0.5965 Acc 26.3%
[Head] Ep 30 MAE 1.5087 CI 0.5848 Acc 26.3%
[Head] Ep 40 MAE 1.5114 CI 0.5965 Acc 26.3%
[Head] Ep 50 MAE 1.5142 CI 0.5906 Acc 26.3%
[Head] Ep 60 MAE 1.5193 CI 0.5965 Acc 26.3%
[Head] Ep 70 MAE 1.5271 CI 0.6023 Acc 26.3%
[Head] Ep 80 MAE 1.5352 CI 0.5906 Acc 26.3%
[Head] Ep 90 MAE 1.5357 CI 0.5789 Acc 26.3%
[Head] Ep 100 MAE 1.5448 CI 0.5789 Acc 26.3%
[Head] Ep 110 MAE 1.5428 CI 0.5673 Acc 26.3%
[Head] Ep 120 MAE 1.5538 CI 0.5673 Acc 26.3%
[Head] Ep 130 MAE 1.5651 CI 0.5614 Acc 21.1%
[Head] Ep 140 MAE 1.5666 CI 0.5614 Acc 21.1%
[Head] Ep 150 MAE 1.5630 CI 0.5497 Acc 26.3%
>>> Stage 2.2: Full Fine-tuning...
[Full] Ep 10 MAE 1.5154 CI 0.5906 RM2 0.0327 Acc 26.3%
[Full] Ep 20 MAE 1.5006 CI 0.5906 RM2 0.0292 Acc 26.3%
[Full] Ep 30 MAE 1.5041 CI 0.5906 RM2 0.0269 Acc 26.3%
[Full] Ep 40 MAE 1.5085 CI 0.5906 RM2 0.0230 Acc 26.3%
[Full] Ep 50 MAE 1.5116 CI 0.5965 RM2 0.0213 Acc 26.3%

>>> Testing Final Model...
------------------------------------------------------------
[FINAL RESULT] Test Set:
   MAE:  1.3994
   RMSE: 1.7529
   CI:   0.5474
   RM2:  0.0157
   MAPE: 24.61 %
   Acc:  30.00 %
------------------------------------------------------------
