Namespace(source_csv='./drug-target/Davis.csv', target_csv='./drug-target/CASF2016_graph_valid.csv', pretrained='/Davis80_best_model.pt', max_seq_len=1024, batch_size=128, epochs=200, ft_epochs=150, lr=5e-05, weight_decay=0.0001, dropout=0.1, device='cuda:0', save_dir='DETS_DTA', num_prototypes=40, tau_high=0.85, sigma_0=0.15, gamma=10, alpha=0.9, w_min=0.0001, edl_lambda=0.01, mlp_hidden='256,128')
Loading datasets...
Initializing DETS Projection Head (High Variance)...

=== PHASE 1: DETS Source Training ===
-> Extracting Anchors from Target (CASF)...
/root/miniconda3/envs/subset/lib/python3.9/site-packages/torch/nn/modules/transformer.py:508: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /pytorch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  output = torch._nested_tensor_from_mask(
   Running K-Means (K=40)...
-> Anchors Established: 40 prototypes.
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 1] Active Samples: 7486/24956
[P1] Ep 1 | Loss 3.0116 | Val MAE 1.6038 CI 0.5673 Acc 31.6%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 2] Active Samples: 7486/24956
[P1] Ep 2 | Loss 1.2611 | Val MAE 1.9073 CI 0.5789 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 3] Active Samples: 7486/24956
[P1] Ep 3 | Loss 1.1239 | Val MAE 1.9946 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 4] Active Samples: 7486/24956
[P1] Ep 4 | Loss 1.0947 | Val MAE 1.9362 CI 0.5965 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 5] Active Samples: 7486/24956
[P1] Ep 5 | Loss 1.0634 | Val MAE 1.9939 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 6] Active Samples: 7486/24956
[P1] Ep 6 | Loss 1.0341 | Val MAE 1.9749 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 7] Active Samples: 7486/24956
[P1] Ep 7 | Loss 1.0298 | Val MAE 1.9436 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 8] Active Samples: 7486/24956
[P1] Ep 8 | Loss 1.0088 | Val MAE 2.0419 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 9] Active Samples: 7486/24956
[P1] Ep 9 | Loss 1.0073 | Val MAE 1.9902 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 10] Active Samples: 7486/24956
[P1] Ep 10 | Loss 0.9847 | Val MAE 1.9382 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 11] Active Samples: 7486/24956
[P1] Ep 11 | Loss 0.9584 | Val MAE 1.9747 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 12] Active Samples: 7486/24956
[P1] Ep 12 | Loss 0.9742 | Val MAE 2.0455 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 13] Active Samples: 7486/24956
[P1] Ep 13 | Loss 0.9621 | Val MAE 1.9914 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 14] Active Samples: 7486/24956
[P1] Ep 14 | Loss 0.9404 | Val MAE 2.0207 CI 0.6784 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 15] Active Samples: 7486/24956
[P1] Ep 15 | Loss 0.9488 | Val MAE 2.0315 CI 0.6667 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 16] Active Samples: 7486/24956
[P1] Ep 16 | Loss 0.9398 | Val MAE 2.0094 CI 0.6550 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 17] Active Samples: 7486/24956
[P1] Ep 17 | Loss 0.9097 | Val MAE 2.0228 CI 0.6725 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 18] Active Samples: 7486/24956
[P1] Ep 18 | Loss 0.9169 | Val MAE 1.9959 CI 0.6608 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 19] Active Samples: 7486/24956
[P1] Ep 19 | Loss 0.8991 | Val MAE 1.9662 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 20] Active Samples: 7486/24956
[P1] Ep 20 | Loss 0.9016 | Val MAE 1.9637 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 21] Active Samples: 7486/24956
[P1] Ep 21 | Loss 0.8942 | Val MAE 1.9461 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 22] Active Samples: 7486/24956
[P1] Ep 22 | Loss 0.8654 | Val MAE 1.9674 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 23] Active Samples: 7486/24956
[P1] Ep 23 | Loss 0.8942 | Val MAE 1.9715 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 24] Active Samples: 7486/24956
[P1] Ep 24 | Loss 0.9079 | Val MAE 2.0901 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 25] Active Samples: 7486/24956
[P1] Ep 25 | Loss 0.8727 | Val MAE 1.9960 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 26] Active Samples: 7486/24956
[P1] Ep 26 | Loss 0.8873 | Val MAE 2.0271 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 27] Active Samples: 7486/24956
[P1] Ep 27 | Loss 0.8677 | Val MAE 1.9286 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 28] Active Samples: 7486/24956
[P1] Ep 28 | Loss 0.8679 | Val MAE 1.9897 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 29] Active Samples: 7486/24956
[P1] Ep 29 | Loss 0.8745 | Val MAE 2.0361 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 30] Active Samples: 7486/24956
[P1] Ep 30 | Loss 0.8602 | Val MAE 1.9914 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 31] Active Samples: 7486/24956
[P1] Ep 31 | Loss 0.8603 | Val MAE 2.0048 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 32] Active Samples: 7486/24956
[P1] Ep 32 | Loss 0.8691 | Val MAE 2.0147 CI 0.6491 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 33] Active Samples: 7486/24956
[P1] Ep 33 | Loss 0.8314 | Val MAE 2.0026 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 34] Active Samples: 7486/24956
[P1] Ep 34 | Loss 0.8462 | Val MAE 2.0460 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 35] Active Samples: 7486/24956
[P1] Ep 35 | Loss 0.8237 | Val MAE 1.9992 CI 0.6374 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 36] Active Samples: 7486/24956
[P1] Ep 36 | Loss 0.8347 | Val MAE 2.0322 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 37] Active Samples: 7486/24956
[P1] Ep 37 | Loss 0.8049 | Val MAE 2.0472 CI 0.6433 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 38] Active Samples: 7486/24956
[P1] Ep 38 | Loss 0.8198 | Val MAE 2.0262 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 39] Active Samples: 7486/24956
[P1] Ep 39 | Loss 0.8185 | Val MAE 1.9848 CI 0.6257 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 40] Active Samples: 7486/24956
[P1] Ep 40 | Loss 0.8991 | Val MAE 1.9837 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 41] Active Samples: 7486/24956
[P1] Ep 41 | Loss 0.9953 | Val MAE 1.9734 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 42] Active Samples: 7486/24956
[P1] Ep 42 | Loss 0.8903 | Val MAE 1.9827 CI 0.6082 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 43] Active Samples: 7486/24956
[P1] Ep 43 | Loss 0.9657 | Val MAE 1.9685 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 44] Active Samples: 7486/24956
[P1] Ep 44 | Loss 0.8813 | Val MAE 1.9788 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 45] Active Samples: 7486/24956
[P1] Ep 45 | Loss 0.9894 | Val MAE 1.9872 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 46] Active Samples: 7486/24956
[P1] Ep 46 | Loss 0.9287 | Val MAE 2.0683 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 47] Active Samples: 7486/24956
[P1] Ep 47 | Loss 0.9588 | Val MAE 1.9335 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 48] Active Samples: 7486/24956
[P1] Ep 48 | Loss 0.9655 | Val MAE 1.9869 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 49] Active Samples: 7486/24956
[P1] Ep 49 | Loss 0.9801 | Val MAE 1.9110 CI 0.5789 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 50] Active Samples: 7486/24956
[P1] Ep 50 | Loss 1.0087 | Val MAE 1.9671 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 51] Active Samples: 7486/24956
[P1] Ep 51 | Loss 0.9872 | Val MAE 1.9839 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 52] Active Samples: 7486/24956
[P1] Ep 52 | Loss 0.9364 | Val MAE 1.9488 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 53] Active Samples: 7486/24956
[P1] Ep 53 | Loss 1.1107 | Val MAE 1.8600 CI 0.6257 Acc 21.1%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 54] Active Samples: 7486/24956
[P1] Ep 54 | Loss 0.9829 | Val MAE 1.9495 CI 0.6199 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 55] Active Samples: 7486/24956
[P1] Ep 55 | Loss 0.9331 | Val MAE 1.9663 CI 0.6316 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 56] Active Samples: 7486/24956
[P1] Ep 56 | Loss 0.9847 | Val MAE 1.9637 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 57] Active Samples: 7486/24956
[P1] Ep 57 | Loss 1.0891 | Val MAE 1.9261 CI 0.6140 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 58] Active Samples: 7486/24956
[P1] Ep 58 | Loss 1.0668 | Val MAE 1.8712 CI 0.6023 Acc 15.8%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 59] Active Samples: 7486/24956
[P1] Ep 59 | Loss 1.0683 | Val MAE 1.8877 CI 0.5965 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 60] Active Samples: 7486/24956
[P1] Ep 60 | Loss 1.0305 | Val MAE 1.8841 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 61] Active Samples: 7486/24956
[P1] Ep 61 | Loss 1.0008 | Val MAE 1.9083 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 62] Active Samples: 7486/24956
[P1] Ep 62 | Loss 1.0364 | Val MAE 1.9330 CI 0.5673 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 63] Active Samples: 7486/24956
[P1] Ep 63 | Loss 1.0016 | Val MAE 1.9584 CI 0.5848 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 64] Active Samples: 7486/24956
[P1] Ep 64 | Loss 0.9951 | Val MAE 1.9594 CI 0.6023 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 65] Active Samples: 7486/24956
[P1] Ep 65 | Loss 1.0333 | Val MAE 1.9036 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 66] Active Samples: 7486/24956
[P1] Ep 66 | Loss 1.0855 | Val MAE 1.9286 CI 0.5614 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 67] Active Samples: 7486/24956
[P1] Ep 67 | Loss 1.0444 | Val MAE 1.9029 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 68] Active Samples: 7486/24956
[P1] Ep 68 | Loss 1.0192 | Val MAE 1.9468 CI 0.5556 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 69] Active Samples: 7486/24956
[P1] Ep 69 | Loss 0.8964 | Val MAE 1.9457 CI 0.5673 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 70] Active Samples: 7486/24956
[P1] Ep 70 | Loss 1.0320 | Val MAE 1.9354 CI 0.5673 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 71] Active Samples: 7486/24956
[P1] Ep 71 | Loss 0.9719 | Val MAE 1.9331 CI 0.5906 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 72] Active Samples: 7486/24956
[P1] Ep 72 | Loss 0.9856 | Val MAE 1.8905 CI 0.5731 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 73] Active Samples: 7486/24956
[P1] Ep 73 | Loss 1.0405 | Val MAE 1.8788 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 74] Active Samples: 7486/24956
[P1] Ep 74 | Loss 1.0275 | Val MAE 1.8835 CI 0.5439 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 75] Active Samples: 7486/24956
[P1] Ep 75 | Loss 0.9297 | Val MAE 1.9179 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 76] Active Samples: 7486/24956
[P1] Ep 76 | Loss 1.0360 | Val MAE 1.8844 CI 0.5322 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 77] Active Samples: 7486/24956
[P1] Ep 77 | Loss 1.0250 | Val MAE 1.8708 CI 0.5322 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 78] Active Samples: 7486/24956
[P1] Ep 78 | Loss 1.0132 | Val MAE 1.8669 CI 0.5263 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 79] Active Samples: 7486/24956
[P1] Ep 79 | Loss 1.0245 | Val MAE 1.8907 CI 0.5263 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 80] Active Samples: 7486/24956
[P1] Ep 80 | Loss 1.0470 | Val MAE 1.8799 CI 0.5263 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 81] Active Samples: 7486/24956
[P1] Ep 81 | Loss 0.9568 | Val MAE 1.8848 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 82] Active Samples: 7486/24956
[P1] Ep 82 | Loss 1.0289 | Val MAE 1.8932 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 83] Active Samples: 7486/24956
[P1] Ep 83 | Loss 1.0292 | Val MAE 1.8735 CI 0.5322 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 84] Active Samples: 7486/24956
[P1] Ep 84 | Loss 1.0135 | Val MAE 1.8698 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 85] Active Samples: 7486/24956
[P1] Ep 85 | Loss 1.0547 | Val MAE 1.8673 CI 0.5380 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 86] Active Samples: 7486/24956
[P1] Ep 86 | Loss 1.0321 | Val MAE 1.8932 CI 0.5263 Acc 10.5%
   [Weight Stats] Min: 0.0000 | Max: 1.0000 | Mean: 0.3000 | Std: 0.4583
   [Weight Stats] Zero Count: 17470/24956 (70.0%)
-> [Ep 87] Active Samples: 7486/24956
[P1] Ep 87 | Loss 1.0221 | Val MAE 1.8731 CI 0.5497 Acc 10.5%

=== PHASE 2: Target Fine-tuning ===
>>> Stage 2.1: Head Alignment...
[Head] Ep 10 MAE 1.5185 CI 0.6023 Acc 26.3%
[Head] Ep 20 MAE 1.4981 CI 0.6140 Acc 26.3%
[Head] Ep 30 MAE 1.5093 CI 0.6316 Acc 26.3%
[Head] Ep 40 MAE 1.5080 CI 0.6257 Acc 26.3%
[Head] Ep 50 MAE 1.5108 CI 0.6257 Acc 26.3%
[Head] Ep 60 MAE 1.5153 CI 0.6199 Acc 26.3%
[Head] Ep 70 MAE 1.5232 CI 0.6140 Acc 26.3%
[Head] Ep 80 MAE 1.5308 CI 0.6082 Acc 26.3%
[Head] Ep 90 MAE 1.5369 CI 0.6082 Acc 26.3%
[Head] Ep 100 MAE 1.5397 CI 0.5906 Acc 26.3%
[Head] Ep 110 MAE 1.5420 CI 0.5965 Acc 26.3%
[Head] Ep 120 MAE 1.5449 CI 0.6082 Acc 26.3%
[Head] Ep 130 MAE 1.5629 CI 0.5848 Acc 21.1%
[Head] Ep 140 MAE 1.5499 CI 0.5965 Acc 26.3%
[Head] Ep 150 MAE 1.5470 CI 0.5556 Acc 26.3%
>>> Stage 2.2: Full Fine-tuning...
[Full] Ep 10 MAE 1.5167 CI 0.6491 RM2 0.0464 Acc 26.3%
[Full] Ep 20 MAE 1.5072 CI 0.6433 RM2 0.0433 Acc 26.3%
[Full] Ep 30 MAE 1.5064 CI 0.6316 RM2 0.0407 Acc 26.3%
[Full] Ep 40 MAE 1.5135 CI 0.6082 RM2 0.0378 Acc 26.3%
[Full] Ep 50 MAE 1.5153 CI 0.6023 RM2 0.0349 Acc 26.3%

>>> Testing Final Model...
------------------------------------------------------------
[FINAL RESULT] Test Set:
   MAE:  1.3897
   RMSE: 1.7333
   CI:   0.5947
   RM2:  0.0565
   MAPE: 24.57 %
   Acc:  30.00 %
------------------------------------------------------------
