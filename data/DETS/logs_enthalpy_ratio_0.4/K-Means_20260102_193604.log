--- Enthalpy Baseline: K-Means (Ratio: 0.4) ---
Loading datasets...
Processing ../enthalpy/atct.csv...
-> Loaded 358 valid molecules from 358 rows.
Processing ../enthalpy/wudily_cho.csv...
-> Loaded 6074 valid molecules from 6074 rows.
Target Stats: Mean=14.00, Std=51.68

>>> [Stage 0] Sampling...

[Sampler] Running K-Means | Target: 2429/6074 (40.0%)
Scanning Source (K-Means):   0%|          | 0/6 [00:00<?, ?it/s]Scanning Source (K-Means):  17%|█▋        | 1/6 [00:02<00:10,  2.02s/it]Scanning Source (K-Means):  33%|███▎      | 2/6 [00:03<00:07,  1.88s/it]Scanning Source (K-Means):  50%|█████     | 3/6 [00:05<00:04,  1.63s/it]Scanning Source (K-Means):  67%|██████▋   | 4/6 [00:06<00:03,  1.58s/it]Scanning Source (K-Means):  83%|████████▎ | 5/6 [00:08<00:01,  1.62s/it]Scanning Source (K-Means): 100%|██████████| 6/6 [00:10<00:00,  1.95s/it]                                                                           Running MiniBatchKMeans...
Clusters:   0%|          | 0/2429 [00:00<?, ?it/s]Clusters:  64%|██████▍   | 1550/2429 [00:00<00:00, 15485.84it/s]                                                                -> Source reduced: 6074 -> 2352

=== Phase 1: Source Pre-training ===
[P1] Ep 10: Loss 0.3661 | Val MAE 109.9407
[P1] Ep 20: Loss 0.2457 | Val MAE 157.6123
[P1] Ep 30: Loss 0.1671 | Val MAE 136.2695
[P1] Ep 40: Loss 0.1279 | Val MAE 144.6716
[P1] Ep 50: Loss 0.1046 | Val MAE 87.6896
[P1] Ep 60: Loss 0.1116 | Val MAE 63.7249
[P1] Ep 70: Loss 0.1036 | Val MAE 91.1441
[P1] Ep 80: Loss 0.0863 | Val MAE 134.5309
[P1] Ep 90: Loss 0.1272 | Val MAE 143.0493
[P1] Ep 100: Loss 0.1305 | Val MAE 132.1001
[P1] Ep 110: Loss 0.0780 | Val MAE 105.5166
[P1] Ep 120: Loss 0.0908 | Val MAE 113.6788
[P1] Ep 130: Loss 0.0893 | Val MAE 78.5204
[P1] Ep 140: Loss 0.0682 | Val MAE 136.5232
[P1] Ep 150: Loss 0.0511 | Val MAE 150.7177
[P1] Ep 160: Loss 0.0769 | Val MAE 130.1882
[P1] Ep 170: Loss 0.0473 | Val MAE 188.6859
[P1] Ep 180: Loss 0.0461 | Val MAE 138.9213
[P1] Ep 190: Loss 0.0480 | Val MAE 112.4496
[P1] Ep 200: Loss 0.0697 | Val MAE 171.1672
[P1] Ep 210: Loss 0.0418 | Val MAE 128.4434
[P1] Ep 220: Loss 0.0413 | Val MAE 173.0333
[P1] Ep 230: Loss 0.0322 | Val MAE 174.8892
[P1] Ep 240: Loss 0.0315 | Val MAE 144.4038
[P1] Ep 250: Loss 0.0305 | Val MAE 173.1609
[P1] Ep 260: Loss 0.0257 | Val MAE 189.5901
[P1] Ep 270: Loss 0.0341 | Val MAE 159.0624
[P1] Ep 280: Loss 0.0429 | Val MAE 138.2162
[P1] Ep 290: Loss 0.0246 | Val MAE 148.2273
[P1] Ep 300: Loss 0.0264 | Val MAE 158.9532
[P1] Ep 310: Loss 0.0227 | Val MAE 106.8599
[P1] Ep 320: Loss 0.0208 | Val MAE 138.2688
[P1] Ep 330: Loss 0.0183 | Val MAE 140.2802
[P1] Ep 340: Loss 0.0218 | Val MAE 148.4601
[P1] Ep 350: Loss 0.0180 | Val MAE 207.3975
[P1] Ep 360: Loss 0.0213 | Val MAE 147.7542
[P1] Ep 370: Loss 0.0160 | Val MAE 189.2573
[P1] Ep 380: Loss 0.0199 | Val MAE 189.5247
[P1] Ep 390: Loss 0.0164 | Val MAE 206.9279
[P1] Ep 400: Loss 0.0184 | Val MAE 186.5210
[P1] Ep 410: Loss 0.0151 | Val MAE 182.5276
[P1] Ep 420: Loss 0.0152 | Val MAE 186.0603
[P1] Ep 430: Loss 0.0146 | Val MAE 183.7169
[P1] Ep 440: Loss 0.0149 | Val MAE 210.9852
[P1] Ep 450: Loss 0.0120 | Val MAE 184.8497
[P1] Ep 460: Loss 0.0208 | Val MAE 227.0310
[P1] Ep 470: Loss 0.0192 | Val MAE 272.0302
[P1] Ep 480: Loss 0.0157 | Val MAE 299.1138
[P1] Ep 490: Loss 0.0129 | Val MAE 176.5802
[P1] Ep 500: Loss 0.0152 | Val MAE 201.4041

=== Phase 2: Target Fine-tuning ===
[FT] Ep 10: Loss 0.7023 | Val MAE 32.1532
[FT] Ep 20: Loss 0.6427 | Val MAE 35.1169
[FT] Ep 30: Loss 0.6372 | Val MAE 33.7735
[FT] Ep 40: Loss 0.6283 | Val MAE 31.8707
[FT] Ep 50: Loss 0.5384 | Val MAE 31.6494
[FT] Ep 60: Loss 0.5457 | Val MAE 30.5334
[FT] Ep 70: Loss 0.5283 | Val MAE 31.7407
[FT] Ep 80: Loss 0.5248 | Val MAE 32.1306
[FT] Ep 90: Loss 0.4461 | Val MAE 31.4827
[FT] Ep 100: Loss 0.4635 | Val MAE 31.0146
[FT] Ep 110: Loss 0.4608 | Val MAE 33.9688
[FT] Ep 120: Loss 0.4561 | Val MAE 34.7227
[FT] Ep 130: Loss 0.4295 | Val MAE 32.1516
[FT] Ep 140: Loss 0.4393 | Val MAE 35.2271
[FT] Ep 150: Loss 0.4652 | Val MAE 32.3751
[FT] Ep 160: Loss 0.4558 | Val MAE 31.9732
[FT] Ep 170: Loss 0.4533 | Val MAE 32.6737
[FT] Ep 180: Loss 0.3964 | Val MAE 32.4890
[FT] Ep 190: Loss 0.4130 | Val MAE 33.2320
[FT] Ep 200: Loss 0.3768 | Val MAE 31.4276
Early stopping triggered.

>>> Testing Final Model...
------------------------------------------------------------
[BASELINE RESULT] Method: K-Means
   MAE:  25.2670
   RMSE: 35.0510
   MAPE: 94.83 %
   Acc:  16.67 %
------------------------------------------------------------
