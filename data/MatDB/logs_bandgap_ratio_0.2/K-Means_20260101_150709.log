--- Baseline MLP Pipeline (Method: K-Means) ---
Loading data from:
  Theory: ../bandgap/theory_features_clean.csv
  Exp: ../bandgap/exp_features_clean.csv
Full Source Data: 7908 | Target Train: 632
Initializing ResNet Baseline (Dim=128)...

=== Stage 0: Coreset Selection [K-Means] ===
   Target Ratio: 20.0%

[Sampler] Running K-Means | Target: 1581/7908 (20.0%)
Scanning Source (K-Means):   0%|          | 0/8 [00:00<?, ?it/s]Scanning Source (K-Means):  12%|█▎        | 1/8 [00:00<00:00,  9.07it/s]                                                                           Running KMeans...
-> Selected 1581 samples.

=== PHASE 1: Source Pre-training ===
[P1] Ep 20: Loss 1.0688
[P1] Ep 40: Loss 0.9074
[P1] Ep 60: Loss 0.7312
[P1] Ep 80: Loss 0.6293
[P1] Ep 100: Loss 0.6118
[P1] Ep 120: Loss 0.5241
[P1] Ep 140: Loss 0.5229
[P1] Ep 160: Loss 0.4766
[P1] Ep 180: Loss 0.4417
[P1] Ep 200: Loss 0.4376
[P1] Ep 220: Loss 0.3994
[P1] Ep 240: Loss 0.3706
[P1] Ep 260: Loss 0.3419
[P1] Ep 280: Loss 0.3325
[P1] Ep 300: Loss 0.3142
[P1] Ep 320: Loss 0.2999
[P1] Ep 340: Loss 0.2825
[P1] Ep 360: Loss 0.2584
[P1] Ep 380: Loss 0.2533
[P1] Ep 400: Loss 0.2290
[P1] Ep 420: Loss 0.2528
[P1] Ep 440: Loss 0.2311
[P1] Ep 460: Loss 0.2202
[P1] Ep 480: Loss 0.2034
[P1] Ep 500: Loss 0.2018
[P1] Ep 520: Loss 0.1976
[P1] Ep 540: Loss 0.1730
[P1] Ep 560: Loss 0.1715
[P1] Ep 580: Loss 0.1746
[P1] Ep 600: Loss 0.1700
[P1] Ep 620: Loss 0.1576
[P1] Ep 640: Loss 0.1516
[P1] Ep 660: Loss 0.1509
[P1] Ep 680: Loss 0.1514
[P1] Ep 700: Loss 0.1437
[P1] Ep 720: Loss 0.1453
[P1] Ep 740: Loss 0.1352
[P1] Ep 760: Loss 0.1473
[P1] Ep 780: Loss 0.1334
[P1] Ep 800: Loss 0.1297
[P1] Ep 820: Loss 0.1222
[P1] Ep 840: Loss 0.1081
[P1] Ep 860: Loss 0.1154
[P1] Ep 880: Loss 0.1155
[P1] Ep 900: Loss 0.1030
[P1] Ep 920: Loss 0.1104
[P1] Ep 940: Loss 0.1053
[P1] Ep 960: Loss 0.1067
[P1] Ep 980: Loss 0.0971
Phase 1 Early Stopping

=== PHASE 2.1: Head Alignment ===
[P2.1] Ep 50 MAE 0.7690
[P2.1] Ep 100 MAE 0.7706
[P2.1] Ep 150 MAE 0.7624
[P2.1] Ep 200 MAE 0.7414
[P2.1] Ep 250 MAE 0.7252
[P2.1] Ep 300 MAE 0.7143

=== PHASE 2.2: Full Fine-tuning ===
[P2.2] Ep 20 MAE 0.6540
[P2.2] Ep 40 MAE 0.6420
[P2.2] Ep 60 MAE 0.6462
[P2.2] Ep 80 MAE 0.6450
[P2.2] Ep 100 MAE 0.6465
[P2.2] Ep 120 MAE 0.6465
[P2.2] Ep 140 MAE 0.6439
[P2.2] Ep 160 MAE 0.6486

>>> Final Test Evaluation
------------------------------------------------------------
Method: K-Means (Ratio=0.2)
MAE: 0.5864
RMSE: 0.7655
MAPE: 44.0078
Acc_10: 26.7045
Acc_20: 49.4318
------------------------------------------------------------
