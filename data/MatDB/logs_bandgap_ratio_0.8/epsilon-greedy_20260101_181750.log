--- Baseline MLP Pipeline (Method: epsilon-greedy) ---
Loading data from:
  Theory: ../bandgap/theory_features_clean.csv
  Exp: ../bandgap/exp_features_clean.csv
Full Source Data: 7908 | Target Train: 632
Initializing ResNet Baseline (Dim=128)...

=== Stage 0: Coreset Selection [epsilon-greedy] ===
   Target Ratio: 80.0%

[Sampler] Running epsilon-greedy | Target: 6326/7908 (80.0%)
Scanning Source (epsilon-greedy):   0%|          | 0/8 [00:00<?, ?it/s]Scanning Source (epsilon-greedy):  12%|█▎        | 1/8 [00:00<00:00,  7.82it/s]                                                                               -> Selected 6326 samples.

=== PHASE 1: Source Pre-training ===
[P1] Ep 20: Loss 0.8215
[P1] Ep 40: Loss 0.6358
[P1] Ep 60: Loss 0.5585
[P1] Ep 80: Loss 0.5053
[P1] Ep 100: Loss 0.4629
[P1] Ep 120: Loss 0.4283
[P1] Ep 140: Loss 0.4018
[P1] Ep 160: Loss 0.3709
[P1] Ep 180: Loss 0.3475
[P1] Ep 200: Loss 0.3233
[P1] Ep 220: Loss 0.3117
[P1] Ep 240: Loss 0.2978
[P1] Ep 260: Loss 0.2832
[P1] Ep 280: Loss 0.2721
[P1] Ep 300: Loss 0.2558
[P1] Ep 320: Loss 0.2502
[P1] Ep 340: Loss 0.2413
[P1] Ep 360: Loss 0.2280
[P1] Ep 380: Loss 0.2227
[P1] Ep 400: Loss 0.2124
[P1] Ep 420: Loss 0.2080
[P1] Ep 440: Loss 0.2031
[P1] Ep 460: Loss 0.1966
[P1] Ep 480: Loss 0.1889
[P1] Ep 500: Loss 0.1803
[P1] Ep 520: Loss 0.1715
[P1] Ep 540: Loss 0.1721
[P1] Ep 560: Loss 0.1621
[P1] Ep 580: Loss 0.1582
[P1] Ep 600: Loss 0.1558
[P1] Ep 620: Loss 0.1501
[P1] Ep 640: Loss 0.1415
[P1] Ep 660: Loss 0.1439
[P1] Ep 680: Loss 0.1392
[P1] Ep 700: Loss 0.1374
[P1] Ep 720: Loss 0.1335
[P1] Ep 740: Loss 0.1305
Phase 1 Early Stopping

=== PHASE 2.1: Head Alignment ===
[P2.1] Ep 50 MAE 0.7834

=== PHASE 2.2: Full Fine-tuning ===
[P2.2] Ep 20 MAE 0.6809
[P2.2] Ep 40 MAE 0.6792
[P2.2] Ep 60 MAE 0.6748
[P2.2] Ep 80 MAE 0.6736
[P2.2] Ep 100 MAE 0.6689
[P2.2] Ep 120 MAE 0.6708
[P2.2] Ep 140 MAE 0.6688
[P2.2] Ep 160 MAE 0.6639
[P2.2] Ep 180 MAE 0.6599
[P2.2] Ep 200 MAE 0.6578
[P2.2] Ep 220 MAE 0.6633
[P2.2] Ep 240 MAE 0.6588
[P2.2] Ep 260 MAE 0.6625
[P2.2] Ep 280 MAE 0.6593
[P2.2] Ep 300 MAE 0.6655
[P2.2] Ep 320 MAE 0.6565
[P2.2] Ep 340 MAE 0.6593
[P2.2] Ep 360 MAE 0.6546
[P2.2] Ep 380 MAE 0.6489
[P2.2] Ep 400 MAE 0.6478
[P2.2] Ep 420 MAE 0.6509
[P2.2] Ep 440 MAE 0.6479

>>> Final Test Evaluation
------------------------------------------------------------
Method: epsilon-greedy (Ratio=0.8)
MAE: 0.5711
RMSE: 0.7244
MAPE: 40.5492
Acc_10: 26.1364
Acc_20: 52.8409
------------------------------------------------------------
